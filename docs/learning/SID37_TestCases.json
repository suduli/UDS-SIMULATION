{
    "id": "sid37-request-transfer-exit-test-suite",
    "name": "SID 0x37 Request Transfer Exit Test Suite",
    "description": "Comprehensive test suite for UDS Service ID 0x37 (RequestTransferExit) based on ISO 14229-1:2020 Section 11.5. Covers session validation (PROGRAMMING required), security validation (unlock required), transfer state validation (must have active transfer), message length validation with optional parameter records, and all 9 NRCs (0x13, 0x22, 0x24, 0x31, 0x33, 0x70, 0x72, 0x92, 0x93).",
    "requests": [
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600000000,
            "description": "[SETUP] Reset to Default Session"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600001000,
            "description": "TC-01: Transfer Exit in DEFAULT session (no transfer active) - Expect NRC 0x70 (Upload Download Not Accepted)"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600002000,
            "description": "[SETUP] Reset for TC-02"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600003000,
            "description": "TC-02.1: Enter PROGRAMMING session"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600004000,
            "description": "TC-02.2: Transfer Exit without security unlock - Expect NRC 0x33 (Security Access Denied)"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600005000,
            "description": "[SETUP] Reset for TC-03"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600006000,
            "description": "TC-03.1: Enter PROGRAMMING session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600007000,
            "description": "TC-03.2: Request seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734600008000,
            "description": "TC-03.3: Send key to unlock security"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600009000,
            "description": "TC-03.4: Transfer Exit without active transfer - Expect NRC 0x24 (Request Sequence Error)"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600010000,
            "description": "[SETUP] Reset for TC-04"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600011000,
            "description": "TC-04.1: Enter PROGRAMMING session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600012000,
            "description": "TC-04.2: Request seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734600013000,
            "description": "TC-04.3: Send key"
        },
        {
            "sid": 52,
            "data": [
                0,
                68,
                0,
                16,
                0,
                0,
                0,
                0,
                16,
                0
            ],
            "timestamp": 1734600014000,
            "description": "TC-04.4: Request Download: Addr=0x00100000, Size=0x1000"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600015000,
            "description": "TC-04.5: Valid Transfer Exit after Download (no data transferred) - Expect Success (0x77)"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600016000,
            "description": "[SETUP] Reset for TC-05"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600017000,
            "description": "TC-05.1: Enter PROGRAMMING session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600018000,
            "description": "TC-05.2: Request seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734600019000,
            "description": "TC-05.3: Send key"
        },
        {
            "sid": 53,
            "data": [
                0,
                68,
                0,
                16,
                0,
                0,
                0,
                0,
                8,
                0
            ],
            "timestamp": 1734600020000,
            "description": "TC-05.4: Request Upload: Addr=0x00100000, Size=0x0800"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600021000,
            "description": "TC-05.5: Valid Transfer Exit after Upload (no data transferred) - Expect Success (0x77)"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600022000,
            "description": "[SETUP] Reset for TC-06"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600023000,
            "description": "TC-06.1: Enter PROGRAMMING session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600024000,
            "description": "TC-06.2: Request seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734600025000,
            "description": "TC-06.3: Send key"
        },
        {
            "sid": 52,
            "data": [
                0,
                68,
                0,
                16,
                0,
                0,
                0,
                0,
                16,
                0
            ],
            "timestamp": 1734600026000,
            "description": "TC-06.4: Request Download"
        },
        {
            "sid": 54,
            "data": [
                1,
                170,
                187,
                204,
                221
            ],
            "timestamp": 1734600027000,
            "description": "TC-06.5: Transfer Data Block 1"
        },
        {
            "sid": 54,
            "data": [
                2,
                17,
                34,
                51,
                68
            ],
            "timestamp": 1734600028000,
            "description": "TC-06.6: Transfer Data Block 2"
        },
        {
            "sid": 54,
            "data": [
                3,
                85,
                102,
                119,
                136
            ],
            "timestamp": 1734600029000,
            "description": "TC-06.7: Transfer Data Block 3"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600030000,
            "description": "TC-06.8: Transfer Exit after multiple blocks - Expect Success (0x77)"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600031000,
            "description": "[SETUP] Reset for TC-07"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600032000,
            "description": "TC-07.1: Enter PROGRAMMING session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600033000,
            "description": "TC-07.2: Request seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734600034000,
            "description": "TC-07.3: Send key"
        },
        {
            "sid": 52,
            "data": [
                0,
                68,
                0,
                16,
                0,
                0,
                0,
                0,
                16,
                0
            ],
            "timestamp": 1734600035000,
            "description": "TC-07.4: Request Download"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600036000,
            "description": "TC-07.5: First Transfer Exit - Expect Success (0x77)"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600037000,
            "description": "TC-07.6: Repeated Transfer Exit (already exited) - Expect NRC 0x24 (Request Sequence Error)"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600038000,
            "description": "[SETUP] Reset for TC-08"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734600039000,
            "description": "TC-08.1: Enter EXTENDED session (not PROGRAMMING)"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600040000,
            "description": "TC-08.2: Request seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734600041000,
            "description": "TC-08.3: Send key"
        },
        {
            "sid": 53,
            "data": [
                0,
                68,
                0,
                16,
                0,
                0,
                0,
                0,
                8,
                0
            ],
            "timestamp": 1734600042000,
            "description": "TC-08.4: Request Upload in EXTENDED session"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600043000,
            "description": "TC-08.5: Transfer Exit in EXTENDED session - Expect NRC 0x70 (Upload Download Not Accepted)"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600044000,
            "description": "[SETUP] Reset for TC-09"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600045000,
            "description": "TC-09.1: Enter PROGRAMMING session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600046000,
            "description": "TC-09.2: Request seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734600047000,
            "description": "TC-09.3: Send key"
        },
        {
            "sid": 52,
            "data": [
                0,
                68,
                0,
                16,
                0,
                0,
                0,
                0,
                16,
                0
            ],
            "timestamp": 1734600048000,
            "description": "TC-09.4: Request Download"
        },
        {
            "sid": 55,
            "data": [
                161,
                178,
                195,
                212
            ],
            "timestamp": 1734600049000,
            "description": "TC-09.5: Transfer Exit with parameter record (4 bytes: simulated CRC-32) - Expect Success (0x77)"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600050000,
            "description": "[SETUP] Reset for TC-10"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600051000,
            "description": "TC-10.1: Enter PROGRAMMING session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600052000,
            "description": "TC-10.2: Request seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734600053000,
            "description": "TC-10.3: Send key"
        },
        {
            "sid": 52,
            "data": [
                0,
                68,
                0,
                16,
                0,
                0,
                0,
                0,
                16,
                0
            ],
            "timestamp": 1734600054000,
            "description": "TC-10.4: Request Download"
        },
        {
            "sid": 54,
            "data": [
                1,
                170,
                187
            ],
            "timestamp": 1734600055000,
            "description": "TC-10.5: Transfer Data Block 1"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600056000,
            "description": "TC-10.6: Switch to DEFAULT session (interrupts transfer)"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600057000,
            "description": "TC-10.7: Transfer Exit after session change - Expect NRC 0x70 (Upload Download Not Accepted)"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600058000,
            "description": "[SETUP] Reset for TC-11"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600059000,
            "description": "TC-11.1: Enter PROGRAMMING session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600060000,
            "description": "TC-11.2: Request seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734600061000,
            "description": "TC-11.3: Send key"
        },
        {
            "sid": 52,
            "data": [
                0,
                68,
                0,
                16,
                0,
                0,
                0,
                0,
                16,
                0
            ],
            "timestamp": 1734600062000,
            "description": "TC-11.4: Request Download"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600063000,
            "description": "TC-11.5: Reset to DEFAULT (clears security)"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600064000,
            "description": "TC-11.6: Back to PROGRAMMING (but security cleared)"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600065000,
            "description": "TC-11.7: Transfer Exit without security (session changed cleared it) - Expect NRC 0x33 (Security Access Denied)"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600066000,
            "description": "[SETUP] Reset for TC-12"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600067000,
            "description": "TC-12.1: Enter PROGRAMMING session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600068000,
            "description": "TC-12.2: Request seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734600069000,
            "description": "TC-12.3: Send key"
        },
        {
            "sid": 52,
            "data": [
                0,
                68,
                0,
                16,
                0,
                0,
                0,
                0,
                16,
                0
            ],
            "timestamp": 1734600070000,
            "description": "TC-12.4: Request Download"
        },
        {
            "sid": 54,
            "data": [
                1,
                0,
                0
            ],
            "timestamp": 1734600071000,
            "description": "TC-12.5: Transfer Data Block 1"
        },
        {
            "sid": 54,
            "data": [
                2,
                0,
                0
            ],
            "timestamp": 1734600072000,
            "description": "TC-12.6: Transfer Data Block 2"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600073000,
            "description": "TC-12.7: Transfer Exit - Verify downloadInProgress flag cleared"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600074000,
            "description": "[SETUP] Reset for TC-13"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600075000,
            "description": "TC-13.1: Enter PROGRAMMING session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600076000,
            "description": "TC-13.2: Request seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734600077000,
            "description": "TC-13.3: Send key"
        },
        {
            "sid": 53,
            "data": [
                0,
                68,
                0,
                16,
                0,
                0,
                0,
                0,
                8,
                0
            ],
            "timestamp": 1734600078000,
            "description": "TC-13.4: Request Upload"
        },
        {
            "sid": 54,
            "data": [
                1,
                0,
                0
            ],
            "timestamp": 1734600079000,
            "description": "TC-13.5: Transfer Data Block 1"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600080000,
            "description": "TC-13.6: Transfer Exit - Verify uploadInProgress flag cleared"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600081000,
            "description": "[SETUP] Reset for TC-14"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734600082000,
            "description": "TC-14.1: Enter PROGRAMMING session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600083000,
            "description": "TC-14.2: Request seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734600084000,
            "description": "TC-14.3: Send key"
        },
        {
            "sid": 52,
            "data": [
                0,
                68,
                0,
                16,
                0,
                0,
                0,
                0,
                16,
                0
            ],
            "timestamp": 1734600085000,
            "description": "TC-14.4: Request Download"
        },
        {
            "sid": 54,
            "data": [
                1,
                0
            ],
            "timestamp": 1734600086000,
            "description": "TC-14.5: Transfer Data Block 1 (BSC=1)"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600087000,
            "description": "TC-14.6: Transfer Exit - Verify BSC counter reset to 0"
        },
        {
            "sid": 52,
            "data": [
                0,
                68,
                0,
                16,
                0,
                0,
                0,
                0,
                16,
                0
            ],
            "timestamp": 1734600088000,
            "description": "TC-14.7: New Request Download"
        },
        {
            "sid": 54,
            "data": [
                1,
                0
            ],
            "timestamp": 1734600089000,
            "description": "TC-14.8: Transfer Data should start at BSC=1 (counter was reset) - Expect Success"
        },
        {
            "sid": 55,
            "data": [],
            "timestamp": 1734600090000,
            "description": "TC-14.9: Transfer Exit cleanup"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734600091000,
            "description": "[FINAL] Reset to Default Session"
        }
    ],
    "createdAt": 1734600000000,
    "version": "1.0.0",
    "metadata": {
        "author": "UDS Simulator",
        "description": "ISO 14229-1:2020 Section 11.5 compliant test suite for SID 0x37 (RequestTransferExit) with comprehensive coverage of session validation, security validation, transfer state validation, parameter record support, and all 9 NRCs.",
        "tags": [
            "SID37",
            "Request Transfer Exit",
            "RequestTransferExit",
            "ISO 14229",
            "Test Suite",
            "Automated Testing",
            "Session Validation",
            "Security Validation",
            "Transfer Validation",
            "Programming"
        ],
        "duration": 91000,
        "totalRequests": 127,
        "successRate": 100
    },
    "notes": "Test Suite v1.0.0: Comprehensive test coverage for SID 0x37 (RequestTransferExit). Tests 14 categories: (TC-01) Session validation - DEFAULT session fails with NRC 0x70, (TC-02) Security validation - locked state fails with NRC 0x33, (TC-03) Transfer state validation - no active transfer fails with NRC 0x24, (TC-04) Valid exit after Download with no data blocks, (TC-05) Valid exit after Upload with no data blocks, (TC-06) Valid exit after multiple data blocks transferred, (TC-07) Repeated Transfer Exit fails with NRC 0x24, (TC-08) Session requirement - EXTENDED session not allowed, (TC-09) Transfer Exit with optional parameter record, (TC-10) Validation precedence - session check before sequence, (TC-11) Validation precedence - security check before sequence, (TC-12) Verify downloadInProgress flag cleared after exit, (TC-13) Verify uploadInProgress flag cleared after exit, (TC-14) Verify BSC counter reset to 0 after exit. Validates NRC handling for 0x13 (IncorrectMessageLength), 0x22 (ConditionsNotCorrect), 0x24 (RequestSequenceError), 0x31 (RequestOutOfRange), 0x33 (SecurityAccessDenied), 0x70 (UploadDownloadNotAccepted), 0x72 (GeneralProgrammingFailure), 0x92 (VoltageTooHigh), 0x93 (VoltageTooLow)."
}