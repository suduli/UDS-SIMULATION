# SID 0x3D (61): Write Memory By Address - Service Interactions Guide

**Document Version**: 2.0  
**Last Updated**: 2025-10-12  
**Format**: Visual Diagrams (Service Dependencies, Workflows, Sequence Diagrams)  
**ISO Reference**: ISO 14229-1:2020 Section 11.4

---

## Table of Contents

1. [Overview](#overview)
2. [Service Dependency Pyramid](#service-dependency-pyramid)
3. [Session Requirements Matrix](#session-requirements-matrix)
4. [Complete Workflow Examples](#complete-workflow-examples)
5. [Multi-Service Interaction Patterns](#multi-service-interaction-patterns)
6. [Integration with Specific Services](#integration-with-specific-services)
7. [Troubleshooting Multi-Service Scenarios](#troubleshooting-multi-service-scenarios)
8. [Quick Reference Tables](#quick-reference-tables)

---

## Overview

SID 0x3D (Write Memory By Address) rarely operates in isolation. This guide shows how it interacts with other UDS services to form complete diagnostic workflows.

### Key Integration Points

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SID 0x3D Depends On:                              â”‚
â”‚    â€¢ SID 0x10 - Session Control (EXTENDED/PROGRAM) â”‚
â”‚    â€¢ SID 0x27 - Security Access (unlock)           â”‚
â”‚    â€¢ SID 0x3E - TesterPresent (keep alive)         â”‚
â”‚                                                    â”‚
â”‚  SID 0x3D Works With:                              â”‚
â”‚    â€¢ SID 0x23 - Read Memory (verification)         â”‚
â”‚    â€¢ SID 0x2E - Write Data By Identifier           â”‚
â”‚    â€¢ SID 0x31 - Routine Control (pre/post checks)  â”‚
â”‚    â€¢ SID 0x11 - ECU Reset (finalize changes)       â”‚
â”‚                                                    â”‚
â”‚  SID 0x3D Enables:                                 â”‚
â”‚    â€¢ Calibration workflows                         â”‚
â”‚    â€¢ Configuration programming                     â”‚
â”‚    â€¢ Manufacturing operations                      â”‚
â”‚    â€¢ Firmware patching (temporary)                 â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Service Dependency Pyramid

### Hierarchical Dependencies

```
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚   SID 0x3D      â”‚
                            â”‚ Write Memory    â”‚
                            â”‚                 â”‚
                            â”‚ (Top: Final Op) â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚               â”‚               â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   SID 0x27      â”‚ â”‚ SID 0x3E   â”‚ â”‚ SID 0x23   â”‚
            â”‚ Security Access â”‚ â”‚ Tester     â”‚ â”‚ Read Memoryâ”‚
            â”‚                 â”‚ â”‚ Present    â”‚ â”‚            â”‚
            â”‚ (Required)      â”‚ â”‚ (Optional) â”‚ â”‚ (Verify)   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   SID 0x10      â”‚
            â”‚ Session Control â”‚
            â”‚                 â”‚
            â”‚ (Foundation)    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Reading the Pyramid:
  â€¢ Bottom (SID 0x10): Must execute first
  â€¢ Middle (SID 0x27): Required before write
  â€¢ Middle (SID 0x3E): Keep session alive during ops
  â€¢ Middle (SID 0x23): Verify write success
  â€¢ Top (SID 0x3D): Final write operation
```

### Dependency Levels

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Level   â”‚ Service             â”‚ Purpose              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Level 1 â”‚ SID 0x10            â”‚ Enable correct       â”‚
â”‚         â”‚ (Session Control)   â”‚ diagnostic session   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Level 2 â”‚ SID 0x27            â”‚ Unlock security for  â”‚
â”‚         â”‚ (Security Access)   â”‚ protected memory     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Level 3 â”‚ SID 0x3E            â”‚ Keep session active  â”‚
â”‚         â”‚ (TesterPresent)     â”‚ during long ops      â”‚
â”‚         â”‚                     â”‚                      â”‚
â”‚         â”‚ SID 0x23            â”‚ Verify written data  â”‚
â”‚         â”‚ (Read Memory)       â”‚                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Level 4 â”‚ SID 0x3D            â”‚ Perform write        â”‚
â”‚         â”‚ (Write Memory)      â”‚ operation            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Session Requirements Matrix

### Session Compatibility Table

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Memory Region    â”‚ DEFAULT  â”‚ EXTENDED â”‚ PROGRAM  â”‚
â”‚                  â”‚  (0x01)  â”‚  (0x03)  â”‚  (0x02)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RAM              â”‚    âŒ    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ (Calibration)    â”‚          â”‚  Level 1 â”‚  Level 1 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EEPROM           â”‚    âŒ    â”‚    âœ…    â”‚    âœ…    â”‚
â”‚ (Configuration)  â”‚          â”‚  Level 1 â”‚  Level 1 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Flash            â”‚    âŒ    â”‚    âŒ    â”‚    âœ…    â”‚
â”‚ (Firmware)       â”‚          â”‚          â”‚  Level 3 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OTP              â”‚    âŒ    â”‚    âŒ    â”‚    âœ…    â”‚
â”‚ (One-Time Prog)  â”‚          â”‚          â”‚  Level 5 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend:
  âœ… = Allowed with security unlock
  âŒ = Not allowed (returns NRC 0x7F or 0x33)
  Level X = Required security level
```

### Session Transition Impact

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            SESSION TRANSITIONS                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  DEFAULT â†’ EXTENDED (10 03)                        â”‚
â”‚    â€¢ Security state: RESET (must re-unlock)        â”‚
â”‚    â€¢ Write capability: RAM, EEPROM enabled         â”‚
â”‚    â€¢ Flash writes: Still disabled                  â”‚
â”‚                                                    â”‚
â”‚  EXTENDED â†’ PROGRAMMING (10 02)                    â”‚
â”‚    â€¢ Security state: RESET (must re-unlock)        â”‚
â”‚    â€¢ Write capability: ALL regions enabled         â”‚
â”‚    â€¢ Requires higher security for flash/OTP        â”‚
â”‚                                                    â”‚
â”‚  EXTENDED â†’ EXTENDED (10 03 again)                 â”‚
â”‚    â€¢ Security state: PRESERVED âœ“                   â”‚
â”‚    â€¢ Write capability: Unchanged                   â”‚
â”‚    â€¢ Useful for refreshing timeout                 â”‚
â”‚                                                    â”‚
â”‚  * â†’ DEFAULT (10 01 or timeout)                    â”‚
â”‚    â€¢ Security state: RESET                         â”‚
â”‚    â€¢ Write capability: NONE                        â”‚
â”‚    â€¢ All writes blocked (NRC 0x7F)                 â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Complete Workflow Examples

### Workflow 1: RAM Calibration Update

```
  Tester                                    ECU
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 1: Session Setup                â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  10 03 (Extended Session)              â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  50 03 âœ“                               â”‚
    â”‚                                        â”‚
    â”‚  Session: EXTENDED ğŸŸ¢                  â”‚
    â”‚  Security: LOCKED ğŸ”’                   â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 2: Security Unlock              â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  27 01 (Request Seed)                  â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  67 01 12 34 56 78 (Seed)              â”‚
    â”‚                                        â”‚
    â”‚  [Tester calculates key from seed]     â”‚
    â”‚                                        â”‚
    â”‚  27 02 AA BB CC DD (Send Key)          â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  67 02 âœ“                               â”‚
    â”‚                                        â”‚
    â”‚  Security: UNLOCKED ğŸ”“ (Level 1)       â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 3: Read Current Value           â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  23 44 20 00 10 00 00 00 00 04         â”‚
    â”‚  (Read 4 bytes from 0x20001000)        â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  63 00 00 00 64 (Current: 100)         â”‚
    â”‚                                        â”‚
    â”‚  Current calibration value: 100        â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 4: Write New Value              â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  3D 44 20 00 10 00 00 00 00 04         â”‚
    â”‚     00 00 00 C8                        â”‚
    â”‚  (Write 200 to 0x20001000)             â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  7D 44 20 00 10 00 âœ“                   â”‚
    â”‚                                        â”‚
    â”‚  New calibration value written: 200    â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 5: Verify Write                 â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  23 44 20 00 10 00 00 00 00 04         â”‚
    â”‚  (Read back to verify)                 â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  63 00 00 00 C8 âœ“                      â”‚
    â”‚                                        â”‚
    â”‚  Verification: SUCCESS âœ…              â”‚
    â”‚  Expected: 200, Got: 200               â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 6: Return to Default            â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  10 01 (Default Session)               â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  50 01 âœ“                               â”‚
    â”‚                                        â”‚
    â”‚  Session: DEFAULT ğŸ”µ                   â”‚
    â”‚  Security: LOCKED ğŸ”’ (reset)           â”‚
    â”‚                                        â”‚
```

---

### Workflow 2: EEPROM Configuration Programming

```
  Tester                                    ECU
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 1: Session + Security           â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  10 03 â†’ 50 03 âœ“                       â”‚
    â”‚  27 01 â†’ 67 01 [seed]                  â”‚
    â”‚  27 02 â†’ 67 02 âœ“                       â”‚
    â”‚                                        â”‚
    â”‚  Session: EXTENDED ğŸŸ¢                  â”‚
    â”‚  Security: UNLOCKED ğŸ”“ (Level 1)       â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 2: Write Configuration Block    â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  3D 84 08 08 00 00 00 00 00 08         â”‚
    â”‚     01 02 03 04 05 06 07 08            â”‚
    â”‚  (Write 8-byte config to EEPROM)       â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚                                        â”‚
    â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚                          â”‚ Queue    â”‚  â”‚
    â”‚                          â”‚ EEPROM   â”‚  â”‚
    â”‚                          â”‚ Write    â”‚  â”‚
    â”‚                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”‚
    â”‚                          â”‚ Write    â”‚  â”‚
    â”‚                          â”‚ (50ms)   â”‚  â”‚
    â”‚                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”‚
    â”‚                          â”‚ Verify   â”‚  â”‚
    â”‚                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                               â”‚        â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  7D 84 08 08 00 00 âœ“                   â”‚
    â”‚                                        â”‚
    â”‚  â±ï¸ Response time: ~50ms (EEPROM)      â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 3: Wait for EEPROM Settle       â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  [Wait 100ms for EEPROM stabilization] â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 4: Verify Configuration         â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  23 84 08 08 00 00 00 00 00 08         â”‚
    â”‚  (Read back configuration)             â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  63 01 02 03 04 05 06 07 08 âœ“          â”‚
    â”‚                                        â”‚
    â”‚  Verification: SUCCESS âœ…              â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 5: Reset to Apply Config        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  11 01 (Hard Reset)                    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  51 01 âœ“                               â”‚
    â”‚                                        â”‚
    â”‚  [ECU resets and loads new config]     â”‚
    â”‚                                        â”‚
```

---

### Workflow 3: Manufacturing Data Programming (OTP)

```
  Tester                                    ECU
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 1: Programming Session          â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  10 02 (Programming Session)           â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  50 02 âœ“                               â”‚
    â”‚                                        â”‚
    â”‚  Session: PROGRAMMING ğŸ”´               â”‚
    â”‚  Security: LOCKED ğŸ”’                   â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 2: High Security Unlock         â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  27 0B (Request Seed - Level 5)        â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  67 0B AA BB CC DD EE FF (Seed)        â”‚
    â”‚                                        â”‚
    â”‚  [Tester calculates Level 5 key]       â”‚
    â”‚                                        â”‚
    â”‚  27 0C 11 22 33 44 55 66 (Send Key)    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  67 0C âœ“                               â”‚
    â”‚                                        â”‚
    â”‚  Security: UNLOCKED ğŸ”“ (Level 5)       â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 3: Verify OTP is Blank          â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  23 84 FF FF 00 00 00 00 00 10         â”‚
    â”‚  (Read 16 bytes from OTP region)       â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  63 FF FF FF FF FF FF FF FF            â”‚
    â”‚     FF FF FF FF FF FF FF FF            â”‚
    â”‚                                        â”‚
    â”‚  OTP Status: BLANK âœ… (all 0xFF)       â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 4: Write Serial Number (OTP)    â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  âš ï¸  CRITICAL: This can only be done   â”‚
    â”‚      ONCE. Double-check data!          â”‚
    â”‚                                        â”‚
    â”‚  3D 84 FF FF 00 00 00 00 00 10         â”‚
    â”‚     53 4E 31 32 33 34 35 36            â”‚
    â”‚     37 38 39 30 41 42 43 44            â”‚
    â”‚  (Write "SN1234567890ABCD")            â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚                                        â”‚
    â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚                          â”‚ Validate â”‚  â”‚
    â”‚                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”‚
    â”‚                          â”‚ Program  â”‚  â”‚
    â”‚                          â”‚ OTP      â”‚  â”‚
    â”‚                          â”‚ (ONCE)   â”‚  â”‚
    â”‚                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”‚
    â”‚                          â”‚ Lock     â”‚  â”‚
    â”‚                          â”‚ Cells    â”‚  â”‚
    â”‚                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”‚
    â”‚                          â”‚ Verify   â”‚  â”‚
    â”‚                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                               â”‚        â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  7D 84 FF FF 00 00 âœ“                   â”‚
    â”‚                                        â”‚
    â”‚  OTP Written: PERMANENT âš ï¸             â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 5: Verify Serial Number         â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  23 84 FF FF 00 00 00 00 00 10         â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  63 53 4E 31 32 33 34 35 36            â”‚
    â”‚     37 38 39 30 41 42 43 44 âœ“          â”‚
    â”‚                                        â”‚
    â”‚  Verification: SUCCESS âœ…              â”‚
    â”‚  Serial: "SN1234567890ABCD"            â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 6: Reset ECU                    â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  11 01 (Hard Reset)                    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  51 01 âœ“                               â”‚
    â”‚                                        â”‚
    â”‚  [ECU resets with programmed serial]   â”‚
    â”‚                                        â”‚
```

---

### Workflow 4: Flash Patching (Temporary Fix)

```
  Tester                                    ECU
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 1: Programming Session Setup    â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  10 02 â†’ 50 02 âœ“                       â”‚
    â”‚  27 05 â†’ 67 05 [seed]                  â”‚
    â”‚  27 06 â†’ 67 06 âœ“                       â”‚
    â”‚                                        â”‚
    â”‚  Session: PROGRAMMING ğŸ”´               â”‚
    â”‚  Security: UNLOCKED ğŸ”“ (Level 3)       â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 2: Read Current Flash Value     â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  23 44 08 00 10 00 00 00 00 04         â”‚
    â”‚  (Read 4 bytes from flash 0x08001000)  â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  63 E7 FE 07 00 (Original instruction) â”‚
    â”‚                                        â”‚
    â”‚  Original: 0xE7FE0700 (BL instruction) â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 3: Write Patched Instruction    â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  3D 44 08 00 10 00 00 00 00 04         â”‚
    â”‚     E7 FE 08 00                        â”‚
    â”‚  (Patch branch offset)                 â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚                                        â”‚
    â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚                          â”‚ Erase    â”‚  â”‚
    â”‚                          â”‚ Flash    â”‚  â”‚
    â”‚                          â”‚ Sector   â”‚  â”‚
    â”‚                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”‚
    â”‚                          â”‚ Write    â”‚  â”‚
    â”‚                          â”‚ Flash    â”‚  â”‚
    â”‚                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                          â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”  â”‚
    â”‚                          â”‚ Verify   â”‚  â”‚
    â”‚                          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚                               â”‚        â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  7D 44 08 00 10 00 âœ“                   â”‚
    â”‚                                        â”‚
    â”‚  Patch Applied: TEMPORARY âš ï¸           â”‚
    â”‚  (Lost on firmware update)             â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 4: Verify Patch                 â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  23 44 08 00 10 00 00 00 00 04         â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  63 E7 FE 08 00 âœ“                      â”‚
    â”‚                                        â”‚
    â”‚  Verification: SUCCESS âœ…              â”‚
    â”‚  Patched: 0xE7FE0800 (Fixed branch)    â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 5: Reset to Apply Patch         â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  11 01 (Hard Reset)                    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  51 01 âœ“                               â”‚
    â”‚                                        â”‚
    â”‚  [ECU resets with patched code]        â”‚
    â”‚                                        â”‚
```

---

### Workflow 5: Multi-Region Calibration Update

```
  Tester                                    ECU
    â”‚                                        â”‚
    â”‚  (Session + Security already set up)   â”‚
    â”‚  Session: EXTENDED ğŸŸ¢                  â”‚
    â”‚  Security: UNLOCKED ğŸ”“ (Level 1)       â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 1: Write RAM Calibration #1     â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  3D 44 20 00 10 00 00 00 00 04         â”‚
    â”‚     00 00 01 2C (Fuel map value: 300)  â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  7D 44 20 00 10 00 âœ“                   â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 2: Send TesterPresent           â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  3E 00 (Keep session alive)            â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  7E 00 âœ“                               â”‚
    â”‚                                        â”‚
    â”‚  S3 Timer: RESET âœ…                    â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 3: Write RAM Calibration #2     â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  3D 44 20 00 20 00 00 00 00 04         â”‚
    â”‚     00 00 00 64 (Ignition map: 100)    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  7D 44 20 00 20 00 âœ“                   â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 4: Write EEPROM Configuration   â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  3E 00 (TesterPresent)                 â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  7E 00 âœ“                               â”‚
    â”‚                                        â”‚
    â”‚  3D 84 08 08 00 00 00 00 00 08         â”‚
    â”‚     01 02 03 04 05 06 07 08            â”‚
    â”‚  (Config block)                        â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  7D 84 08 08 00 00 âœ“                   â”‚
    â”‚                                        â”‚
    â”‚  â±ï¸ EEPROM write took 50ms             â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 5: Verify All Writes            â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  23 44 20 00 10 00 00 00 00 04         â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  63 00 00 01 2C âœ“ (Fuel map OK)        â”‚
    â”‚                                        â”‚
    â”‚  23 44 20 00 20 00 00 00 00 04         â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  63 00 00 00 64 âœ“ (Ignition OK)        â”‚
    â”‚                                        â”‚
    â”‚  23 84 08 08 00 00 00 00 00 08         â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  63 01 02 03 04 05 06 07 08 âœ“          â”‚
    â”‚  (Config OK)                           â”‚
    â”‚                                        â”‚
    â”‚  All Writes Verified: SUCCESS âœ…       â”‚
    â”‚                                        â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚  PHASE 6: Activate Changes             â”‚
    â”‚â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
    â”‚                                        â”‚
    â”‚  31 01 FF 01 (Start Routine: Apply)    â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>   â”‚
    â”‚  <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚  71 01 FF 01 00 âœ“                      â”‚
    â”‚                                        â”‚
    â”‚  Calibration Applied: ACTIVE âœ…        â”‚
    â”‚                                        â”‚
```

---

## Multi-Service Interaction Patterns

### Pattern 1: Session â†’ Security â†’ Write â†’ Verify

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pattern: Secure Write with Verification           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Step 1: SID 0x10 (Change Session)                 â”‚
â”‚    â””â”€> Enable write capability                     â”‚
â”‚                                                    â”‚
â”‚  Step 2: SID 0x27 (Unlock Security)                â”‚
â”‚    â””â”€> Grant access to protected memory            â”‚
â”‚                                                    â”‚
â”‚  Step 3: SID 0x3D (Write Memory)                   â”‚
â”‚    â””â”€> Perform actual write                        â”‚
â”‚                                                    â”‚
â”‚  Step 4: SID 0x23 (Read Memory)                    â”‚
â”‚    â””â”€> Verify write success                        â”‚
â”‚                                                    â”‚
â”‚  Use Cases:                                        â”‚
â”‚    â€¢ Calibration updates                           â”‚
â”‚    â€¢ Configuration changes                         â”‚
â”‚    â€¢ Parameter programming                         â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Pattern 2: TesterPresent Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pattern: Long Operations with Keep-Alive          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Initial Setup:                                    â”‚
â”‚    SID 0x10 â†’ SID 0x27 (Session + Security)        â”‚
â”‚                                                    â”‚
â”‚  Repeated Loop:                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚    â”‚ 1. SID 0x3E (TesterPresent)     â”‚            â”‚
â”‚    â”‚    â””â”€> Reset S3 timeout          â”‚            â”‚
â”‚    â”‚                                  â”‚            â”‚
â”‚    â”‚ 2. SID 0x3D (Write Memory)       â”‚            â”‚
â”‚    â”‚    â””â”€> Write operation           â”‚            â”‚
â”‚    â”‚                                  â”‚            â”‚
â”‚    â”‚ 3. Delay if needed (EEPROM)      â”‚            â”‚
â”‚    â”‚                                  â”‚            â”‚
â”‚    â”‚ 4. SID 0x23 (Verify)             â”‚            â”‚
â”‚    â”‚    â””â”€> Check write               â”‚            â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚                                          â”‚
â”‚         â””â”€> Repeat for multiple writes             â”‚
â”‚                                                    â”‚
â”‚  Use Cases:                                        â”‚
â”‚    â€¢ Batch calibration updates                     â”‚
â”‚    â€¢ Multi-region programming                      â”‚
â”‚    â€¢ Long calibration sequences                    â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Pattern 3: Write â†’ Routine â†’ Reset

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pattern: Write with Activation and Reset          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Step 1: SID 0x10 + 0x27 (Setup)                   â”‚
â”‚    â””â”€> Session + Security                          â”‚
â”‚                                                    â”‚
â”‚  Step 2: SID 0x3D (Write Data)                     â”‚
â”‚    â””â”€> Update configuration/calibration            â”‚
â”‚                                                    â”‚
â”‚  Step 3: SID 0x23 (Verify)                         â”‚
â”‚    â””â”€> Confirm write success                       â”‚
â”‚                                                    â”‚
â”‚  Step 4: SID 0x31 (Start Routine)                  â”‚
â”‚    â””â”€> Apply/activate changes                      â”‚
â”‚         Examples:                                  â”‚
â”‚         â€¢ Recalculate checksums                    â”‚
â”‚         â€¢ Apply configuration                      â”‚
â”‚         â€¢ Validate data integrity                  â”‚
â”‚                                                    â”‚
â”‚  Step 5: SID 0x11 (ECU Reset)                      â”‚
â”‚    â””â”€> Restart with new data                       â”‚
â”‚                                                    â”‚
â”‚  Use Cases:                                        â”‚
â”‚    â€¢ EEPROM configuration programming              â”‚
â”‚    â€¢ Manufacturing data writes                     â”‚
â”‚    â€¢ Firmware patches                              â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Integration with Specific Services

### SID 0x10 (Session Control)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SID 0x3D â†” SID 0x10 Integration                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Session Control Determines Write Access:          â”‚
â”‚                                                    â”‚
â”‚    DEFAULT (0x01):                                 â”‚
â”‚      â€¢ SID 0x3D â†’ NRC 0x7F âŒ                      â”‚
â”‚      â€¢ No write access                             â”‚
â”‚                                                    â”‚
â”‚    EXTENDED (0x03):                                â”‚
â”‚      â€¢ SID 0x3D â†’ Allowed for RAM/EEPROM âœ…        â”‚
â”‚      â€¢ Requires security unlock                    â”‚
â”‚                                                    â”‚
â”‚    PROGRAMMING (0x02):                             â”‚
â”‚      â€¢ SID 0x3D â†’ Allowed for all regions âœ…       â”‚
â”‚      â€¢ Higher security for flash/OTP               â”‚
â”‚                                                    â”‚
â”‚  Session Timeout Impact:                           â”‚
â”‚    â€¢ S3 timeout (5s) returns to DEFAULT            â”‚
â”‚    â€¢ SID 0x3E prevents timeout                     â”‚
â”‚    â€¢ Security reset on session change              â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SID 0x27 (Security Access)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SID 0x3D â†” SID 0x27 Integration                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Security Levels by Memory Type:                   â”‚
â”‚                                                    â”‚
â”‚    RAM Write:                                      â”‚
â”‚      27 01/02 (Level 1) â†’ 3D ... âœ…                â”‚
â”‚                                                    â”‚
â”‚    EEPROM Write:                                   â”‚
â”‚      27 01/02 (Level 1) â†’ 3D ... âœ…                â”‚
â”‚                                                    â”‚
â”‚    Flash Write:                                    â”‚
â”‚      27 05/06 (Level 3) â†’ 3D ... âœ…                â”‚
â”‚      Lower levels â†’ NRC 0x33 âŒ                    â”‚
â”‚                                                    â”‚
â”‚    OTP Write:                                      â”‚
â”‚      27 0B/0C (Level 5) â†’ 3D ... âœ…                â”‚
â”‚      Lower levels â†’ NRC 0x33 âŒ                    â”‚
â”‚                                                    â”‚
â”‚  Security State Preservation:                      â”‚
â”‚    â€¢ 10 03 (EXTENDED) â†’ Preserves security         â”‚
â”‚    â€¢ 10 02/01 â†’ Resets security ğŸ”’                 â”‚
â”‚    â€¢ Timeout â†’ Resets security ğŸ”’                  â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SID 0x23 (Read Memory By Address)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SID 0x3D â†” SID 0x23 Integration                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Write-Verify Pattern:                             â”‚
â”‚                                                    â”‚
â”‚    1. Write: 3D 44 20 00 10 00 00 00 00 04         â”‚
â”‚               12 34 56 78                          â”‚
â”‚       Response: 7D 44 20 00 10 00 âœ“                â”‚
â”‚                                                    â”‚
â”‚    2. Read:  23 44 20 00 10 00 00 00 00 04         â”‚
â”‚       Response: 63 12 34 56 78 âœ“                   â”‚
â”‚                                                    â”‚
â”‚    3. Compare: Written = Read?                     â”‚
â”‚       âœ… Match â†’ Success                           â”‚
â”‚       âŒ Mismatch â†’ Retry or fail                  â”‚
â”‚                                                    â”‚
â”‚  Use Same ALFID:                                   â”‚
â”‚    â€¢ 3D uses ALFID 0x44                            â”‚
â”‚    â€¢ 23 uses ALFID 0x44 (same)                     â”‚
â”‚    â€¢ Same address and size                         â”‚
â”‚                                                    â”‚
â”‚  Timing Consideration:                             â”‚
â”‚    â€¢ RAM: Immediate read-back OK                   â”‚
â”‚    â€¢ EEPROM: Wait 50-100ms before read             â”‚
â”‚    â€¢ Flash: Immediate read-back OK                 â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SID 0x3E (TesterPresent)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SID 0x3D â†” SID 0x3E Integration                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Prevent Session Timeout During Long Operations:   â”‚
â”‚                                                    â”‚
â”‚    Scenario: Multiple EEPROM writes                â”‚
â”‚                                                    â”‚
â”‚      FOR each calibration value:                   â”‚
â”‚        1. Send TesterPresent (3E 00)               â”‚
â”‚           â””â”€> Reset S3 timer to 5s                 â”‚
â”‚                                                    â”‚
â”‚        2. Write value (3D ...)                     â”‚
â”‚           â””â”€> May take 50ms                        â”‚
â”‚                                                    â”‚
â”‚        3. Verify (23 ...)                          â”‚
â”‚           â””â”€> Check write                          â”‚
â”‚                                                    â”‚
â”‚        4. Process next value                       â”‚
â”‚                                                    â”‚
â”‚  Timing Strategy:                                  â”‚
â”‚    â€¢ S3 timeout: 5000ms                            â”‚
â”‚    â€¢ Each EEPROM write: 50ms                       â”‚
â”‚    â€¢ Send 3E every 2-3 seconds                     â”‚
â”‚    â€¢ Ensures no timeout during batch writes        â”‚
â”‚                                                    â”‚
â”‚  TesterPresent Frequency:                          â”‚
â”‚    â€¢ Fast operations: Every 10-20 writes           â”‚
â”‚    â€¢ Slow operations (EEPROM): Every 2-3 writes    â”‚
â”‚    â€¢ Very long sequences: Every 2 seconds          â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SID 0x31 (Routine Control)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SID 0x3D â†” SID 0x31 Integration                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Pre-Write Routines:                               â”‚
â”‚    31 01 FF 00 (Prepare Memory)                    â”‚
â”‚      â””â”€> Unlock write protection                   â”‚
â”‚      â””â”€> Disable watchdog                          â”‚
â”‚      â””â”€> Prepare memory controller                 â”‚
â”‚                                                    â”‚
â”‚  Post-Write Routines:                              â”‚
â”‚    31 01 FF 01 (Apply Changes)                     â”‚
â”‚      â””â”€> Recalculate checksums                     â”‚
â”‚      â””â”€> Validate data integrity                   â”‚
â”‚      â””â”€> Activate new configuration                â”‚
â”‚                                                    â”‚
â”‚  Example Workflow:                                 â”‚
â”‚    1. 10 03 + 27 01/02 (Setup)                     â”‚
â”‚    2. 31 01 FF 00 (Prepare)                        â”‚
â”‚    3. 3D ... (Write data)                          â”‚
â”‚    4. 23 ... (Verify)                              â”‚
â”‚    5. 31 01 FF 01 (Apply)                          â”‚
â”‚    6. 11 01 (Reset)                                â”‚
â”‚                                                    â”‚
â”‚  Common Routines:                                  â”‚
â”‚    â€¢ 0xFF00: Prepare write                         â”‚
â”‚    â€¢ 0xFF01: Apply/finalize                        â”‚
â”‚    â€¢ 0xFF02: Validate checksum                     â”‚
â”‚    â€¢ 0xFF03: Restore defaults                      â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SID 0x11 (ECU Reset)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SID 0x3D â†” SID 0x11 Integration                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Reset After Write Operations:                     â”‚
â”‚                                                    â”‚
â”‚    EEPROM Configuration Write:                     â”‚
â”‚      1. Write config (3D ...)                      â”‚
â”‚      2. Verify (23 ...)                            â”‚
â”‚      3. Reset ECU (11 01)                          â”‚
â”‚         â””â”€> Load new configuration                 â”‚
â”‚                                                    â”‚
â”‚    OTP Programming:                                â”‚
â”‚      1. Write OTP (3D ...)                         â”‚
â”‚      2. Verify (23 ...)                            â”‚
â”‚      3. Hard reset (11 01)                         â”‚
â”‚         â””â”€> Lock OTP cells permanently             â”‚
â”‚                                                    â”‚
â”‚    Flash Patch:                                    â”‚
â”‚      1. Write patch (3D ...)                       â”‚
â”‚      2. Verify (23 ...)                            â”‚
â”‚      3. Reset (11 01)                              â”‚
â”‚         â””â”€> Execute patched code                   â”‚
â”‚                                                    â”‚
â”‚  Reset Types for Write Operations:                 â”‚
â”‚    â€¢ 11 01 (Hard Reset): Most common               â”‚
â”‚    â€¢ 11 03 (Soft Reset): RAM changes only          â”‚
â”‚    â€¢ 11 04 (RapidPowerShutdown): Flash changes     â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Troubleshooting Multi-Service Scenarios

### Problem 1: Security Works but Write Fails (NRC 0x31)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Symptom: Security unlocked, but write returns     â”‚
â”‚           NRC 0x31 (Request Out Of Range)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Observed Sequence:                                â”‚
â”‚    10 03 â†’ 50 03 âœ“                                 â”‚
â”‚    27 01 â†’ 67 01 ... âœ“                             â”‚
â”‚    27 02 â†’ 67 02 âœ“ (Security unlocked)             â”‚
â”‚    3D 44 08 00 10 00 ... â†’ 7F 3D 31 âŒ             â”‚
â”‚                                                    â”‚
â”‚  Root Causes:                                      â”‚
â”‚    1. Wrong session for memory type                â”‚
â”‚       â€¢ Flash requires PROGRAMMING (10 02)         â”‚
â”‚       â€¢ Currently in EXTENDED (10 03)              â”‚
â”‚                                                    â”‚
â”‚    2. Address not writable                         â”‚
â”‚       â€¢ May be in ROM region                       â”‚
â”‚       â€¢ May be protected code area                 â”‚
â”‚                                                    â”‚
â”‚  Solutions:                                        â”‚
â”‚    Solution A: Switch to Programming Session       â”‚
â”‚      10 02 â†’ 50 02 âœ“                               â”‚
â”‚      27 05 â†’ ... (Re-unlock for Level 3)           â”‚
â”‚      3D 44 08 00 10 00 ... â†’ 7D ... âœ“              â”‚
â”‚                                                    â”‚
â”‚    Solution B: Use RAM/EEPROM Address              â”‚
â”‚      3D 44 20 00 10 00 ... (RAM) â†’ 7D ... âœ“        â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Problem 2: Write Succeeds but Verification Fails

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Symptom: Positive response from write, but        â”‚
â”‚           read-back shows different value          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Observed Sequence:                                â”‚
â”‚    3D 44 08 08 00 00 00 00 00 04                   â”‚
â”‚       AA BB CC DD â†’ 7D 44 08 08 00 00 âœ“            â”‚
â”‚                                                    â”‚
â”‚    23 44 08 08 00 00 00 00 00 04                   â”‚
â”‚       â†’ 63 AA BB 00 00 âŒ (Last 2 bytes wrong)     â”‚
â”‚                                                    â”‚
â”‚  Root Causes:                                      â”‚
â”‚    1. EEPROM not settled yet                       â”‚
â”‚       â€¢ Read too soon after write                  â”‚
â”‚       â€¢ EEPROM needs 50-100ms to stabilize         â”‚
â”‚                                                    â”‚
â”‚    2. Memory corruption                            â”‚
â”‚       â€¢ Hardware failure                           â”‚
â”‚       â€¢ Voltage drop during write                  â”‚
â”‚                                                    â”‚
â”‚    3. Wrong address read                           â”‚
â”‚       â€¢ Typo in read address                       â”‚
â”‚       â€¢ Off-by-one error                           â”‚
â”‚                                                    â”‚
â”‚  Solutions:                                        â”‚
â”‚    Solution A: Wait for EEPROM                     â”‚
â”‚      3D ... (Write EEPROM)                         â”‚
â”‚      [Wait 100ms]                                  â”‚
â”‚      23 ... (Read back) â†’ Should match now âœ“       â”‚
â”‚                                                    â”‚
â”‚    Solution B: Retry Write                         â”‚
â”‚      3D ... (Retry write)                          â”‚
â”‚      23 ... (Verify again)                         â”‚
â”‚                                                    â”‚
â”‚    Solution C: Check Hardware                      â”‚
â”‚      â€¢ Verify battery voltage > 11.5V              â”‚
â”‚      â€¢ Check for memory errors                     â”‚
â”‚      â€¢ May need ECU replacement                    â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Problem 3: Session Timeout During Batch Writes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Symptom: First few writes succeed, then get       â”‚
â”‚           NRC 0x7F or need to re-establish session â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Observed Sequence:                                â”‚
â”‚    10 03 â†’ 50 03 âœ“                                 â”‚
â”‚    27 01/02 â†’ Unlocked âœ“                           â”‚
â”‚    3D ... (Write 1) â†’ 7D ... âœ“                     â”‚
â”‚    3D ... (Write 2) â†’ 7D ... âœ“                     â”‚
â”‚    [2 seconds pass]                                â”‚
â”‚    3D ... (Write 3) â†’ 7D ... âœ“                     â”‚
â”‚    [3 more seconds pass]                           â”‚
â”‚    3D ... (Write 4) â†’ 7F 3D 7F âŒ                  â”‚
â”‚    (Session timed out after 5s total)              â”‚
â”‚                                                    â”‚
â”‚  Root Cause:                                       â”‚
â”‚    â€¢ S3 timeout (5000ms) expired                   â”‚
â”‚    â€¢ No TesterPresent sent                         â”‚
â”‚    â€¢ Session returned to DEFAULT                   â”‚
â”‚                                                    â”‚
â”‚  Solution: Add TesterPresent                       â”‚
â”‚    10 03 + 27 01/02 (Setup)                        â”‚
â”‚                                                    â”‚
â”‚    FOR each write:                                 â”‚
â”‚      3E 00 â†’ 7E 00 âœ“ (Reset timer)                 â”‚
â”‚      3D ... â†’ 7D ... âœ“ (Write)                     â”‚
â”‚      23 ... â†’ 63 ... âœ“ (Verify)                    â”‚
â”‚                                                    â”‚
â”‚  TesterPresent Strategy:                           â”‚
â”‚    â€¢ Send every 2-3 seconds                        â”‚
â”‚    â€¢ OR before each write operation                â”‚
â”‚    â€¢ Ensures S3 timer never expires                â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Problem 4: Security Lost After Session Change

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Symptom: Security unlocked, then lost after       â”‚
â”‚           changing session                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Observed Sequence:                                â”‚
â”‚    10 03 â†’ 50 03 âœ“                                 â”‚
â”‚    27 01/02 â†’ Unlocked âœ“ (Level 1)                 â”‚
â”‚    3D ... (RAM write) â†’ 7D ... âœ“                   â”‚
â”‚                                                    â”‚
â”‚    10 02 â†’ 50 02 âœ“ (Switch to PROGRAMMING)         â”‚
â”‚    Security: RESET ğŸ”’                              â”‚
â”‚                                                    â”‚
â”‚    3D ... (Flash write) â†’ 7F 3D 33 âŒ              â”‚
â”‚    (Security access denied)                        â”‚
â”‚                                                    â”‚
â”‚  Root Cause:                                       â”‚
â”‚    â€¢ Changing to PROGRAMMING session resets securityâ”‚
â”‚    â€¢ Security state not preserved                  â”‚
â”‚                                                    â”‚
â”‚  Solution: Re-unlock After Session Change          â”‚
â”‚    10 03 â†’ 50 03 âœ“                                 â”‚
â”‚    27 01/02 â†’ Unlocked âœ“                           â”‚
â”‚    3D ... (RAM writes) â†’ âœ“                         â”‚
â”‚                                                    â”‚
â”‚    10 02 â†’ 50 02 âœ“                                 â”‚
â”‚    27 05/06 â†’ Unlocked âœ“ (Re-unlock Level 3)       â”‚
â”‚    3D ... (Flash write) â†’ 7D ... âœ“                 â”‚
â”‚                                                    â”‚
â”‚  Exception: Staying in Same Session                â”‚
â”‚    10 03 â†’ 50 03 âœ“                                 â”‚
â”‚    27 01/02 â†’ Unlocked âœ“                           â”‚
â”‚    10 03 â†’ 50 03 âœ“ (Same session)                  â”‚
â”‚    Security: PRESERVED âœ“                           â”‚
â”‚    3D ... â†’ 7D ... âœ“ (Still works)                 â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Quick Reference Tables

### Memory Region Reference

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Region     â”‚ Address Range   â”‚ Session  â”‚ Security   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ROM        â”‚ 0x00000000-     â”‚ N/A      â”‚ N/A        â”‚
â”‚            â”‚ 0x0007FFFF      â”‚ âŒ       â”‚ âŒ         â”‚
â”‚            â”‚                 â”‚ Not      â”‚ Read-Only  â”‚
â”‚            â”‚                 â”‚ Writable â”‚            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Flash      â”‚ 0x08000000-     â”‚ PROGRAM  â”‚ Level 3    â”‚
â”‚            â”‚ 0x0807FFFF      â”‚ (0x02)   â”‚ (27 05/06) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RAM        â”‚ 0x20000000-     â”‚ EXTENDED â”‚ Level 1    â”‚
â”‚            â”‚ 0x2001FFFF      â”‚ (0x03)   â”‚ (27 01/02) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EEPROM     â”‚ 0x08080000-     â”‚ EXTENDED â”‚ Level 1    â”‚
â”‚            â”‚ 0x080807FF      â”‚ (0x03)   â”‚ (27 01/02) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OTP        â”‚ 0xFFFF0000-     â”‚ PROGRAM  â”‚ Level 5    â”‚
â”‚            â”‚ 0xFFFF00FF      â”‚ (0x02)   â”‚ (27 0B/0C) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ALFID Quick Reference

```
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ALFIDâ”‚ Addr   â”‚ Size     â”‚ Example Use       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x11 â”‚ 1 byte â”‚ 1 byte   â”‚ Small MCU test    â”‚
â”‚ 0x24 â”‚ 2 bytesâ”‚ 2 bytes  â”‚ 16-bit systems    â”‚
â”‚ 0x44 â”‚ 4 bytesâ”‚ 4 bytes  â”‚ Most common (32b) â”‚
â”‚ 0x48 â”‚ 4 bytesâ”‚ 8 bytes  â”‚ 64-bit data       â”‚
â”‚ 0x84 â”‚ 4 bytesâ”‚ 8 bytes  â”‚ Config blocks     â”‚
â”‚ 0xF4 â”‚ 4 bytesâ”‚ 15 bytes â”‚ Maximum data size â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### NRC Quick Reference

```
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NRC  â”‚ Name               â”‚ Common Cause         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x13 â”‚ Incorrect Length   â”‚ ALFID mismatch       â”‚
â”‚ 0x22 â”‚ Conditions Not OK  â”‚ Engine running       â”‚
â”‚ 0x31 â”‚ Out Of Range       â”‚ ROM/Invalid address  â”‚
â”‚ 0x33 â”‚ Security Denied    â”‚ Not unlocked         â”‚
â”‚ 0x72 â”‚ Programming Fail   â”‚ Hardware error       â”‚
â”‚ 0x7F â”‚ Not Supported      â”‚ Wrong session        â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Related Services Quick Reference

```
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SID  â”‚ Name              â”‚ Use with SID 0x3D     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x10 â”‚ Session Control   â”‚ Enable write access   â”‚
â”‚ 0x23 â”‚ Read Memory       â”‚ Verify write          â”‚
â”‚ 0x27 â”‚ Security Access   â”‚ Unlock protection     â”‚
â”‚ 0x2E â”‚ Write DID         â”‚ Alternative (struct)  â”‚
â”‚ 0x31 â”‚ Routine Control   â”‚ Pre/post operations   â”‚
â”‚ 0x3E â”‚ TesterPresent     â”‚ Keep session alive    â”‚
â”‚ 0x11 â”‚ ECU Reset         â”‚ Apply changes         â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**End of SID 0x3D Service Interactions Guide**
