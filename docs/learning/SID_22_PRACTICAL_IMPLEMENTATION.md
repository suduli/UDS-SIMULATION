# SID 0x22: Practical Implementation Guide

**Document Version**: 2.0  
**Last Updated**: October 12, 2025  
**Format**: Visual Diagrams (No Code)  
**ISO Reference**: ISO 14229-1:2020 Section 9.2

---

## Table of Contents

1. [Request Processing Flow](#request-processing-flow)
2. [DID Lookup Logic](#did-lookup-logic)
3. [NRC Decision Trees](#nrc-decision-trees)
4. [State Machine Diagrams](#state-machine-diagrams)
5. [Testing Scenarios](#testing-scenarios)
6. [Integration Patterns](#integration-patterns)
7. [Debugging Guide](#debugging-guide)
8. [Best Practices](#best-practices)

---

## Request Processing Flow

### High-Level Processing Flowchart

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Receive Request  â”‚
                    â”‚   (SID 0x22)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Validate Length  â”‚
               â”Œâ”€â”€â”€â”€â”¤ (1 + NÃ—2 bytes)? â”‚â”€â”€â”€â”€â”
               â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
              NO                            YES
               â”‚                             â”‚
               â–¼                             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Return NRC  â”‚           â”‚ Extract DIDs     â”‚
        â”‚    0x13     â”‚           â”‚ from message     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚ For each DID:    â”‚
                                  â”‚ 1. Validate      â”‚
                                  â”‚ 2. Check Session â”‚
                                  â”‚ 3. Check Securityâ”‚
                                  â”‚ 4. Get Data      â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                      â”‚                      â”‚
                   Fail                  Pass                   Fail
                    â”‚                      â”‚                   (Later)
                    â–¼                      â–¼                      â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
            â”‚ Return First â”‚      â”‚ Build        â”‚              â”‚
            â”‚ NRC Found    â”‚      â”‚ Response     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ (0x62 + data)â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚ Send Responseâ”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Detailed Request Validation Flow

```
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Start Validation    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Check byte 0 = 0x22?â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
              â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
             NO           YES
              â”‚             â”‚
              â–¼             â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Ignore  â”‚   â”‚ Length Check:    â”‚
         â”‚ (not    â”‚   â”‚ (Len-1) mod 2=0? â”‚
         â”‚ 0x22)   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
                          â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
                         NO           YES
                          â”‚             â”‚
                          â–¼             â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚Return NRCâ”‚   â”‚ Extract DIDs â”‚
                   â”‚   0x13   â”‚   â”‚ Count =      â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ (Len-1)/2    â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚ Proceed to   â”‚
                                  â”‚ DID Lookup   â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## DID Lookup Logic

### DID Table Lookup Process

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DID LOOKUP ALGORITHM                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  Input: DID value (2 bytes)                                â”‚
â”‚                                                            â”‚
â”‚  Step 1: Search DID Configuration Table                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ DID Table Structure (Example)                    â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚  DID   â”‚  Length  â”‚ Session â”‚ Security â”‚ Handlerâ”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ 0xF190 â”‚ 17 bytes â”‚ ANY     â”‚ NONE     â”‚ VIN()  â”‚     â”‚
â”‚  â”‚ 0xF18C â”‚ 10 bytes â”‚ ANY     â”‚ NONE     â”‚ SN()   â”‚     â”‚
â”‚  â”‚ 0x0105 â”‚ 1 byte   â”‚ EXT     â”‚ NONE     â”‚ TEMP() â”‚     â”‚
â”‚  â”‚ 0x2000 â”‚ Variable â”‚ EXT     â”‚ L1       â”‚ CAL()  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                            â”‚
â”‚  Step 2: Check if DID exists                               â”‚
â”‚  â”œâ”€ Found â†’ Continue                                       â”‚
â”‚  â””â”€ Not Found â†’ Return NRC 0x31                            â”‚
â”‚                                                            â”‚
â”‚  Step 3: Validate Session Requirement                      â”‚
â”‚  â”œâ”€ Current session matches â†’ Continue                     â”‚
â”‚  â””â”€ Session mismatch â†’ Return NRC 0x7F                     â”‚
â”‚                                                            â”‚
â”‚  Step 4: Validate Security Requirement                     â”‚
â”‚  â”œâ”€ Security OK or not needed â†’ Continue                   â”‚
â”‚  â””â”€ Security locked â†’ Return NRC 0x33                      â”‚
â”‚                                                            â”‚
â”‚  Step 5: Check Additional Conditions                       â”‚
â”‚  â”œâ”€ Conditions met â†’ Continue                              â”‚
â”‚  â””â”€ Conditions not met â†’ Return NRC 0x22                   â”‚
â”‚                                                            â”‚
â”‚  Step 6: Execute DID Handler & Get Data                    â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Multi-DID Processing Flow

```
   DID List: [0xF190, 0xF18C, 0x2000]
        â”‚
        â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Process      â”‚
   â”‚ DID 0xF190   â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
     âœ“ Success
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Store data   â”‚
   â”‚ in buffer    â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Process      â”‚
   â”‚ DID 0xF18C   â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
     âœ“ Success
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Append data  â”‚
   â”‚ to buffer    â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Process      â”‚
   â”‚ DID 0x2000   â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
     âœ— Fail (NRC 0x33 - Security)
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Discard      â”‚
   â”‚ buffer       â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Return NRC   â”‚
   â”‚    0x33      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   âš ï¸ IMPORTANT: If ANY DID fails, entire request fails!
```

---

## NRC Decision Trees

### Master NRC Decision Tree

```
                        Start Processing
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Message length   â”‚
               â”Œâ”€â”€â”€â”€â”¤ = 1 + (NÃ—2)?     â”‚â”€â”€â”€â”€â”
              NO    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   YES
               â”‚                             â”‚
               â–¼                             â–¼
          NRC 0x13                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚ All DIDs exist â”‚
                               â”Œâ”€â”€â”€â”€â”¤ in ECU?        â”‚â”€â”€â”€â”€â”
                              NO    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   YES
                               â”‚                           â”‚
                               â–¼                           â–¼
                          NRC 0x31              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                â”‚ Session          â”‚
                                           â”Œâ”€â”€â”€â”€â”¤ requirements OK? â”‚â”€â”€â”€â”€â”
                                          NO    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   YES
                                           â”‚                             â”‚
                                           â–¼                             â–¼
                                      NRC 0x7F              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                            â”‚ Security        â”‚
                                                       â”Œâ”€â”€â”€â”€â”¤ requirements OK?â”‚â”€â”€â”€â”€â”
                                                      NO    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   YES
                                                       â”‚                            â”‚
                                                       â–¼                            â–¼
                                                  NRC 0x33              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                                        â”‚ Vehicle        â”‚
                                                                   â”Œâ”€â”€â”€â”€â”¤ conditions OK? â”‚â”€â”€â”€â”€â”
                                                                  NO    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   YES
                                                                   â”‚                           â”‚
                                                                   â–¼                           â–¼
                                                              NRC 0x22              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                                                    â”‚ Response     â”‚
                                                                               â”Œâ”€â”€â”€â”€â”¤ fits buffer? â”‚â”€â”€â”€â”€â”
                                                                              NO    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   YES
                                                                               â”‚                         â”‚
                                                                               â–¼                         â–¼
                                                                          NRC 0x14              Positive Response
                                                                                                      0x62
```

### Specific Condition Decision Trees

#### Session Validation Tree

```
       Current Session?
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚         â”‚         â”‚
DEFAULT    EXTENDED  PROGRAMMING OTHER
    â”‚         â”‚         â”‚         â”‚
    â–¼         â–¼         â–¼         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DID   â”‚ â”‚  DID   â”‚ â”‚  DID   â”‚ â”‚ Return â”‚
â”‚requiresâ”‚ â”‚requiresâ”‚ â”‚requiresâ”‚ â”‚NRC 0x7Fâ”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚          â”‚          â”‚
    â–¼          â–¼          â–¼
Compare   Compare    Compare
    â”‚          â”‚          â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”  â”Œâ”€â”€â”€â”´â”€â”€â”€â”  â”Œâ”€â”€â”€â”´â”€â”€â”€â”
â”‚       â”‚  â”‚       â”‚  â”‚       â”‚
OK     Fail OK    Fail OK    Fail
â”‚       â”‚  â”‚       â”‚  â”‚       â”‚
â–¼       â–¼  â–¼       â–¼  â–¼       â–¼
Continue  NRC Continue NRC Continue NRC
         0x7F        0x7F         0x7F
```

#### Security Validation Tree

```
       DID Security Level Required?
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         â”‚         â”‚
      NONE       L1      L2/L3
        â”‚         â”‚         â”‚
        â–¼         â–¼         â–¼
    Continue  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚Securityâ”‚ â”‚Securityâ”‚
              â”‚Unlockedâ”‚ â”‚Unlockedâ”‚
              â”‚   ?    â”‚ â”‚   ?    â”‚
              â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                  â”‚          â”‚
            â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”
           YES          NO YES      NO
            â”‚            â”‚  â”‚        â”‚
            â–¼            â–¼  â–¼        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Check  â”‚  â”‚ Return â”‚  â”‚ Return â”‚
        â”‚ Level  â”‚  â”‚NRC 0x33â”‚  â”‚NRC 0x33â”‚
        â”‚ Match  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
            â”‚
      â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
     Match     Mismatch
      â”‚            â”‚
      â–¼            â–¼
  Continue    NRC 0x33
```

---

## State Machine Diagrams

### Session State Transitions with SID 0x22

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SESSION STATE MACHINE                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚        â”‚   DEFAULT SESSION (0x01)        â”‚                  â”‚
â”‚        â”‚                                 â”‚                  â”‚
â”‚        â”‚  Available DIDs:                â”‚                  â”‚
â”‚        â”‚  â€¢ VIN (0xF190)                 â”‚                  â”‚
â”‚        â”‚  â€¢ Serial (0xF18C)              â”‚                  â”‚
â”‚        â”‚  â€¢ Basic Info DIDs              â”‚                  â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                  â”‚                                          â”‚
â”‚                  â”‚ SID 0x10 0x03                            â”‚
â”‚                  â”‚ (Enter Extended)                         â”‚
â”‚                  â–¼                                          â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚        â”‚  EXTENDED SESSION (0x03)        â”‚                  â”‚
â”‚        â”‚                                 â”‚                  â”‚
â”‚        â”‚  Available DIDs:                â”‚                  â”‚
â”‚        â”‚  â€¢ All DEFAULT DIDs             â”‚                  â”‚
â”‚        â”‚  â€¢ Live Sensor Data             â”‚                  â”‚
â”‚        â”‚  â€¢ Runtime Parameters           â”‚                  â”‚
â”‚        â”‚  â€¢ Secured DIDs (if unlocked)   â”‚                  â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                  â”‚                                          â”‚
â”‚                  â”‚ SID 0x10 0x02                            â”‚
â”‚                  â”‚ (Enter Programming)                      â”‚
â”‚                  â–¼                                          â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚        â”‚ PROGRAMMING SESSION (0x02)      â”‚                  â”‚
â”‚        â”‚                                 â”‚                  â”‚
â”‚        â”‚  Available DIDs:                â”‚                  â”‚
â”‚        â”‚  â€¢ Programming Status           â”‚                  â”‚
â”‚        â”‚  â€¢ Flash State                  â”‚                  â”‚
â”‚        â”‚  â€¢ Limited Diagnostic DIDs      â”‚                  â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                              â”‚
â”‚   Timeout or SID 0x10 0x01 returns to DEFAULT               â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Security State Transitions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            SECURITY STATE FOR DID ACCESS                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚  â”‚  LOCKED ðŸ”’     â”‚                                          â”‚
â”‚  â”‚                â”‚                                          â”‚
â”‚  â”‚  SID 0x22:     â”‚                                          â”‚
â”‚  â”‚  â€¢ Public DIDs â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚    âœ“ Allowed   â”‚                    â”‚                    â”‚
â”‚  â”‚  â€¢ Secured DIDsâ”‚                    â”‚                    â”‚
â”‚  â”‚    âœ— NRC 0x33  â”‚                    â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚                    â”‚
â”‚           â”‚                            â”‚                    â”‚
â”‚           â”‚ SID 0x27 (Request Seed)    â”‚                    â”‚
â”‚           â–¼                            â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚                    â”‚
â”‚  â”‚ SEED SENT      â”‚                    â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚                    â”‚
â”‚           â”‚                            â”‚                    â”‚
â”‚           â”‚ SID 0x27 (Send Key)        â”‚                    â”‚
â”‚           â–¼                            â”‚                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                     â”‚                    â”‚
â”‚    Correct    Wrong                    â”‚                    â”‚
â”‚     â”‚            â”‚                     â”‚                    â”‚
â”‚     â–¼            â–¼                     â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚                    â”‚
â”‚  â”‚UNLOCKEDâ”‚  â”‚LOCKED  â”‚               â”‚                    â”‚
â”‚  â”‚  ðŸ”“    â”‚  â”‚COUNTER++â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚  â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚  â”‚SID 0x22â”‚                                                 â”‚
â”‚  â”‚ â€¢ All  â”‚                                                 â”‚
â”‚  â”‚  DIDs  â”‚                                                 â”‚
â”‚  â”‚  âœ“ OK  â”‚                                                 â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜                                                 â”‚
â”‚       â”‚                                                     â”‚
â”‚       â”‚ Timeout (5s) or Session Change                      â”‚
â”‚       â–¼                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚  â”‚  LOCKED ðŸ”’     â”‚                                          â”‚
â”‚  â”‚  (Auto-lock)   â”‚                                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Testing Scenarios

### Test Case 1: Basic VIN Read

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TEST: Read Vehicle Identification Number                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚ Setup:                                                     â”‚
â”‚ â€¢ Session: DEFAULT                                         â”‚
â”‚ â€¢ Security: LOCKED (not needed)                            â”‚
â”‚                                                            â”‚
â”‚ Test Steps:                                                â”‚
â”‚                                                            â”‚
â”‚   Tester                     ECU                           â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚  22 F1 90              â”‚                            â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚                         â”‚ [Lookup DID 0xF190]        â”‚
â”‚     â”‚                         â”‚ [Found: VIN, 17 bytes]     â”‚
â”‚     â”‚                         â”‚ [Session: OK]              â”‚
â”‚     â”‚                         â”‚ [Security: Not required]   â”‚
â”‚     â”‚                         â”‚ [Get VIN data]             â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚  62 F1 90 + [17 bytes]  â”‚                            â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                            â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚                                                            â”‚
â”‚ Expected Result: âœ“ SUCCESS                                 â”‚
â”‚ Response: 0x62 F1 90 [VIN data]                            â”‚
â”‚                                                            â”‚
â”‚ Verify:                                                    â”‚
â”‚ â€¢ Response starts with 0x62                                â”‚
â”‚ â€¢ DID echoed back (F1 90)                                  â”‚
â”‚ â€¢ Data length = 17 bytes                                   â”‚
â”‚ â€¢ VIN format valid (alphanumeric)                          â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Test Case 2: Multiple DIDs Read

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TEST: Read VIN + Serial Number + SW Version               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚ Setup:                                                     â”‚
â”‚ â€¢ Session: DEFAULT                                         â”‚
â”‚ â€¢ Security: LOCKED (not needed)                            â”‚
â”‚                                                            â”‚
â”‚ Test Steps:                                                â”‚
â”‚                                                            â”‚
â”‚   Tester                     ECU                           â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚  22 F190 F18C F189      â”‚                            â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚                         â”‚ [Process DID 0xF190: OK]   â”‚
â”‚     â”‚                         â”‚ [Process DID 0xF18C: OK]   â”‚
â”‚     â”‚                         â”‚ [Process DID 0xF189: OK]   â”‚
â”‚     â”‚                         â”‚ [Build combined response]  â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚  62 F190[17B] F18C[10B] â”‚                            â”‚
â”‚     â”‚     F189[variable]      â”‚                            â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                            â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚                                                            â”‚
â”‚ Expected Result: âœ“ SUCCESS                                 â”‚
â”‚ Response contains all three DIDs + data                    â”‚
â”‚                                                            â”‚
â”‚ Verify:                                                    â”‚
â”‚ â€¢ All DIDs echoed in order requested                       â”‚
â”‚ â€¢ All data present and correct length                      â”‚
â”‚ â€¢ Total message length reasonable                          â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Test Case 3: Invalid DID (NRC 0x31)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TEST: Request non-existent DID                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚ Test Steps:                                                â”‚
â”‚                                                            â”‚
â”‚   Tester                     ECU                           â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚  22 99 99              â”‚ (DID 0x9999 doesn't exist) â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚                         â”‚ [Search DID table]         â”‚
â”‚     â”‚                         â”‚ [0x9999 NOT FOUND]         â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚  7F 22 31              â”‚                            â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                            â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚                                                            â”‚
â”‚ Expected Result: âœ“ NEGATIVE RESPONSE                       â”‚
â”‚ NRC 0x31 (Request Out Of Range)                            â”‚
â”‚                                                            â”‚
â”‚ Verify:                                                    â”‚
â”‚ â€¢ Byte 0 = 0x7F                                            â”‚
â”‚ â€¢ Byte 1 = 0x22 (requested SID)                            â”‚
â”‚ â€¢ Byte 2 = 0x31 (NRC)                                      â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Test Case 4: Wrong Session (NRC 0x7F)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TEST: Read EXTENDED-only DID in DEFAULT session           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚ Setup:                                                     â”‚
â”‚ â€¢ Session: DEFAULT                                         â”‚
â”‚ â€¢ Target DID: 0x0105 (requires EXTENDED)                   â”‚
â”‚                                                            â”‚
â”‚ Test Steps:                                                â”‚
â”‚                                                            â”‚
â”‚   Tester                     ECU                           â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚  22 01 05              â”‚                            â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚                         â”‚ [Found DID 0x0105]         â”‚
â”‚     â”‚                         â”‚ [Requires: EXTENDED]       â”‚
â”‚     â”‚                         â”‚ [Current: DEFAULT]         â”‚
â”‚     â”‚                         â”‚ [MISMATCH!]                â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚  7F 22 7F              â”‚                            â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                            â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚                                                            â”‚
â”‚ Expected Result: âœ“ NEGATIVE RESPONSE                       â”‚
â”‚ NRC 0x7F (Service Not Supported In Active Session)        â”‚
â”‚                                                            â”‚
â”‚ Solution: Switch to EXTENDED session first (SID 0x10 0x03) â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Test Case 5: Security Required (NRC 0x33)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TEST: Read secured DID without unlock                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚ Setup:                                                     â”‚
â”‚ â€¢ Session: EXTENDED                                        â”‚
â”‚ â€¢ Security: LOCKED                                         â”‚
â”‚ â€¢ Target DID: 0x2000 (requires security Level 1)           â”‚
â”‚                                                            â”‚
â”‚ Test Steps:                                                â”‚
â”‚                                                            â”‚
â”‚   Tester                     ECU                           â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚  22 20 00              â”‚                            â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚                         â”‚ [Found DID 0x2000]         â”‚
â”‚     â”‚                         â”‚ [Requires: Security L1]    â”‚
â”‚     â”‚                         â”‚ [Current: LOCKED ðŸ”’]       â”‚
â”‚     â”‚                         â”‚ [DENIED!]                  â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚     â”‚  7F 22 33              â”‚                            â”‚
â”‚     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                            â”‚
â”‚     â”‚                         â”‚                            â”‚
â”‚                                                            â”‚
â”‚ Expected Result: âœ“ NEGATIVE RESPONSE                       â”‚
â”‚ NRC 0x33 (Security Access Denied)                          â”‚
â”‚                                                            â”‚
â”‚ Solution: Unlock security first using SID 0x27             â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Integration Patterns

### Pattern 1: Session + Read Flow

```
Tester                      ECU
  â”‚                          â”‚
  â”‚ 1. Enter EXTENDED        â”‚
  â”‚    10 03                 â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                          â”‚
  â”‚    50 03                 â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                          â”‚
  â”‚ 2. Read Sensor DIDs      â”‚
  â”‚    22 0105 010C          â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                          â”‚
  â”‚    62 0105[data]         â”‚
  â”‚       010C[data]         â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                          â”‚
  â”‚ 3. Return to DEFAULT     â”‚
  â”‚    10 01                 â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                          â”‚
  â”‚    50 01                 â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                          â”‚
```

### Pattern 2: Security + Read Flow

```
Tester                      ECU
  â”‚                          â”‚
  â”‚ 1. Extended Session      â”‚
  â”‚    10 03                 â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚    50 03                 â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                          â”‚
  â”‚ 2. Request Seed          â”‚
  â”‚    27 01                 â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚    67 01 [seed]          â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                          â”‚
  â”‚ 3. Send Key              â”‚
  â”‚    27 02 [key]           â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚    67 02   ðŸ”“            â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                          â”‚
  â”‚ 4. Read Secured DID      â”‚
  â”‚    22 2000               â”‚
  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚    62 2000 [data]        â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                          â”‚
```

---

## Debugging Guide

### Common Issues Checklist

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TROUBLESHOOTING CHECKLIST                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚ Issue: No response from ECU                                â”‚
â”‚ â˜ Is ECU powered?                                          â”‚
â”‚ â˜ Is CAN bus connected?                                    â”‚
â”‚ â˜ Correct baud rate?                                       â”‚
â”‚ â˜ Correct addressing (functional/physical)?                â”‚
â”‚                                                            â”‚
â”‚ Issue: NRC 0x13 (Incorrect Message Length)                 â”‚
â”‚ â˜ Message = 1 + (N Ã— 2) bytes?                             â”‚
â”‚ â˜ Each DID has both high and low byte?                     â”‚
â”‚ â˜ No extra bytes in message?                               â”‚
â”‚                                                            â”‚
â”‚ Issue: NRC 0x31 (Request Out Of Range)                     â”‚
â”‚ â˜ DID exists in this ECU?                                  â”‚
â”‚ â˜ Check ODX/CDD file for supported DIDs                    â”‚
â”‚ â˜ DID byte order correct (big-endian)?                     â”‚
â”‚                                                            â”‚
â”‚ Issue: NRC 0x7F (Service Not Supported In Active Session)  â”‚
â”‚ â˜ Current session correct?                                 â”‚
â”‚ â˜ Use SID 0x22 F186 to check active session                â”‚
â”‚ â˜ Switch session first (SID 0x10)                          â”‚
â”‚                                                            â”‚
â”‚ Issue: NRC 0x33 (Security Access Denied)                   â”‚
â”‚ â˜ Security unlocked?                                       â”‚
â”‚ â˜ Correct security level?                                  â”‚
â”‚ â˜ Security timeout expired?                                â”‚
â”‚ â˜ Too many failed attempts?                                â”‚
â”‚                                                            â”‚
â”‚ Issue: NRC 0x22 (Conditions Not Correct)                   â”‚
â”‚ â˜ Vehicle state correct (speed, gear, etc.)?               â”‚
â”‚ â˜ Engine running if needed?                                â”‚
â”‚ â˜ Sensor initialized?                                      â”‚
â”‚ â˜ Voltage in acceptable range?                             â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Best Practices

### DO's âœ“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  BEST PRACTICES - DO's                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚ âœ“ Verify DID support using ODX/CDD files                   â”‚
â”‚                                                            â”‚
â”‚ âœ“ Check session requirements before reading                â”‚
â”‚                                                            â”‚
â”‚ âœ“ Unlock security if needed (SID 0x27)                     â”‚
â”‚                                                            â”‚
â”‚ âœ“ Handle NRC 0x78 (Response Pending) properly              â”‚
â”‚                                                            â”‚
â”‚ âœ“ Request multiple DIDs in one message when possible       â”‚
â”‚                                                            â”‚
â”‚ âœ“ Validate response DID echo matches request               â”‚
â”‚                                                            â”‚
â”‚ âœ“ Check data length matches expected value                 â”‚
â”‚                                                            â”‚
â”‚ âœ“ Parse multi-DID responses carefully (DID+data pairs)     â”‚
â”‚                                                            â”‚
â”‚ âœ“ Use proper timeout values (P2/P2*)                       â”‚
â”‚                                                            â”‚
â”‚ âœ“ Log all requests and responses for debugging             â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DON'Ts âœ—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 BEST PRACTICES - DON'Ts                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚ âœ— Don't request too many large DIDs at once                â”‚
â”‚   (may exceed buffer â†’ NRC 0x14)                           â”‚
â”‚                                                            â”‚
â”‚ âœ— Don't assume all DIDs available in all sessions          â”‚
â”‚   (check requirements first)                               â”‚
â”‚                                                            â”‚
â”‚ âœ— Don't ignore negative responses                          â”‚
â”‚   (they contain important diagnostic info)                 â”‚
â”‚                                                            â”‚
â”‚ âœ— Don't hard-code DID lists                                â”‚
â”‚   (different ECUs support different DIDs)                  â”‚
â”‚                                                            â”‚
â”‚ âœ— Don't read secured DIDs without unlocking                â”‚
â”‚   (will always fail with NRC 0x33)                         â”‚
â”‚                                                            â”‚
â”‚ âœ— Don't forget to maintain session                         â”‚
â”‚   (use TesterPresent SID 0x3E to prevent timeout)          â”‚
â”‚                                                            â”‚
â”‚ âœ— Don't mix little-endian and big-endian                   â”‚
â”‚   (UDS uses big-endian for DIDs)                           â”‚
â”‚                                                            â”‚
â”‚ âœ— Don't retry immediately after NRC 0x22                   â”‚
â”‚   (conditions won't change instantly)                      â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**End of Practical Implementation Guide**

For theoretical concepts, see: `SID_22_READ_DATA_BY_IDENTIFIER.md`  
For service interactions, see: `SID_22_SERVICE_INTERACTIONS.md`
