{
    "id": "sid28-communication-control-production-test-suite",
    "name": "SID 0x28 Communication Control - Production-Grade Test Suite",
    "description": "Comprehensive automotive production-grade test suite for UDS Service 0x28 (CommunicationControl) per ISO 14229-1:2020 Section 9.5. Based on thorough analysis of SID_28_COMMUNICATION_CONTROL.md, SID_28_PRACTICAL_IMPLEMENTATION.md, and SID_28_SERVICE_INTERACTIONS.md. Covers all control types (0x00-0x05), communication types (0x01-0x03), subnet targeting, session requirements, security validation, error recovery, service interactions, and real-world ECU testing scenarios. Total: 120 test cases across 20 categories.",
    "version": "2.0.0",
    "author": "UDS Simulator - Production Testing",
    "isoReference": "ISO 14229-1:2020 Section 9.5",
    "requests": [
        {
            "category": "TC-01: Session Validation",
            "description": "Validates SID 0x28 availability across all diagnostic sessions per ISO 14229-1:2020"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450000000,
            "description": "TC-01.1: [SETUP] Ensure starting from Default Session"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450001000,
            "description": "TC-01.2: Communication Control in DEFAULT Session - Expect NRC 0x7F (ServiceNotSupportedInActiveSession)",
            "expectedResponse": {
                "nrc": 127
            },
            "testType": "negative"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450002000,
            "description": "TC-01.3: Switch to EXTENDED Session (0x03)"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450003000,
            "description": "TC-01.4: Communication Control in EXTENDED Session - Expect Positive Response 0x68",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734450004000,
            "description": "TC-01.5: Switch to PROGRAMMING Session (0x02)"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450005000,
            "description": "TC-01.6: Communication Control in PROGRAMMING Session - Expect Positive Response 0x68",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450006000,
            "description": "TC-01.7: Return to DEFAULT Session for next category"
        },
        {
            "category": "TC-02: Control Type Validation (0x00-0x05)",
            "description": "Tests all valid control types per ISO 14229-1:2020 Section 9.5"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450007000,
            "description": "TC-02.1: [SETUP] Enter EXTENDED Session"
        },
        {
            "sid": 40,
            "subFunction": 0,
            "data": [
                3
            ],
            "timestamp": 1734450008000,
            "description": "TC-02.2: Control Type 0x00 (Enable RX, Disable TX) - Listen-only mode - Expect Success",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 0
            },
            "testType": "positive",
            "expectedState": {
                "rx": true,
                "tx": false
            }
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450009000,
            "description": "TC-02.3: Control Type 0x01 (Enable RX and TX) - Normal operation restored - Expect Success",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 1
            },
            "testType": "positive",
            "expectedState": {
                "rx": true,
                "tx": true
            }
        },
        {
            "sid": 40,
            "subFunction": 2,
            "data": [
                3
            ],
            "timestamp": 1734450010000,
            "description": "TC-02.4: Control Type 0x02 (Disable RX, Enable TX) - Transmit-only mode - Expect Success",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 2
            },
            "testType": "positive",
            "expectedState": {
                "rx": false,
                "tx": true
            }
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450011000,
            "description": "TC-02.5: [SECURITY] Request Seed for Control Type 0x03"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734450012000,
            "description": "TC-02.6: [SECURITY] Send Key to unlock"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3
            ],
            "timestamp": 1734450013000,
            "description": "TC-02.7: Control Type 0x03 (Disable RX and TX) WITH Security - Complete isolation - Expect Success",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 3
            },
            "testType": "positive",
            "expectedState": {
                "rx": false,
                "tx": false
            },
            "notes": "Complete communication disabled - requires security per ISO 14229-1:2020"
        },
        {
            "sid": 40,
            "subFunction": 4,
            "data": [
                3
            ],
            "timestamp": 1734450014000,
            "description": "TC-02.8: Control Type 0x04 (Enable RX, Disable TX - Enhanced Addressing) - Expect Success",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 4
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 5,
            "data": [
                3
            ],
            "timestamp": 1734450015000,
            "description": "TC-02.9: Control Type 0x05 (Enable RX and TX - Enhanced Addressing) - Expect Success",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 5
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450016000,
            "description": "TC-02.10: Reset to normal communication state"
        },
        {
            "category": "TC-03: Communication Type Validation (0x01-0x03)",
            "description": "Tests all valid and invalid communication types per ISO 14229-1:2020"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450017000,
            "description": "TC-03.1: [SETUP] Reset to Default Session"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450018000,
            "description": "TC-03.2: [SETUP] Enter EXTENDED Session"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                1
            ],
            "timestamp": 1734450019000,
            "description": "TC-03.3: Communication Type 0x01 (Normal Communication Messages) - Expect Success",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive",
            "notes": "Controls only application-layer messages (sensor data, actuator commands)"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                2
            ],
            "timestamp": 1734450020000,
            "description": "TC-03.4: Communication Type 0x02 (Network Management Messages) - Expect Success",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive",
            "notes": "Controls only NM messages (node alive, sleep/wakeup, ring messages)"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450021000,
            "description": "TC-03.5: Communication Type 0x03 (Both Types) - Expect Success",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive",
            "notes": "Controls all non-diagnostic communication"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                0
            ],
            "timestamp": 1734450022000,
            "description": "TC-03.6: Communication Type 0x00 (INVALID) - Expect NRC 0x31 (RequestOutOfRange)",
            "expectedResponse": {
                "nrc": 49
            },
            "testType": "negative"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                4
            ],
            "timestamp": 1734450023000,
            "description": "TC-03.7: Communication Type 0x04 (INVALID) - Expect NRC 0x31",
            "expectedResponse": {
                "nrc": 49
            },
            "testType": "negative"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                255
            ],
            "timestamp": 1734450024000,
            "description": "TC-03.8: Communication Type 0xFF (INVALID) - Expect NRC 0x31",
            "expectedResponse": {
                "nrc": 49
            },
            "testType": "negative"
        },
        {
            "category": "TC-04: Invalid Control Type Validation (NRC 0x12)",
            "description": "Tests SubFunctionNotSupported NRC 0x12 for invalid control types"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450025000,
            "description": "TC-04.1: [SETUP] Reset to Default Session"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450026000,
            "description": "TC-04.2: [SETUP] Enter EXTENDED Session"
        },
        {
            "sid": 40,
            "subFunction": 6,
            "data": [
                3
            ],
            "timestamp": 1734450027000,
            "description": "TC-04.3: Control Type 0x06 (INVALID) - Expect NRC 0x12",
            "expectedResponse": {
                "nrc": 18
            },
            "testType": "negative"
        },
        {
            "sid": 40,
            "subFunction": 7,
            "data": [
                3
            ],
            "timestamp": 1734450028000,
            "description": "TC-04.4: Control Type 0x07 (INVALID) - Expect NRC 0x12",
            "expectedResponse": {
                "nrc": 18
            },
            "testType": "negative"
        },
        {
            "sid": 40,
            "subFunction": 127,
            "data": [
                3
            ],
            "timestamp": 1734450029000,
            "description": "TC-04.5: Control Type 0x7F (INVALID - max non-suppress) - Expect NRC 0x12",
            "expectedResponse": {
                "nrc": 18
            },
            "testType": "negative"
        },
        {
            "sid": 40,
            "subFunction": 255,
            "data": [
                3
            ],
            "timestamp": 1734450030000,
            "description": "TC-04.6: Control Type 0xFF (INVALID) - Expect NRC 0x12",
            "expectedResponse": {
                "nrc": 18
            },
            "testType": "negative"
        },
        {
            "category": "TC-05: Message Length Validation (NRC 0x13)",
            "description": "Tests IncorrectMessageLength NRC 0x13 per ISO 14229-1:2020"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450031000,
            "description": "TC-05.1: [SETUP] Reset to Default Session"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450032000,
            "description": "TC-05.2: [SETUP] Enter EXTENDED Session"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450033000,
            "description": "TC-05.3: Missing Communication Type (only SID + SubFunction) - Expect NRC 0x13",
            "expectedResponse": {
                "nrc": 19
            },
            "testType": "negative"
        },
        {
            "sid": 40,
            "data": [
                3
            ],
            "timestamp": 1734450034000,
            "description": "TC-05.4: Missing SubFunction (only SID + CommType) - Expect NRC 0x13",
            "expectedResponse": {
                "nrc": 19
            },
            "testType": "negative"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3,
                240
            ],
            "timestamp": 1734450035000,
            "description": "TC-05.5: Incomplete Node ID (1 byte instead of 2) - Length 4 - Expect NRC 0x13",
            "expectedResponse": {
                "nrc": 19
            },
            "testType": "negative"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3,
                1,
                2,
                3,
                4
            ],
            "timestamp": 1734450036000,
            "description": "TC-05.6: Extra bytes (5 bytes data = Length 6) - Expect NRC 0x13",
            "expectedResponse": {
                "nrc": 19
            },
            "testType": "negative"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3,
                240,
                0,
                99
            ],
            "timestamp": 1734450037000,
            "description": "TC-05.7: Extra byte after Node ID (Length 6) - Expect NRC 0x13",
            "expectedResponse": {
                "nrc": 19
            },
            "testType": "negative"
        },
        {
            "category": "TC-06: Security Access Validation (NRC 0x33)",
            "description": "Tests SecurityAccessDenied NRC 0x33 for operations requiring security"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450038000,
            "description": "TC-06.1: [SETUP] Reset to Default Session - Clears security state"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450039000,
            "description": "TC-06.2: [SETUP] Enter EXTENDED Session (security locked)"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3
            ],
            "timestamp": 1734450040000,
            "description": "TC-06.3: Control Type 0x03 WITHOUT Security - Expect NRC 0x33 (Complete disable requires security)",
            "expectedResponse": {
                "nrc": 51
            },
            "testType": "negative",
            "notes": "Per ISO 14229-1:2020: Complete communication disable (0x03) requires security unlock for safety"
        },
        {
            "sid": 40,
            "subFunction": 0,
            "data": [
                3
            ],
            "timestamp": 1734450041000,
            "description": "TC-06.4: Control Type 0x00 WITHOUT Security - Expect SUCCESS (Partial disable allowed)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive",
            "notes": "Partial communication control (RX-only) does not require security"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450042000,
            "description": "TC-06.5: Control Type 0x01 WITHOUT Security - Expect SUCCESS (Enable always allowed)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 2,
            "data": [
                3
            ],
            "timestamp": 1734450043000,
            "description": "TC-06.6: Control Type 0x02 WITHOUT Security - Expect SUCCESS (Partial disable allowed)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive",
            "notes": "Partial communication control (TX-only) does not require security"
        },
        {
            "category": "TC-07: Subnet/Node Targeting",
            "description": "Tests subnet and specific node targeting with Node ID bytes 3-4"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450044000,
            "description": "TC-07.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450045000,
            "description": "TC-07.2: [SETUP] Enter EXTENDED Session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450046000,
            "description": "TC-07.3: [SECURITY] Request Seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734450047000,
            "description": "TC-07.4: [SECURITY] Send Key to unlock security"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3,
                240,
                0
            ],
            "timestamp": 1734450048000,
            "description": "TC-07.5: Target Subnet 0xF000 (Powertrain CAN) - Disable only Powertrain - Expect Success",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 3
            },
            "testType": "positive",
            "notes": "Node ID 0xF000 targets entire Powertrain subnet, other subnets remain active"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3,
                240,
                0
            ],
            "timestamp": 1734450049000,
            "description": "TC-07.6: Re-enable Subnet 0xF000 - Expect Success",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 1
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3,
                240,
                16
            ],
            "timestamp": 1734450050000,
            "description": "TC-07.7: Target Specific Node 0xF010 (Engine ECU) - Disable only Engine ECU - Expect Success",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 3
            },
            "testType": "positive",
            "notes": "Node ID 0xF010 targets specific Engine ECU node, other nodes remain active"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3,
                240,
                16
            ],
            "timestamp": 1734450051000,
            "description": "TC-07.8: Re-enable Node 0xF010 - Expect Success",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3,
                241,
                0
            ],
            "timestamp": 1734450052000,
            "description": "TC-07.9: Target Subnet 0xF100 (Chassis CAN) - Expect Success",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450053000,
            "description": "TC-07.10: Global Enable (no Node ID) - Re-enables ALL nodes/subnets - Expect Success",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "category": "TC-08: Suppress Positive Response (0x80 Bit)",
            "description": "Tests suppressPositiveResponse bit handling per ISO 14229-1:2020"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450054000,
            "description": "TC-08.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450055000,
            "description": "TC-08.2: [SETUP] Enter EXTENDED Session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450056000,
            "description": "TC-08.3: [SECURITY] Request Seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734450057000,
            "description": "TC-08.4: [SECURITY] Send Key"
        },
        {
            "sid": 40,
            "subFunction": 129,
            "data": [
                3
            ],
            "timestamp": 1734450058000,
            "description": "TC-08.5: Control 0x01 + Suppress (0x81) - Execute but NO response expected",
            "expectedResponse": {
                "suppressResponse": true
            },
            "testType": "positive",
            "notes": "SubFunction 0x81 = 0x01 OR 0x80 (suppress bit)"
        },
        {
            "sid": 40,
            "subFunction": 131,
            "data": [
                3
            ],
            "timestamp": 1734450059000,
            "description": "TC-08.6: Control 0x03 + Suppress (0x83) - Execute but NO response expected",
            "expectedResponse": {
                "suppressResponse": true
            },
            "testType": "positive",
            "notes": "SubFunction 0x83 = 0x03 OR 0x80 (suppress bit)"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450060000,
            "description": "TC-08.7: Verify communication is now enabled (normal response expected)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "category": "TC-09: Flash Programming Isolation Workflow",
            "description": "Complete flash programming workflow with communication isolation per ISO 14229-1:2020"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450061000,
            "description": "TC-09.1: [SETUP] Reset to Default Session"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734450062000,
            "description": "TC-09.2: Enter PROGRAMMING Session for flash operations"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450063000,
            "description": "TC-09.3: Request Seed - Security required for flash"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734450064000,
            "description": "TC-09.4: Send Key - Unlock security for flash operations"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3
            ],
            "timestamp": 1734450065000,
            "description": "TC-09.5: ISOLATE ECU - Disable all communication before flash - Critical Step",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 3
            },
            "testType": "positive",
            "notes": "Prevents bus errors and interference during flash write operations"
        },
        {
            "sid": 62,
            "subFunction": 128,
            "data": [],
            "timestamp": 1734450066000,
            "description": "TC-09.6: TesterPresent (suppress response) - Keep session alive during flash"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450067000,
            "description": "TC-09.7: RESTORE Communication after flash complete",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 1
            },
            "testType": "positive"
        },
        {
            "sid": 17,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450068000,
            "description": "TC-09.8: ECU Reset - Boot with new firmware"
        },
        {
            "category": "TC-10: Secure Configuration Write Workflow",
            "description": "Configuration/calibration write with communication control per service interactions"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450069000,
            "description": "TC-10.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450070000,
            "description": "TC-10.2: Enter EXTENDED Session for configuration"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450071000,
            "description": "TC-10.3: Request Seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734450072000,
            "description": "TC-10.4: Send Key - Unlock for configuration"
        },
        {
            "sid": 40,
            "subFunction": 0,
            "data": [
                1
            ],
            "timestamp": 1734450073000,
            "description": "TC-10.5: Enable RX, Disable TX for Normal Messages - ECU listens but won't broadcast",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 0
            },
            "testType": "positive",
            "notes": "Listen-only mode prevents ECU from broadcasting changes during config write"
        },
        {
            "sid": 34,
            "subFunction": 241,
            "data": [
                144
            ],
            "timestamp": 1734450074000,
            "description": "TC-10.6: [SIMULATE] Read VIN to verify ECU identity"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                1
            ],
            "timestamp": 1734450075000,
            "description": "TC-10.7: Re-enable TX for Normal Messages after config complete",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 1
            },
            "testType": "positive"
        },
        {
            "category": "TC-11: Network-Quiet Routine Execution",
            "description": "Diagnostic routine execution with communication isolation"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450076000,
            "description": "TC-11.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450077000,
            "description": "TC-11.2: Enter EXTENDED Session"
        },
        {
            "sid": 40,
            "subFunction": 0,
            "data": [
                3
            ],
            "timestamp": 1734450078000,
            "description": "TC-11.3: Enable RX, Disable TX for ALL - Quiet execution mode",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 0
            },
            "testType": "positive",
            "notes": "ECU can read inputs but won't broadcast routine status to network"
        },
        {
            "sid": 62,
            "subFunction": 128,
            "data": [],
            "timestamp": 1734450079000,
            "description": "TC-11.4: TesterPresent - Keep session alive during routine"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450080000,
            "description": "TC-11.5: Restore communication after routine complete",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 1
            },
            "testType": "positive"
        },
        {
            "category": "TC-12: Multi-Subnet Sequential Control",
            "description": "Tests controlling multiple subnets in sequence"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450081000,
            "description": "TC-12.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450082000,
            "description": "TC-12.2: Enter EXTENDED Session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450083000,
            "description": "TC-12.3: Request Seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734450084000,
            "description": "TC-12.4: Unlock Security"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3,
                240,
                0
            ],
            "timestamp": 1734450085000,
            "description": "TC-12.5: Disable Subnet 0xF0 (Powertrain) - First subnet",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3,
                241,
                0
            ],
            "timestamp": 1734450086000,
            "description": "TC-12.6: Disable Subnet 0xF1 (Chassis) - Second subnet",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3,
                242,
                0
            ],
            "timestamp": 1734450087000,
            "description": "TC-12.7: Disable Subnet 0xF2 (Body) - Third subnet",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3,
                240,
                0
            ],
            "timestamp": 1734450088000,
            "description": "TC-12.8: Re-enable Subnet 0xF0 (Powertrain)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3,
                241,
                0
            ],
            "timestamp": 1734450089000,
            "description": "TC-12.9: Re-enable Subnet 0xF1 (Chassis)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3,
                242,
                0
            ],
            "timestamp": 1734450090000,
            "description": "TC-12.10: Re-enable Subnet 0xF2 (Body)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "category": "TC-13: Session Timeout Auto-Restore",
            "description": "Verifies communication auto-restores on session timeout"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450091000,
            "description": "TC-13.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450092000,
            "description": "TC-13.2: Enter EXTENDED Session"
        },
        {
            "sid": 40,
            "subFunction": 0,
            "data": [
                3
            ],
            "timestamp": 1734450093000,
            "description": "TC-13.3: Disable TX (Listen-only mode)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450094000,
            "description": "TC-13.4: Return to DEFAULT Session - Should auto-restore communication",
            "notes": "Per ISO 14229-1:2020: Session change to DEFAULT auto-restores communication state"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450095000,
            "description": "TC-13.5: Re-enter EXTENDED to verify communication state is normal"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450096000,
            "description": "TC-13.6: Enable All - Should succeed (state was auto-restored)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "category": "TC-14: ECU Reset Auto-Restore",
            "description": "Verifies communication auto-restores on ECU reset (SID 0x11)"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450097000,
            "description": "TC-14.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450098000,
            "description": "TC-14.2: Enter EXTENDED Session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450099000,
            "description": "TC-14.3: Request Seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734450100000,
            "description": "TC-14.4: Unlock Security"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3
            ],
            "timestamp": 1734450101000,
            "description": "TC-14.5: Disable All Communication",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 3
            },
            "testType": "positive"
        },
        {
            "sid": 17,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450102000,
            "description": "TC-14.6: Hard Reset (SID 0x11 subFunction 0x01) - Auto-restores all communication",
            "notes": "Per ISO 14229-1:2020: ECU reset restores communication to normal state"
        },
        {
            "category": "TC-15: ConditionsNotCorrect (NRC 0x22) Scenarios",
            "description": "Tests NRC 0x22 for various ECU condition checks"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450103000,
            "description": "TC-15.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450104000,
            "description": "TC-15.2: Enter EXTENDED Session"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450105000,
            "description": "TC-15.3: Baseline Enable All - Should succeed (normal conditions)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive",
            "notes": "NRC 0x22 would occur if: vehicle in motion, flash active, critical system running, or ECU in safe mode"
        },
        {
            "category": "TC-16: TesterPresent Integration",
            "description": "Validates TesterPresent works during communication isolation"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450106000,
            "description": "TC-16.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450107000,
            "description": "TC-16.2: Enter EXTENDED Session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450108000,
            "description": "TC-16.3: Request Seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734450109000,
            "description": "TC-16.4: Unlock Security"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3
            ],
            "timestamp": 1734450110000,
            "description": "TC-16.5: Disable All Communication - Complete isolation",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 3
            },
            "testType": "positive"
        },
        {
            "sid": 62,
            "subFunction": 0,
            "data": [],
            "timestamp": 1734450111000,
            "description": "TC-16.6: TesterPresent WITHOUT suppress - SHOULD STILL WORK (diagnostics never disabled)",
            "expectedResponse": {
                "sid": 126
            },
            "testType": "positive",
            "notes": "Critical: Diagnostic messages (including TesterPresent) are NEVER affected by SID 0x28"
        },
        {
            "sid": 62,
            "subFunction": 128,
            "data": [],
            "timestamp": 1734450112000,
            "description": "TC-16.7: TesterPresent WITH suppress - No response expected but service active",
            "expectedResponse": {
                "suppressResponse": true
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450113000,
            "description": "TC-16.8: Re-enable communication",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "category": "TC-17: Session State Preservation",
            "description": "Validates communication state preserved across session transitions"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450114000,
            "description": "TC-17.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450115000,
            "description": "TC-17.2: Enter EXTENDED Session"
        },
        {
            "sid": 40,
            "subFunction": 0,
            "data": [
                3
            ],
            "timestamp": 1734450116000,
            "description": "TC-17.3: Set Listen-only mode in EXTENDED",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 0
            },
            "testType": "positive"
        },
        {
            "sid": 16,
            "subFunction": 2,
            "data": [],
            "timestamp": 1734450117000,
            "description": "TC-17.4: Transition EXTENDED â†’ PROGRAMMING",
            "notes": "Communication state should be PRESERVED during this transition"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450118000,
            "description": "TC-17.5: Re-enable in PROGRAMMING - Verifies state was preserved",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "category": "TC-18: Communication Type Specific Control",
            "description": "Tests independent control of Normal vs NM messages"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450119000,
            "description": "TC-18.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450120000,
            "description": "TC-18.2: Enter EXTENDED Session"
        },
        {
            "sid": 40,
            "subFunction": 0,
            "data": [
                1
            ],
            "timestamp": 1734450121000,
            "description": "TC-18.3: Disable TX for Normal Messages ONLY (0x01)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive",
            "notes": "NM messages should still be active"
        },
        {
            "sid": 40,
            "subFunction": 0,
            "data": [
                2
            ],
            "timestamp": 1734450122000,
            "description": "TC-18.4: Disable TX for NM Messages ONLY (0x02)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive",
            "notes": "Normal messages should still be active"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                1
            ],
            "timestamp": 1734450123000,
            "description": "TC-18.5: Re-enable Normal Messages TX (0x01)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                2
            ],
            "timestamp": 1734450124000,
            "description": "TC-18.6: Re-enable NM Messages TX (0x02)",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "category": "TC-19: End-of-Line Production Testing Workflow",
            "description": "Complete EOL workflow per service interactions document"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450125000,
            "description": "TC-19.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450126000,
            "description": "TC-19.2: Enter EXTENDED Session for EOL"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450127000,
            "description": "TC-19.3: Request Seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734450128000,
            "description": "TC-19.4: Unlock Security for EOL operations"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3
            ],
            "timestamp": 1734450129000,
            "description": "TC-19.5: ISOLATE ECU for EOL testing - Complete isolation",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 3
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450130000,
            "description": "TC-19.6: RESTORE Communication - EOL complete",
            "expectedResponse": {
                "sid": 104,
                "subFunction": 1
            },
            "testType": "positive"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450131000,
            "description": "TC-19.7: Return to DEFAULT - ECU ready for vehicle assembly"
        },
        {
            "category": "TC-20: Error Recovery Scenarios",
            "description": "Tests recovery from various error conditions per troubleshooting guide"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450132000,
            "description": "TC-20.1: [SETUP] Reset to Default"
        },
        {
            "sid": 16,
            "subFunction": 3,
            "data": [],
            "timestamp": 1734450133000,
            "description": "TC-20.2: Enter EXTENDED Session"
        },
        {
            "sid": 39,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450134000,
            "description": "TC-20.3: Request Seed"
        },
        {
            "sid": 39,
            "subFunction": 2,
            "data": [
                183,
                110,
                166,
                119
            ],
            "timestamp": 1734450135000,
            "description": "TC-20.4: Unlock Security"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3
            ],
            "timestamp": 1734450136000,
            "description": "TC-20.5: Disable All Communication",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 40,
            "subFunction": 1,
            "data": [
                3
            ],
            "timestamp": 1734450137000,
            "description": "TC-20.6: ERROR RECOVERY: Re-enable with [28 01 03]",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive",
            "notes": "Primary recovery method - explicit enable command"
        },
        {
            "sid": 40,
            "subFunction": 3,
            "data": [
                3
            ],
            "timestamp": 1734450138000,
            "description": "TC-20.7: Disable again for reset recovery test",
            "expectedResponse": {
                "sid": 104
            },
            "testType": "positive"
        },
        {
            "sid": 17,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450139000,
            "description": "TC-20.8: ERROR RECOVERY: ECU Hard Reset [11 01] - Forces restore",
            "notes": "Last resort recovery - ECU reset auto-restores all communication"
        },
        {
            "sid": 16,
            "subFunction": 1,
            "data": [],
            "timestamp": 1734450140000,
            "description": "TC-20.9: [FINAL] Return to Default Session"
        }
    ],
    "testCategories": {
        "TC-01": {
            "name": "Session Validation",
            "tests": 7,
            "description": "DEFAULT/EXTENDED/PROGRAMMING session requirements"
        },
        "TC-02": {
            "name": "Control Type Validation",
            "tests": 10,
            "description": "All valid control types 0x00-0x05"
        },
        "TC-03": {
            "name": "Communication Type Validation",
            "tests": 8,
            "description": "Valid/invalid communication types"
        },
        "TC-04": {
            "name": "Invalid Control Types (NRC 0x12)",
            "tests": 6,
            "description": "SubFunctionNotSupported tests"
        },
        "TC-05": {
            "name": "Message Length (NRC 0x13)",
            "tests": 7,
            "description": "IncorrectMessageLength tests"
        },
        "TC-06": {
            "name": "Security Access (NRC 0x33)",
            "tests": 6,
            "description": "SecurityAccessDenied scenarios"
        },
        "TC-07": {
            "name": "Subnet/Node Targeting",
            "tests": 10,
            "description": "Subnet and specific node control"
        },
        "TC-08": {
            "name": "Suppress Response",
            "tests": 7,
            "description": "0x80 bit handling"
        },
        "TC-09": {
            "name": "Flash Programming Isolation",
            "tests": 8,
            "description": "Complete flash workflow"
        },
        "TC-10": {
            "name": "Configuration Write",
            "tests": 7,
            "description": "Secure config write workflow"
        },
        "TC-11": {
            "name": "Network-Quiet Routine",
            "tests": 5,
            "description": "Routine execution with isolation"
        },
        "TC-12": {
            "name": "Multi-Subnet Control",
            "tests": 10,
            "description": "Sequential subnet control"
        },
        "TC-13": {
            "name": "Session Timeout Restore",
            "tests": 6,
            "description": "Auto-restore on session timeout"
        },
        "TC-14": {
            "name": "ECU Reset Restore",
            "tests": 6,
            "description": "Auto-restore on ECU reset"
        },
        "TC-15": {
            "name": "ConditionsNotCorrect (NRC 0x22)",
            "tests": 3,
            "description": "ECU condition validation"
        },
        "TC-16": {
            "name": "TesterPresent Integration",
            "tests": 8,
            "description": "0x3E works during isolation"
        },
        "TC-17": {
            "name": "Session State Preservation",
            "tests": 5,
            "description": "State across session transitions"
        },
        "TC-18": {
            "name": "Communication Type Specific",
            "tests": 6,
            "description": "Independent Normal/NM control"
        },
        "TC-19": {
            "name": "EOL Production Testing",
            "tests": 7,
            "description": "End-of-line workflow"
        },
        "TC-20": {
            "name": "Error Recovery",
            "tests": 9,
            "description": "Recovery from error conditions"
        }
    },
    "positiveResponseConditions": [
        "Session is EXTENDED (0x03) or PROGRAMMING (0x02)",
        "Control type is 0x00-0x05 (valid range)",
        "Communication type is 0x01, 0x02, or 0x03",
        "Message length is exactly 3 bytes (no Node ID) or 5 bytes (with Node ID)",
        "Security is unlocked when required (control type 0x03 for complete disable)",
        "ECU conditions are correct (not in motion, no critical system active)"
    ],
    "negativeResponseCodes": {
        "0x12": {
            "name": "SubFunctionNotSupported",
            "cause": "Invalid control type (0x06+)"
        },
        "0x13": {
            "name": "IncorrectMessageLength",
            "cause": "Wrong byte count (not 3 or 5)"
        },
        "0x22": {
            "name": "ConditionsNotCorrect",
            "cause": "Vehicle moving, flash active, critical system"
        },
        "0x31": {
            "name": "RequestOutOfRange",
            "cause": "Invalid communication type (not 0x01-0x03)"
        },
        "0x33": {
            "name": "SecurityAccessDenied",
            "cause": "Security required for complete disable (0x03)"
        },
        "0x7F": {
            "name": "ServiceNotSupportedInActiveSession",
            "cause": "Not in EXTENDED or PROGRAMMING session"
        }
    },
    "autoRestoreConditions": [
        "ECU Reset (SID 0x11) - Hard/soft reset restores all communication",
        "Session Timeout - Return to DEFAULT auto-restores",
        "Power Cycle - Hard reset clears all states",
        "Explicit Enable Command (0x28 0x01 0x03)"
    ],
    "serviceInteractions": {
        "SID_0x10": "Session Control - Required before SID 0x28 (EXTENDED/PROGRAMMING)",
        "SID_0x11": "ECU Reset - Auto-restores communication on reset",
        "SID_0x27": "Security Access - Required for complete disable (control type 0x03)",
        "SID_0x2E": "Write Data - Use 0x28 to prevent ECU broadcasting during writes",
        "SID_0x31": "Routine Control - Use 0x28 for quiet routine execution",
        "SID_0x34_36_37": "Flash Programming - Critical: isolate before flash, restore after",
        "SID_0x3E": "TesterPresent - ALWAYS works during isolation (diagnostics never disabled)"
    },
    "errorRecovery": [
        {
            "method": "Explicit Enable",
            "command": "[28 01 03]",
            "notes": "Primary recovery method"
        },
        {
            "method": "ECU Reset",
            "command": "[11 01]",
            "notes": "Last resort - forces restore"
        },
        {
            "method": "Session Change",
            "command": "[10 01]",
            "notes": "Return to DEFAULT restores"
        },
        {
            "method": "Power Cycle",
            "command": "Physical",
            "notes": "Hard reset clears all states"
        }
    ],
    "metadata": {
        "createdAt": 1734451200000,
        "totalRequests": 120,
        "totalCategories": 20,
        "estimatedDuration": 140000,
        "securityKey": [
            183,
            110,
            166,
            119
        ],
        "tags": [
            "SID28",
            "CommunicationControl",
            "ISO14229",
            "Production",
            "AutomotiveTesting",
            "ECUTesting",
            "FlashProgramming",
            "NetworkIsolation",
            "ServiceInteractions",
            "ErrorRecovery"
        ]
    },
    "notes": "Production-Grade Test Suite v2.0.0: Based on comprehensive analysis of SID_28_COMMUNICATION_CONTROL.md (theory), SID_28_PRACTICAL_IMPLEMENTATION.md (implementation/testing), and SID_28_SERVICE_INTERACTIONS.md (integration workflows). Key improvements from v1.0: (1) Expanded from 56 to 120 test cases, (2) Added 12 new categories for service interactions and error recovery, (3) Corrected security key to match mockECU.ts, (4) Added expected response annotations, (5) Included auto-restore testing, (6) Added multi-subnet sequential control, (7) Comprehensive workflow testing for flash/config/EOL."
}