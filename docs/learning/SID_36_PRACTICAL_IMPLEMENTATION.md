# SID 0x36: Transfer Data - Practical Implementation Guide

**Document Version**: 2.0  
**Last Updated**: October 12, 2025  
**Format**: Visual Diagrams (No Code)  
**ISO Reference**: ISO 14229-1:2020 Section 10.5

---

## ğŸ“‹ Table of Contents

1. [Request Processing Flowchart](#request-processing-flowchart)
2. [State Machine Diagrams](#state-machine-diagrams)
3. [NRC Decision Trees](#nrc-decision-trees)
4. [Block Sequence Counter Management](#block-sequence-counter-management)
5. [Testing Scenarios](#testing-scenarios)
6. [Integration Patterns](#integration-patterns)
7. [Debugging Flowcharts](#debugging-flowcharts)
8. [Best Practices Checklist](#best-practices-checklist)

---

## Request Processing Flowchart

### Main Request Handler

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Receive Transfer Data  â”‚
                    â”‚  Request (0x36)         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Extract Message Fields:â”‚
                    â”‚  â€¢ SID (Byte 0)         â”‚
                    â”‚  â€¢ BSC (Byte 1)         â”‚
                    â”‚  â€¢ Data (Byte 2-N)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”€â”¤  Session =              â”‚
              â”‚     â”‚  PROGRAMMING (0x02)?    â”‚
              â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                 â”‚
             NO                YES
              â”‚                 â”‚
              â”‚                 â–¼
              â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”Œâ”€â”€â”€â”¤  Security =             â”‚
              â”‚ â”‚   â”‚  UNLOCKED?              â”‚
              â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚               â”‚
              â”‚NO              YES
              â”‚ â”‚               â”‚
              â”‚ â”‚               â–¼
              â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”Œâ”€â”¤  Transfer Context       â”‚
              â”‚ â”‚ â”‚ â”‚  Active? (from 0x34)    â”‚
              â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚             â”‚
              â”‚ â”‚NO            YES
              â”‚ â”‚ â”‚             â”‚
              â”‚ â”‚ â”‚             â–¼
              â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚  Validate BSC =         â”‚
              â”‚ â”‚ â”‚ â”‚  Expected BSC?          â”‚
              â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚             â”‚
              â”‚ â”‚ â”‚        â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚       YES       NO
              â”‚ â”‚ â”‚        â”‚         â”‚
              â”‚ â”‚ â”‚        â–¼         â–¼
              â”‚ â”‚ â”‚    â”Œâ”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚    â”‚NEXTâ”‚   â”‚NRC 0x24â”‚
              â”‚ â”‚ â”‚    â””â”€â”€â”¬â”€â”˜   â”‚Sequenceâ”‚
              â”‚ â”‚ â”‚       â”‚     â”‚Error   â”‚
              â”‚ â”‚ â”‚       â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚       â–¼
              â”‚ â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”Œâ”€â”¤  Message Length =       â”‚
              â”‚ â”‚ â”‚ â”‚ â”‚  Expected Block Size?   â”‚
              â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚ â”‚         â”‚
              â”‚ â”‚ â”‚ â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚   YES       NO
              â”‚ â”‚ â”‚ â”‚    â”‚         â”‚
              â”‚ â”‚ â”‚ â”‚    â–¼         â–¼
              â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚ â”‚NEXTâ”‚   â”‚NRC 0x13â”‚
              â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”¬â”€â”˜   â”‚Length  â”‚
              â”‚ â”‚ â”‚ â”‚    â”‚     â”‚Error   â”‚
              â”‚ â”‚ â”‚ â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚ â”‚    â–¼
              â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚ â”‚  Check Voltage Range    â”‚
              â”‚ â”‚ â”‚ â”‚ â”‚  (11V - 15.5V)          â”‚
              â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚ â”‚         â”‚
              â”‚ â”‚ â”‚ â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚   OK      TOO LOW    TOO HIGH
              â”‚ â”‚ â”‚ â”‚    â”‚         â”‚         â”‚
              â”‚ â”‚ â”‚ â”‚    â–¼         â–¼         â–¼
              â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚ â”‚NEXTâ”‚   â”‚0x93â”‚   â”‚0x92â”‚
              â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”¬â”€â”˜   â””â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚ â”‚    â”‚
              â”‚ â”‚ â”‚ â”‚    â–¼
              â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚ â”‚  Check Memory Address   â”‚
              â”‚ â”‚ â”‚ â”‚ â”‚  Range Valid?           â”‚
              â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚ â”‚         â”‚
              â”‚ â”‚ â”‚ â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚   YES       NO
              â”‚ â”‚ â”‚ â”‚    â”‚         â”‚
              â”‚ â”‚ â”‚ â”‚    â–¼         â–¼
              â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚ â”‚NEXTâ”‚   â”‚NRC 0x31â”‚
              â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”¬â”€â”˜   â”‚Out of  â”‚
              â”‚ â”‚ â”‚ â”‚    â”‚     â”‚Range   â”‚
              â”‚ â”‚ â”‚ â”‚    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚ â”‚    â–¼
              â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚ â”‚  Write Data to Memory   â”‚
              â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚ â”‚             â”‚
              â”‚ â”‚ â”‚ â”‚        â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚     SUCCESS    FAIL
              â”‚ â”‚ â”‚ â”‚        â”‚         â”‚
              â”‚ â”‚ â”‚ â”‚        â–¼         â–¼
              â”‚ â”‚ â”‚ â”‚    â”Œâ”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚    â”‚NEXTâ”‚   â”‚NRC 0x72â”‚
              â”‚ â”‚ â”‚ â”‚    â””â”€â”€â”¬â”€â”˜   â”‚Program â”‚
              â”‚ â”‚ â”‚ â”‚       â”‚     â”‚Failure â”‚
              â”‚ â”‚ â”‚ â”‚       â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚ â”‚       â–¼
              â”‚ â”‚ â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚   â”‚  Increment Expected BSC â”‚
              â”‚ â”‚ â”‚ â”‚   â”‚  (Wrap at 0xFF â†’ 0x01)  â”‚
              â”‚ â”‚ â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚ â”‚               â”‚
              â”‚ â”‚ â”‚ â”‚               â–¼
              â”‚ â”‚ â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚   â”‚  Send Positive Response â”‚
              â”‚ â”‚ â”‚ â”‚   â”‚  0x76 + BSC             â”‚
              â”‚ â”‚ â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚ â”‚               â”‚
              â”‚ â”‚ â”‚ â”‚               â–¼
              â”‚ â”‚ â”‚ â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â”‚ â”‚           â”‚  DONE  â”‚
              â”‚ â”‚ â”‚ â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ â”‚ â”‚ â”‚
              â”‚ â”‚ â”‚ â””â”€â”€â–¶ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ â”‚ â””â”€â”€â”€â”€â–¶ â”‚  NRC 0x22      â”‚
              â”‚ â””â”€â”€â”€â”€â”€â”€â–¶ â”‚  Conditions    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚  Not Correct   â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## State Machine Diagrams

### Transfer State Machine

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TRANSFER DATA STATE MACHINE                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  IDLE            â”‚
           â”‚  (No Transfer)   â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ SID 0x34 Request Download
                    â”‚ (or SID 0x35 Request Upload)
                    â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  TRANSFER_READY  â”‚
           â”‚  (Awaiting Block)â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ SID 0x36 (BSC = 1)
                    â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  TRANSFERRING    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  (Active)        â”‚           â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
                    â”‚                     â”‚
              â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”               â”‚
              â”‚           â”‚               â”‚
        More Blocks    All Blocks         â”‚
        Remaining      Received           â”‚
              â”‚           â”‚               â”‚
              â”‚           â”‚               â”‚
      SID 0x36 Next   SID 0x37            â”‚
      Block (BSC++)   Transfer Exit       â”‚
              â”‚           â”‚               â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
                    â”‚                     â”‚
                    â”‚                     â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚               â”‚                     â”‚         â”‚
    â”‚ Error         â”‚ Suspend             â”‚ Success â”‚
    â”‚ (NRC 0x72)    â”‚ (NRC 0x71)          â”‚         â”‚
    â–¼               â–¼                     â–¼         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ FAILED â”‚    â”‚  SUSPENDED   â”‚    â”‚  COMPLETED   â”‚ â”‚
â”‚        â”‚    â”‚              â”‚    â”‚              â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                     â”‚                              â”‚
                     â”‚ Condition Cleared            â”‚
                     â”‚ Retry SID 0x36               â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  State Transitions:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  IDLE â†’ TRANSFER_READY:     SID 0x34/0x35 success
  TRANSFER_READY â†’ TRANSFERRING:  First SID 0x36 (BSC=1)
  TRANSFERRING â†’ TRANSFERRING:    Subsequent SID 0x36 (BSC++)
  TRANSFERRING â†’ COMPLETED:   SID 0x37 (all blocks received)
  TRANSFERRING â†’ SUSPENDED:   NRC 0x71 (voltage/temp issue)
  TRANSFERRING â†’ FAILED:      NRC 0x72 (programming failure)
  SUSPENDED â†’ TRANSFERRING:   Retry same block after recovery
  COMPLETED â†’ IDLE:           New session or reset
  FAILED â†’ IDLE:              ECU reset required
```

### Session State Impact

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           SESSION STATE vs TRANSFER AVAILABILITY                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  DEFAULT SESSION    â”‚
  â”‚  (0x01)             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ SID 0x36 Request
             â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ NRC 0x7F â”‚  â† Service Not Supported
       â”‚ or 0x22  â”‚     in Current Session
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  EXTENDED SESSION   â”‚
  â”‚  (0x03)             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ SID 0x34 â†’ SID 0x36
             â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ SUCCESS  â”‚  âœ“ Transfer Data Allowed
       â”‚  0x76    â”‚    (with security unlock)
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ PROGRAMMING SESSION â”‚
  â”‚  (0x02)             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ SID 0x34 â†’ SID 0x36
             â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚ SUCCESS  â”‚  âœ“ Transfer Data Allowed
       â”‚  0x76    â”‚    (with security unlock)
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## NRC Decision Trees

### Complete NRC Decision Tree

```
                      Transfer Data Request (0x36)
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”Œâ”€â”€â”€â”€â”¤ Session Check         â”‚
               â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                â”‚
          NOT PROG/EXT         PROG/EXT
               â”‚                â”‚
               â–¼                â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚NRC 0x7Fâ”‚ â”Œâ”€â”€â”¤ Security Check        â”‚
          â”‚or 0x22 â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚              â”‚
                    LOCKED         UNLOCKED
                     â”‚              â”‚
                     â–¼              â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚NRC 0x33â”‚â”Œâ”€â”¤ Transfer Context?     â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚            â”‚
                       NO CONTEXT    CONTEXT EXISTS
                          â”‚            â”‚
                          â–¼            â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚NRC 0x22â”‚â”Œâ”¤ BSC Sequential?       â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚â”‚           â”‚
                              NO          YES
                               â”‚â”‚           â”‚
                               â–¼â–¼           â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚NRC 0x24â”‚â”Œâ”¤ Message Length OK?    â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚â”‚           â”‚
                                   NO          YES
                                    â”‚â”‚           â”‚
                                    â–¼â–¼           â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚NRC 0x13â”‚â”Œâ”¤ Voltage in Range?     â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚â”‚           â”‚
                                      TOO LOW      â”Œâ”€â”€â”´â”€â”€â”€â”
                                      TOO HIGH    OK   TOO HIGH
                                         â”‚â”‚        â”‚      â”‚
                                         â–¼â–¼        â”‚      â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚NRC 0x93â”‚    â”‚  â”‚NRC 0x92â”‚
                                    â”‚or 0x92 â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                                                  â–¼
                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                       â”Œâ”€â”¤ Address in Range?     â”‚
                                       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚            â”‚
                                      NO          YES
                                       â”‚            â”‚
                                       â–¼            â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚NRC 0x31â”‚ â”‚ Write to Memory       â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                                                â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
                                              FAIL      SUCCESS
                                                â”‚          â”‚
                                                â–¼          â–¼
                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
                                           â”‚NRC 0x72â”‚ â”‚ 0x76   â”‚
                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ + BSC  â”‚
                                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Quick NRC Reference Decision

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           WHICH NRC TO RETURN? QUICK GUIDE               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Session not programming/extended?  â†’  NRC 0x7F or 0x22 â”‚
â”‚  Security locked?                   â†’  NRC 0x33         â”‚
â”‚  No active transfer context?        â†’  NRC 0x22         â”‚
â”‚  BSC out of sequence?               â†’  NRC 0x24         â”‚
â”‚  Message length wrong?              â†’  NRC 0x13         â”‚
â”‚  Voltage too low?                   â†’  NRC 0x93         â”‚
â”‚  Voltage too high?                  â†’  NRC 0x92         â”‚
â”‚  Memory address out of range?       â†’  NRC 0x31         â”‚
â”‚  Flash write failed?                â†’  NRC 0x72         â”‚
â”‚  Temporary resource issue?          â†’  NRC 0x71         â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Block Sequence Counter Management

### BSC Incrementing Algorithm

```
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Initialize:            â”‚
         â”‚  Expected_BSC = 0x01    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”Œâ”€â”€â”€â–¶â”‚  Receive Request        â”‚
    â”‚    â”‚  Extract Received_BSC   â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                â”‚
    â”‚                â–¼
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â”Œâ”€â”€â”¤  Received_BSC ==        â”‚
    â”‚ â”‚  â”‚  Expected_BSC?          â”‚
    â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ â”‚              â”‚
    â”‚ â”‚         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚ â”‚        YES       NO
    â”‚ â”‚         â”‚         â”‚
    â”‚ â”‚         â–¼         â–¼
    â”‚ â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â”‚    â”‚PROCESS â”‚ â”‚NRC 0x24  â”‚
    â”‚ â”‚    â”‚DATA    â”‚ â”‚RETURN    â”‚
    â”‚ â”‚    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ â”‚        â”‚
    â”‚ â”‚        â–¼
    â”‚ â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â”‚    â”‚  Increment Expected_BSC â”‚
    â”‚ â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ â”‚                â”‚
    â”‚ â”‚                â–¼
    â”‚ â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â”‚ â”Œâ”€â”€â”¤  Expected_BSC == 0x00?  â”‚
    â”‚ â”‚ â”‚  â”‚  (after increment)      â”‚
    â”‚ â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ â”‚ â”‚              â”‚
    â”‚ â”‚ â”‚         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚ â”‚ â”‚        YES       NO
    â”‚ â”‚ â”‚         â”‚         â”‚
    â”‚ â”‚ â”‚         â–¼         â–¼
    â”‚ â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â”‚ â”‚  â”‚Set to 1  â”‚ â”‚Keep Valueâ”‚
    â”‚ â”‚ â”‚  â”‚BSC=0x01  â”‚ â”‚          â”‚
    â”‚ â”‚ â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚ â”‚ â”‚       â”‚             â”‚
    â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ â”‚                â”‚
    â”‚ â”‚                â–¼
    â”‚ â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â”‚    â”‚  Send Response 0x76+BSC â”‚
    â”‚ â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ â”‚                â”‚
    â”‚ â”‚                â–¼
    â”‚ â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ â””â”€â”€â”€â–¶â”‚  More blocks expected?  â”‚
    â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                  â”‚
    â”‚             â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚            YES       NO
    â”‚             â”‚         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ DONE   â”‚
                        â”‚ Await  â”‚
                        â”‚ 0x37   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜


  Wrap-Around Example:
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Expected_BSC = 0xFE  â†’  Process  â†’  Increment  â†’  Expected_BSC = 0xFF
  Expected_BSC = 0xFF  â†’  Process  â†’  Increment  â†’  Expected_BSC = 0x00 â†’ SET TO 0x01
  Expected_BSC = 0x01  â†’  Process  â†’  Increment  â†’  Expected_BSC = 0x02
```

### BSC Validation Pseudocode (Visual)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BSC VALIDATION LOGIC                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  INPUT:  Received_BSC (from request byte 1)                 â”‚
â”‚  STATE:  Expected_BSC (maintained by ECU)                   â”‚
â”‚                                                             â”‚
â”‚  STEP 1: Compare                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  IF Received_BSC == Expected_BSC THEN       â”‚            â”‚
â”‚  â”‚     GOTO STEP 2                             â”‚            â”‚
â”‚  â”‚  ELSE                                       â”‚            â”‚
â”‚  â”‚     RETURN NRC 0x24                         â”‚            â”‚
â”‚  â”‚  END IF                                     â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                             â”‚
â”‚  STEP 2: Process Data                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  Process transfer data block                â”‚            â”‚
â”‚  â”‚  Write to memory                            â”‚            â”‚
â”‚  â”‚  IF write_success THEN                      â”‚            â”‚
â”‚  â”‚     GOTO STEP 3                             â”‚            â”‚
â”‚  â”‚  ELSE                                       â”‚            â”‚
â”‚  â”‚     RETURN NRC 0x72                         â”‚            â”‚
â”‚  â”‚  END IF                                     â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                             â”‚
â”‚  STEP 3: Increment BSC                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  Expected_BSC = Expected_BSC + 1            â”‚            â”‚
â”‚  â”‚  IF Expected_BSC > 0xFF THEN                â”‚            â”‚
â”‚  â”‚     Expected_BSC = 0x01  (wrap-around)      â”‚            â”‚
â”‚  â”‚  END IF                                     â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                             â”‚
â”‚  STEP 4: Send Response                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  RETURN 0x76 + Received_BSC                 â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Testing Scenarios

### Test Scenario 1: Normal Sequential Transfer

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST: Normal Sequential Transfer (4 blocks)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Setup:                                                     â”‚
â”‚    â€¢ Session: PROGRAMMING (0x02)                            â”‚
â”‚    â€¢ Security: UNLOCKED                                     â”‚
â”‚    â€¢ SID 0x34 completed: 4096 bytes, 1024 bytes/block       â”‚
â”‚                                                             â”‚
â”‚  Test Steps:                                                â”‚
â”‚                                                             â”‚
â”‚    Step 1:  Send 36 01 [1024 bytes]                         â”‚
â”‚            Expected: 76 01  âœ“                               â”‚
â”‚                                                             â”‚
â”‚    Step 2:  Send 36 02 [1024 bytes]                         â”‚
â”‚            Expected: 76 02  âœ“                               â”‚
â”‚                                                             â”‚
â”‚    Step 3:  Send 36 03 [1024 bytes]                         â”‚
â”‚            Expected: 76 03  âœ“                               â”‚
â”‚                                                             â”‚
â”‚    Step 4:  Send 36 04 [1024 bytes]                         â”‚
â”‚            Expected: 76 04  âœ“                               â”‚
â”‚                                                             â”‚
â”‚    Step 5:  Send 37 (Request Transfer Exit)                 â”‚
â”‚            Expected: 77  âœ“                                  â”‚
â”‚                                                             â”‚
â”‚  Pass Criteria:                                             â”‚
â”‚    âœ“ All responses are positive (0x76)                      â”‚
â”‚    âœ“ BSC echoed correctly in each response                  â”‚
â”‚    âœ“ Transfer exit successful                               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Test Scenario 2: BSC Sequence Error

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST: Block Sequence Error Detection                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Setup:                                                     â”‚
â”‚    â€¢ Session: PROGRAMMING (0x02)                            â”‚
â”‚    â€¢ Security: UNLOCKED                                     â”‚
â”‚    â€¢ SID 0x34 completed                                     â”‚
â”‚                                                             â”‚
â”‚  Test Steps:                                                â”‚
â”‚                                                             â”‚
â”‚    Step 1:  Send 36 01 [1024 bytes]                         â”‚
â”‚            Expected: 76 01  âœ“                               â”‚
â”‚                                                             â”‚
â”‚    Step 2:  Send 36 01 [1024 bytes]  â† REPEAT BSC!          â”‚
â”‚            Expected: 7F 36 24  âœ“ (Sequence Error)           â”‚
â”‚                                                             â”‚
â”‚    Step 3:  Restart with SID 0x34                           â”‚
â”‚            Expected: 74 [params]  âœ“                         â”‚
â”‚                                                             â”‚
â”‚    Step 4:  Send 36 01 [1024 bytes]                         â”‚
â”‚            Expected: 76 01  âœ“                               â”‚
â”‚                                                             â”‚
â”‚    Step 5:  Send 36 03 [1024 bytes]  â† SKIP BSC 02!         â”‚
â”‚            Expected: 7F 36 24  âœ“ (Sequence Error)           â”‚
â”‚                                                             â”‚
â”‚  Pass Criteria:                                             â”‚
â”‚    âœ“ NRC 0x24 returned for duplicate BSC                    â”‚
â”‚    âœ“ NRC 0x24 returned for skipped BSC                      â”‚
â”‚    âœ“ Transfer can restart after error                       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Test Scenario 3: BSC Wrap-Around

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST: Block Sequence Counter Wrap-Around                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Setup:                                                     â”‚
â”‚    â€¢ Large transfer requiring > 255 blocks                  â”‚
â”‚    â€¢ Block size: 256 bytes                                  â”‚
â”‚    â€¢ Total size: 65792 bytes (257 blocks)                   â”‚
â”‚                                                             â”‚
â”‚  Test Steps:                                                â”‚
â”‚                                                             â”‚
â”‚    Step 1-254:  Send blocks BSC 0x01 to 0xFE                â”‚
â”‚                Expected: 76 01 ... 76 FE  âœ“                 â”‚
â”‚                                                             â”‚
â”‚    Step 255:    Send 36 FF [256 bytes]                      â”‚
â”‚                Expected: 76 FF  âœ“                           â”‚
â”‚                                                             â”‚
â”‚    Step 256:    Send 36 01 [256 bytes]  â† WRAP TO 0x01      â”‚
â”‚                Expected: 76 01  âœ“                           â”‚
â”‚                                                             â”‚
â”‚    Step 257:    Send 36 02 [256 bytes]                      â”‚
â”‚                Expected: 76 02  âœ“                           â”‚
â”‚                                                             â”‚
â”‚    Final:       Send 37 (Transfer Exit)                     â”‚
â”‚                Expected: 77  âœ“                              â”‚
â”‚                                                             â”‚
â”‚  Pass Criteria:                                             â”‚
â”‚    âœ“ BSC wraps from 0xFF to 0x01 (not 0x00)                 â”‚
â”‚    âœ“ No sequence errors at wrap boundary                    â”‚
â”‚    âœ“ All 257 blocks transferred successfully                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Test Scenario 4: Voltage Drop During Transfer

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST: Voltage Drop Handling                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Setup:                                                     â”‚
â”‚    â€¢ Session: PROGRAMMING (0x02)                            â”‚
â”‚    â€¢ Security: UNLOCKED                                     â”‚
â”‚    â€¢ SID 0x34 completed                                     â”‚
â”‚    â€¢ Voltage monitoring: 11.0V - 15.5V range                â”‚
â”‚                                                             â”‚
â”‚  Test Steps:                                                â”‚
â”‚                                                             â”‚
â”‚    Step 1:  Voltage = 12.5V                                 â”‚
â”‚            Send 36 01 [1024 bytes]                          â”‚
â”‚            Expected: 76 01  âœ“                               â”‚
â”‚                                                             â”‚
â”‚    Step 2:  Voltage = 12.3V                                 â”‚
â”‚            Send 36 02 [1024 bytes]                          â”‚
â”‚            Expected: 76 02  âœ“                               â”‚
â”‚                                                             â”‚
â”‚    Step 3:  Voltage = 10.8V  â† DROPS BELOW 11.0V            â”‚
â”‚            Send 36 03 [1024 bytes]                          â”‚
â”‚            Expected: 7F 36 93  âœ“ (Voltage Too Low)          â”‚
â”‚                                                             â”‚
â”‚    Step 4:  Voltage = 12.5V  â† RECOVERS                     â”‚
â”‚            Send 36 03 [1024 bytes]  â† RETRY SAME BLOCK      â”‚
â”‚            Expected: 76 03  âœ“                               â”‚
â”‚                                                             â”‚
â”‚    Step 5:  Continue normal transfer                        â”‚
â”‚            Send 36 04 [1024 bytes]                          â”‚
â”‚            Expected: 76 04  âœ“                               â”‚
â”‚                                                             â”‚
â”‚  Pass Criteria:                                             â”‚
â”‚    âœ“ NRC 0x93 returned when voltage too low                 â”‚
â”‚    âœ“ Can retry same BSC after voltage recovery              â”‚
â”‚    âœ“ Transfer continues normally after recovery             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Test Scenario 5: Message Length Validation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST: Message Length Validation                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Setup:                                                     â”‚
â”‚    â€¢ Session: PROGRAMMING (0x02)                            â”‚
â”‚    â€¢ Security: UNLOCKED                                     â”‚
â”‚    â€¢ SID 0x34: Block size = 1024 bytes                      â”‚
â”‚                                                             â”‚
â”‚  Test Steps:                                                â”‚
â”‚                                                             â”‚
â”‚    Step 1:  Send 36 01 [1024 bytes]  â† CORRECT SIZE         â”‚
â”‚            Expected: 76 01  âœ“                               â”‚
â”‚                                                             â”‚
â”‚    Step 2:  Send 36 02 [512 bytes]  â† TOO SHORT             â”‚
â”‚            Expected: 7F 36 13  âœ“ (Incorrect Length)         â”‚
â”‚                                                             â”‚
â”‚    Step 3:  Restart transfer (SID 0x34)                     â”‚
â”‚            Expected: 74 [params]  âœ“                         â”‚
â”‚                                                             â”‚
â”‚    Step 4:  Send 36 01 [1024 bytes]                         â”‚
â”‚            Expected: 76 01  âœ“                               â”‚
â”‚                                                             â”‚
â”‚    Step 5:  Send 36 02 [2048 bytes]  â† TOO LONG             â”‚
â”‚            Expected: 7F 36 13  âœ“ (Incorrect Length)         â”‚
â”‚                                                             â”‚
â”‚  Pass Criteria:                                             â”‚
â”‚    âœ“ NRC 0x13 for blocks shorter than expected              â”‚
â”‚    âœ“ NRC 0x13 for blocks longer than expected               â”‚
â”‚    âœ“ Only exact block size accepted                         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Integration Patterns

### Pattern 1: Flash Download with Checksum Verification

```
  Tester                                    ECU
    â”‚                                        â”‚
    â”‚  1. Enter Programming Session          â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                                        â”‚
    â”‚  2. Unlock Security                    â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                                        â”‚
    â”‚  3. SID 0x34 Request Download          â”‚
    â”‚     Address: 0x00010000                â”‚
    â”‚     Size:    0x00010000 (64KB)         â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚     maxBlockLength: 4096               â”‚
    â”‚                                        â”‚
    â”‚  4. Transfer Loop (16 blocks):         â”‚
    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
    â”‚     â”‚  FOR i = 1 TO 16:        â”‚       â”‚
    â”‚     â”‚    SID 0x36 [BSC=i]      â”‚       â”‚
    â”‚     â”‚    [4096 bytes]          â”‚       â”‚
    â”‚  â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€  â”‚
    â”‚     â”‚    Response: 76 [BSC=i]  â”‚       â”‚
    â”‚     â”‚  END FOR                 â”‚       â”‚
    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
    â”‚                                        â”‚
    â”‚  5. SID 0x37 Request Transfer Exit     â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚     Response: 77                       â”‚
    â”‚                                        â”‚
    â”‚  6. SID 0x31 Checksum Routine          â”‚
    â”‚     Routine ID: 0x0202                 â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚     Checksum: OK âœ“                     â”‚
    â”‚                                        â”‚
    â”‚  7. SID 0x11 ECU Reset                 â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                                        â”‚
    â”‚     ECU reboots with new software      â”‚
    â”‚                                        â”‚
```

### Pattern 2: Multi-Region Flash Programming

```
  Tester                                    ECU
    â”‚                                        â”‚
    â”‚  Session + Security Setup              â”‚
    â”‚  (Same as Pattern 1)                   â”‚
    â”‚                                        â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚  â”‚  REGION 1: Application (128KB)  â”‚   â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                                        â”‚
    â”‚  SID 0x34: Address=0x10000, Size=128KB â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                                        â”‚
    â”‚  SID 0x36: Transfer 32 blocks          â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚  (BSC: 01 â†’ 02 â†’ ... â†’ 20)             â”‚
    â”‚                                        â”‚
    â”‚  SID 0x37: Exit Transfer               â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                                        â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚  â”‚  REGION 2: Calibration (64KB)   â”‚   â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                                        â”‚
    â”‚  SID 0x34: Address=0x30000, Size=64KB  â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                                        â”‚
    â”‚  SID 0x36: Transfer 16 blocks          â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚  (BSC: 01 â†’ 02 â†’ ... â†’ 10)  â† RESTARTS â”‚
    â”‚                                        â”‚
    â”‚  SID 0x37: Exit Transfer               â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                                        â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚  â”‚  REGION 3: Bootloader (32KB)    â”‚   â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚                                        â”‚
    â”‚  SID 0x34: Address=0x00000, Size=32KB  â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                                        â”‚
    â”‚  SID 0x36: Transfer 8 blocks           â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚  (BSC: 01 â†’ 02 â†’ ... â†’ 08)  â† RESTARTS â”‚
    â”‚                                        â”‚
    â”‚  SID 0x37: Exit Transfer               â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                                        â”‚
    â”‚  Final Verification + Reset            â”‚
    â”‚                                        â”‚

  âš ï¸  NOTE: BSC restarts at 0x01 for each new SID 0x34
```

### Pattern 3: Upload with Transfer Data

```
  Tester                                    ECU
    â”‚                                        â”‚
    â”‚  1. Enter Extended Session             â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                                        â”‚
    â”‚  2. Unlock Security                    â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚                                        â”‚
    â”‚  3. SID 0x35 Request Upload            â”‚
    â”‚     Address: 0x00020000                â”‚
    â”‚     Size:    0x00001000 (4KB)          â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚     maxBlockLength: 1024               â”‚
    â”‚                                        â”‚
    â”‚  4. SID 0x36 Transfer Data (Upload)    â”‚
    â”‚     Request: 36 01                     â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚     Response: 76 01 [1024 bytes data]  â”‚
    â”‚                                        â”‚
    â”‚     Request: 36 02                     â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚     Response: 76 02 [1024 bytes data]  â”‚
    â”‚                                        â”‚
    â”‚     Request: 36 03                     â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚     Response: 76 03 [1024 bytes data]  â”‚
    â”‚                                        â”‚
    â”‚     Request: 36 04                     â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚     Response: 76 04 [1024 bytes data]  â”‚
    â”‚                                        â”‚
    â”‚  5. SID 0x37 Request Transfer Exit     â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
    â”‚  â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    â”‚     Response: 77                       â”‚
    â”‚                                        â”‚
    â”‚  âœ“ Upload Complete (4KB read from ECU) â”‚
    â”‚                                        â”‚
```

---

## Debugging Flowcharts

### Debugging: Transfer Fails to Start

```
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Transfer Data (0x36)    â”‚
         â”‚  Returns NRC             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”Œâ”€â”€â”¤  Which NRC Received?     â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚              â”‚
      â”‚         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚        0x7F              0x22       0x33      0x24
      â”‚         â”‚                 â”‚          â”‚         â”‚
      â”‚         â–¼                 â–¼          â–¼         â–¼
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  â”‚ Service  â”‚      â”‚Conditionsâ”‚ â”‚Securityâ”‚ â”‚Sequenceâ”‚
      â”‚  â”‚Not Sup-  â”‚      â”‚Not       â”‚ â”‚Access  â”‚ â”‚Error   â”‚
      â”‚  â”‚ported    â”‚      â”‚Correct   â”‚ â”‚Denied  â”‚ â”‚        â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
      â”‚        â”‚                 â”‚           â”‚          â”‚
      â”‚        â–¼                 â–¼           â–¼          â–¼
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  â”‚Check     â”‚      â”‚Check:    â”‚ â”‚Perform â”‚ â”‚Check   â”‚
      â”‚  â”‚Session:  â”‚      â”‚â€¢ Active  â”‚ â”‚SID 0x27â”‚ â”‚if SID  â”‚
      â”‚  â”‚Must be   â”‚      â”‚  Transferâ”‚ â”‚Securityâ”‚ â”‚0x34    â”‚
      â”‚  â”‚0x02/0x03 â”‚      â”‚  Context?â”‚ â”‚Access  â”‚ â”‚was     â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚â€¢ Voltage?â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚called  â”‚
      â”‚                    â”‚â€¢ Memory? â”‚            â”‚first   â”‚
      â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â””â”€â”€â”€â”€â”€â–¶ Resolve issue and retry
```

### Debugging: Transfer Stops Mid-Way

```
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Transfer Stopped        â”‚
         â”‚  After Block N           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”Œâ”€â”€â”¤  What was last response? â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚              â”‚
      â”‚         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚      NRC 0x71       0x72       0x93      Timeout
      â”‚         â”‚            â”‚          â”‚           â”‚
      â”‚         â–¼            â–¼          â–¼           â–¼
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  â”‚Transfer  â”‚  â”‚Program â”‚ â”‚Voltage â”‚ â”‚ECU Not   â”‚
      â”‚  â”‚Suspended â”‚  â”‚Failure â”‚ â”‚Too Low â”‚ â”‚Respondingâ”‚
      â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚        â”‚            â”‚          â”‚           â”‚
      â”‚        â–¼            â–¼          â–¼           â–¼
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  â”‚Wait for  â”‚  â”‚CRITICALâ”‚ â”‚Check   â”‚ â”‚Check:    â”‚
      â”‚  â”‚condition â”‚  â”‚STOP!   â”‚ â”‚battery â”‚ â”‚â€¢ CAN bus â”‚
      â”‚  â”‚to clear  â”‚  â”‚Reset   â”‚ â”‚voltage â”‚ â”‚â€¢ P2 time â”‚
      â”‚  â”‚then retryâ”‚  â”‚ECU and â”‚ â”‚Connect â”‚ â”‚â€¢ Session â”‚
      â”‚  â”‚same BSC  â”‚  â”‚restart â”‚ â”‚charger â”‚ â”‚timeout   â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚from    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                â”‚SID 0x10â”‚
      â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â””â”€â”€â”€â”€â”€â–¶ Follow resolution steps
```

### Debugging: BSC Sequence Errors

```
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Receiving NRC 0x24      â”‚
         â”‚  (Sequence Error)        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Check BSC Pattern:      â”‚
         â”‚  What was sent?          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚            â”‚            â”‚          â”‚
    Duplicated    Skipped      Wrong       Wrap
    Same BSC      Number       Start       Issue
         â”‚            â”‚            â”‚          â”‚
         â–¼            â–¼            â–¼          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Fix:    â”‚  â”‚Fix:    â”‚  â”‚Fix:    â”‚ â”‚Fix:    â”‚
    â”‚Track   â”‚  â”‚Ensure  â”‚  â”‚Always  â”‚ â”‚After   â”‚
    â”‚sent    â”‚  â”‚incre-  â”‚  â”‚start   â”‚ â”‚0xFF    â”‚
    â”‚BSC and â”‚  â”‚mental  â”‚  â”‚with    â”‚ â”‚use     â”‚
    â”‚don't   â”‚  â”‚BSC:    â”‚  â”‚BSC=0x01â”‚ â”‚0x01    â”‚
    â”‚repeat  â”‚  â”‚1,2,3...â”‚  â”‚after   â”‚ â”‚NOT     â”‚
    â”‚        â”‚  â”‚        â”‚  â”‚SID 0x34â”‚ â”‚0x00    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
         â”‚           â”‚           â”‚          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Restart Transfer:       â”‚
         â”‚  1. SID 0x34 again       â”‚
         â”‚  2. Start BSC from 0x01  â”‚
         â”‚  3. Maintain sequence    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Best Practices Checklist

### Pre-Transfer Checklist

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BEFORE STARTING TRANSFER                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â˜  Session established (PROGRAMMING or EXTENDED)           â”‚
â”‚  â˜  Security unlocked (SID 0x27 completed)                  â”‚
â”‚  â˜  SID 0x34 (Request Download) or 0x35 successful          â”‚
â”‚  â˜  Max block length noted from 0x34/0x35 response          â”‚
â”‚  â˜  Total transfer size known                               â”‚
â”‚  â˜  Number of blocks calculated                             â”‚
â”‚  â˜  Voltage stable (11V - 15.5V typical)                    â”‚
â”‚  â˜  External power supply connected (recommended)           â”‚
â”‚  â˜  Tester Present (0x3E) strategy planned for long ops     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### During Transfer Checklist

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DURING TRANSFER OPERATIONS                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â˜  Start with BSC = 0x01 for first block                   â”‚
â”‚  â˜  Increment BSC sequentially (1, 2, 3, ...)               â”‚
â”‚  â˜  Send exactly maxBlockLength bytes (except last block)   â”‚
â”‚  â˜  Handle wrap-around: 0xFF â†’ 0x01                         â”‚
â”‚  â˜  Verify positive response (0x76) before next block       â”‚
â”‚  â˜  Monitor for NRC 0x71 (suspend) - retry same BSC         â”‚
â”‚  â˜  Monitor voltage continuously                            â”‚
â”‚  â˜  Track cumulative bytes transferred                      â”‚
â”‚  â˜  Send Tester Present (0x3E) if transfer takes > 5 sec    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Post-Transfer Checklist

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AFTER TRANSFER COMPLETE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â˜  All calculated blocks transferred                       â”‚
â”‚  â˜  SID 0x37 (Request Transfer Exit) sent                   â”‚
â”‚  â˜  Positive response (0x77) received                       â”‚
â”‚  â˜  Optional: Run checksum routine (SID 0x31)               â”‚
â”‚  â˜  Optional: Verify programming with SID 0x22 DID read     â”‚
â”‚  â˜  Reset ECU if required (SID 0x11)                        â”‚
â”‚  â˜  Verify new software boots correctly                     â”‚
â”‚  â˜  Clear any DTCs generated during programming             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Error Handling Checklist

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ERROR HANDLING STRATEGIES                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â˜  NRC 0x24 (Sequence): Restart with SID 0x34              â”‚
â”‚  â˜  NRC 0x71 (Suspend): Wait and retry same BSC             â”‚
â”‚  â˜  NRC 0x72 (Failure): STOP, reset ECU, restart all        â”‚
â”‚  â˜  NRC 0x93 (Low V): Wait for voltage, retry same BSC      â”‚
â”‚  â˜  NRC 0x92 (High V): Check power supply, retry            â”‚
â”‚  â˜  NRC 0x13 (Length): Verify block size calculation        â”‚
â”‚  â˜  NRC 0x31 (Range): Check memory addresses and size       â”‚
â”‚  â˜  Timeout: Check CAN bus, session timeout, retry          â”‚
â”‚  â˜  Log all errors with BSC number for debugging            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Performance Optimization Checklist

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PERFORMANCE OPTIMIZATION                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â˜  Use largest block size supported by ECU                 â”‚
â”‚  â˜  Minimize delay between blocks (but respect P2 timing)   â”‚
â”‚  â˜  Use CAN bus at maximum supported baud rate              â”‚
â”‚  â˜  Avoid unnecessary logging during critical transfer      â”‚
â”‚  â˜  Pre-calculate all blocks before starting transfer       â”‚
â”‚  â˜  Use flow control if supported (ISO-TP)                  â”‚
â”‚  â˜  Consider multi-frame CAN messages for efficiency        â”‚
â”‚  â˜  Monitor transfer rate (bytes/second)                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         SID 0x36 PRACTICAL IMPLEMENTATION SUMMARY           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  âœ“ Validate ALL prerequisites before accepting transfer     â”‚
â”‚  âœ“ Maintain strict BSC sequence tracking                    â”‚
â”‚  âœ“ Handle wrap-around correctly (0xFF â†’ 0x01)               â”‚
â”‚  âœ“ Validate message length matches expected block size      â”‚
â”‚  âœ“ Monitor voltage continuously during programming          â”‚
â”‚  âœ“ Distinguish between recoverable (0x71) and critical      â”‚
â”‚    errors (0x72)                                            â”‚
â”‚  âœ“ Support suspend/resume for temporary conditions          â”‚
â”‚  âœ“ Implement proper state machine for transfer context      â”‚
â”‚  âœ“ Test wrap-around scenarios with large transfers          â”‚
â”‚  âœ“ Always complete with SID 0x37 before considering done    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Next Steps:**
- Read: [SID_36_SERVICE_INTERACTIONS.md](SID_36_SERVICE_INTERACTIONS.md) - Complete workflow examples
- Review: [SID_36_TRANSFER_DATA.md](SID_36_TRANSFER_DATA.md) - Theoretical concepts
