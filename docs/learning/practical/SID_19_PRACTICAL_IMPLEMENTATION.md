# SID 0x19 - Practical Implementation Guide

**Document Version**: 3.0  
**Last Updated**: December 7, 2025  
**Format**: Visual Diagrams + Implementation Reference  
**ISO Reference**: ISO 14229-1:2020 Section 10.7

---

## ğŸ“‹ Table of Contents

1. [Request Processing Flowcharts](#request-processing-flowcharts)
2. [NRC Decision Trees](#nrc-decision-trees)
3. [State Machine Diagrams](#state-machine-diagrams)
4. [Testing Scenarios](#testing-scenarios)
5. [Debugging Flowcharts](#debugging-flowcharts)
6. [Best Practices Checklist](#best-practices-checklist)

---

## Request Processing Flowcharts

### Subfunction 0x01: Report Number of DTCs by Status Mask

```
                    START
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Receive Requestâ”‚
              â”‚ 19 01 [Mask]  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”Œâ”€â”€â”€â”€â”¤ Message Lengthâ”‚
         â”‚    â”‚ = 3 bytes?    â”‚
         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚            â”‚
        NO           YES
         â”‚            â”‚
         â–¼            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚7F 19 13â”‚  â”‚Check Sessionâ”‚
    â”‚  (NRC) â”‚  â”‚ State       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”Œâ”€â”€â”€â”€â”¤ DEFAULT or   â”‚
           â”‚    â”‚ EXTENDED?    â”‚
           â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚           â”‚
          NO          YES
           â”‚           â”‚
           â–¼           â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚7F 19 22â”‚  â”‚ Count DTCs  â”‚
      â”‚  (NRC) â”‚  â”‚ matching    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ status mask â”‚
                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ Build       â”‚
                  â”‚ Response:   â”‚
                  â”‚ 59 01       â”‚
                  â”‚ [AvailMask] â”‚
                  â”‚ [Format]    â”‚
                  â”‚ [CountHi]   â”‚
                  â”‚ [CountLo]   â”‚
                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  SEND  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Subfunction 0x02: Report DTC by Status Mask

```
                    START
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Receive:      â”‚
              â”‚ 19 02 [Mask]  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Validate      â”‚
              â”‚ Message (3B)  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Search DTC    â”‚
              â”‚ Memory        â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚            â”‚            â”‚
         â–¼            â–¼            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Match  â”‚  â”‚ Match   â”‚  â”‚ Match   â”‚
    â”‚ DTC 1  â”‚  â”‚ DTC 2   â”‚  â”‚ DTC 3   â”‚
    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
        â”‚            â”‚            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Build       â”‚
              â”‚ Response:   â”‚
              â”‚ 59 02       â”‚
              â”‚ [AvailMask] â”‚
              â”‚ [DTC1][St1] â”‚
              â”‚ [DTC2][St2] â”‚
              â”‚ [DTC3][St3] â”‚
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ SEND  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Subfunction 0x04: Report DTC Snapshot Record

```
                    START
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Receive:               â”‚
         â”‚ 19 04 [DTC3] [RecNum]  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”Œâ”€â”€â”€â”€â”¤ Length = 6 bytes?      â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                 â”‚
   NO                YES
    â”‚                 â”‚
    â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚7F 19 13â”‚   â”‚ Lookup DTC in  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ Memory         â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚                 â”‚
            NO                YES
     (Not Found)         (Found)
             â”‚                 â”‚
             â–¼                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚7F 19 31â”‚    â”‚ Check Record # â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Availability   â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚                 â”‚
                     NO                YES
              (Invalid Rec)      (Valid Rec)
                      â”‚                 â”‚
                      â–¼                 â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚7F 19 31â”‚    â”‚ Read Snapshot  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Data from      â”‚
                               â”‚ Memory         â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚ Build Response:â”‚
                               â”‚ 59 04          â”‚
                               â”‚ [DTC3]         â”‚
                               â”‚ [Status]       â”‚
                               â”‚ [RecNum]       â”‚
                               â”‚ [DataID][Data] â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚ SEND  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Subfunction 0x06: Report Extended Data Record

```
                    START
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Receive:               â”‚
         â”‚ 19 06 [DTC3] [RecNum]  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Validate Request       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”Œâ”€â”€â”€â”€â”¤ Security Required?     â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                 â”‚
   YES               NO
    â”‚                 â”‚
    â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check       â”‚  â”‚ Lookup DTC     â”‚
â”‚ Security    â”‚  â”‚ and Record     â”‚
â”‚ State       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
       â”‚                  â”‚
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”              â”‚
   â”‚       â”‚              â”‚
LOCKED  UNLOCKED          â”‚
   â”‚       â”‚              â”‚
   â–¼       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚7F 19 33â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Read Extended  â”‚
                 â”‚ Data Records:  â”‚
                 â”‚ â€¢ Occurrence   â”‚
                 â”‚ â€¢ Aging        â”‚
                 â”‚ â€¢ Custom Data  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Format Responseâ”‚
                 â”‚ 59 06 [DTC3]   â”‚
                 â”‚ [Status]       â”‚
                 â”‚ [ExtDataRecs]  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ SEND  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Subfunction 0x0A: Report Supported DTCs

```
                    START
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Receive:      â”‚
              â”‚ 19 0A         â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”Œâ”€â”€â”€â”€â”¤ Message Lengthâ”‚
         â”‚    â”‚ = 2 bytes?    â”‚
         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚            â”‚
        NO           YES
         â”‚            â”‚
         â–¼            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚7F 19 13â”‚  â”‚Check Sessionâ”‚
    â”‚  (NRC) â”‚  â”‚ State       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ DEFAULT or   â”‚
                â”‚ EXTENDED?    â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                      OK
                       â”‚
                       â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Read ECU     â”‚
                â”‚ Capability   â”‚
                â”‚ Definition   â”‚
                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                           â”‚
         â–¼                           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Emissionsâ”‚               â”‚ Body/   â”‚
    â”‚ Related â”‚               â”‚Chassis/ â”‚
    â”‚ DTCs    â”‚               â”‚Network  â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚                         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Build List   â”‚
              â”‚ of All DTCs  â”‚
              â”‚ ECU Can      â”‚
              â”‚ Detect       â”‚
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Format:      â”‚
              â”‚ 59 0A        â”‚
              â”‚ [AvailMask]  â”‚
              â”‚ [DTC1]       â”‚
              â”‚ [DTC2]       â”‚
              â”‚ ...          â”‚
              â”‚ [DTCn]       â”‚
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ SEND  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          SPECIAL CHARACTERISTICS OF 0x0A                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Key Differences from Other Subfunctions:
  â€¢ Returns ALL possible DTCs (not just active/stored ones)
  â€¢ No status mask parameter needed
  â€¢ Response includes DTCs that COULD occur, not just those present
  â€¢ Useful for diagnostic tool capability discovery
  â€¢ Response does NOT include status bytes (just DTC numbers)

Response Structure:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ 0x59   â”‚ 0x0A         â”‚ Mask  â”‚ DTC1  â”‚ DTC2â”‚ DTCn  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
   SID+0x40  Subfunction   Avail   3 bytes each (no status)

Example Response:
  59 0A 00 P0 01 35 P0 04 20 P0 17 1 C1 23 4 U0 10 0
       â””â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
       Mask  5 Supported DTCs (15 bytes total)
```

---

## NRC Decision Trees

### General NRC Decision Tree

```
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Request Receivedâ”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”Œâ”€â”€â”€â”€â”¤ Correct Length? â”‚â”€â”€â”€â”€â”
            â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
           NO                          YES
            â”‚                            â”‚
            â–¼                            â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚7F 19 13 â”‚       â”Œâ”€â”€â”€â”€â”¤ Subfunction     â”‚â”€â”€â”€â”€â”
       â”‚(Bad Len)â”‚       â”‚    â”‚ Supported?      â”‚    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      NO    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   YES
                         â”‚                            â”‚
                         â–¼                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚7F 19 12 â”‚       â”Œâ”€â”€â”€â”€â”¤ Session OK?     â”‚â”€â”€â”€â”€â”
                    â”‚(Bad SF) â”‚       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      NO                          YES
                                      â”‚                            â”‚
                                      â–¼                            â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚7F 19 22 â”‚       â”Œâ”€â”€â”€â”€â”¤ Conditions OK?  â”‚â”€â”€â”€â”€â”
                                 â”‚(Cond)   â”‚       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      NO                          YES
                                                   â”‚                            â”‚
                                                   â–¼                            â–¼
                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚7F 19 22 â”‚       â”Œâ”€â”€â”€â”€â”¤ Security OK?    â”‚â”€â”€â”€â”€â”
                                              â”‚(Cond)   â”‚       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      NO                          YES
                                                                â”‚                            â”‚
                                                                â–¼                            â–¼
                                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                           â”‚7F 19 33 â”‚            â”‚ Process Request â”‚
                                                           â”‚(Sec)    â”‚            â”‚ Send 59 XX      â”‚
                                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Subfunction-Specific NRC Decision

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         SUBFUNCTION VALIDATION DECISION TREE                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Subfunction 0x01, 0x02 (Status Mask Based)
    â”‚
    â”œâ”€ Status Mask = 0x00? â†’ Valid âœ“ (search for cleared DTCs)
    â”œâ”€ Status Mask valid (0x01-0xFF)? â†’ Valid âœ“
    â””â”€ Otherwise â†’ 7F 19 31 (Request Out of Range)

Subfunction 0x04, 0x06 (DTC + Record Number)
    â”‚
    â”œâ”€ DTC exists in memory? NO â†’ 7F 19 31
    â”œâ”€ Record number = 0xFF? YES â†’ All records (Valid âœ“)
    â”œâ”€ Record number = 0x00? YES â†’ Record 0 (Valid âœ“)
    â”œâ”€ Record exists for DTC? NO â†’ 7F 19 31
    â””â”€ Otherwise â†’ Valid âœ“

Subfunction 0x0A (Supported DTCs)
    â”‚
    â””â”€ No parameters needed â†’ Always Valid âœ“

Subfunction 0x0F-0x11 (Mirror Memory)
    â”‚
    â”œâ”€ Extended session? NO â†’ 7F 19 22
    â”œâ”€ Mirror memory supported? NO â†’ 7F 19 12
    â””â”€ Otherwise â†’ Valid âœ“
```

---

## State Machine Diagrams

### DTC Lifecycle State Machine

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  DTC LIFECYCLE STATES                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  NO FAULT    â”‚ Status: 0x00
                    â”‚  (Cleared)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ Test Failed
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   PENDING    â”‚ Status: 0x04
                    â”‚  (1st Fail)  â”‚ Bit 2 = 1
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                         â”‚
         Test Passed              Test Failed
         (1 cycle)                (2nd time)
              â”‚                         â”‚
              â–¼                         â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  NO FAULT    â”‚          â”‚  CONFIRMED   â”‚ Status: 0x08
       â”‚  (Cleared)   â”‚          â”‚   (Stored)   â”‚ Bit 3 = 1
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚                         â”‚
                      Currently                  Currently
                       Failing                    Passing
                           â”‚                         â”‚
                           â–¼                         â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  CONFIRMED   â”‚         â”‚  CONFIRMED   â”‚
                    â”‚   + ACTIVE   â”‚         â”‚ + INACTIVE   â”‚
                    â”‚ Status: 0x09 â”‚         â”‚ Status: 0x08 â”‚
                    â”‚ Bit 0,3 = 1  â”‚         â”‚ Bit 3 = 1    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                         â”‚
                           â”‚                         â”‚
                           â”‚        Clear DTCs       â”‚
                           â”‚      (SID 0x14)         â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚  NO FAULT    â”‚ Status: 0x00
                                 â”‚  (Cleared)   â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Session State Impact on SID 0x19

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           SESSION STATE MACHINE FOR SID 0x19                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   POWER ON      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ DEFAULT SESSION â”‚
              â”‚     (0x01)      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                                 â”‚
      â–¼                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SID 0x19     â”‚                â”‚ SID 0x10 0x03â”‚
â”‚ Subfunctions:â”‚                â”‚ (Go Extended)â”‚
â”‚              â”‚                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ âœ“ 0x01-0x0E  â”‚                       â”‚
â”‚ âœ“ 0x42, 0x55 â”‚                       â–¼
â”‚ âŒ 0x0F-0x19 â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   EXTENDED   â”‚
                               â”‚   SESSION    â”‚
                               â”‚    (0x03)    â”‚
                               â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                               â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                               â”‚ SID 0x19    â”‚
                               â”‚ All         â”‚
                               â”‚ Subfunctionsâ”‚
                               â”‚ âœ“ 0x01-0x19 â”‚
                               â”‚ âœ“ 0x0F-0x11 â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Supported DTCs Discovery Flow (0x0A)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        SUBFUNCTION 0x0A - SUPPORTED DTCs DISCOVERY           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Diagnostic Tool â”‚
                    â”‚  Initialization â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Request 19 0A   â”‚
                    â”‚ (Supported DTCs)â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ ECU Reads Capability     â”‚
              â”‚ Configuration:           â”‚
              â”‚ â€¢ Variant coding         â”‚
              â”‚ â€¢ Feature flags          â”‚
              â”‚ â€¢ Calibration data       â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                               â”‚
         â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Emissions DTCs  â”‚           â”‚ Other DTCs      â”‚
â”‚ (P-codes)       â”‚           â”‚ (C, B, U-codes) â”‚
â”‚ â€¢ P0xxx         â”‚           â”‚ â€¢ C0xxx (Chassis)â”‚
â”‚ â€¢ P2xxx         â”‚           â”‚ â€¢ B0xxx (Body)   â”‚
â”‚ â€¢ P3xxx         â”‚           â”‚ â€¢ U0xxx (Network)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Merge All Lists  â”‚
              â”‚ Remove Duplicatesâ”‚
              â”‚ Sort by DTC Code â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Format Response: â”‚
              â”‚ 59 0A [Mask]     â”‚
              â”‚ [DTC List]       â”‚
              â”‚ (No Status Bytes)â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Tool Stores List â”‚
              â”‚ For Reference    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Key Concept: 0x0A returns POTENTIAL DTCs, not ACTIVE ones

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COMPARISON: 0x0A vs. 0x02                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Subfunction 0x0A (Supported)                               â”‚
â”‚ â€¢ Returns DTCs the ECU CAN detect                          â”‚
â”‚ â€¢ No status information                                    â”‚
â”‚ â€¢ Static list (capability-based)                           â”‚
â”‚ â€¢ Use: Tool configuration, capability discovery            â”‚
â”‚                                                            â”‚
â”‚ Subfunction 0x02 (Active)                                  â”‚
â”‚ â€¢ Returns DTCs currently stored                            â”‚
â”‚ â€¢ Includes status byte per DTC                             â”‚
â”‚ â€¢ Dynamic list (fault-based)                               â”‚
â”‚ â€¢ Use: Troubleshooting, repair verification                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Testing Scenarios

### Scenario 1: Read and Verify DTC Count

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST: Verify DTC Count Matches Actual Stored DTCs          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: Request DTC count (confirmed only)
  Tester â†’ ECU: 19 01 08
  ECU â†’ Tester: 59 01 19 01 00 03
                          â””â”€â”€â”´â”€â”€ 3 DTCs

Step 2: Request actual DTCs
  Tester â†’ ECU: 19 02 08
  ECU â†’ Tester: 59 02 19 P0135 08 P0420 08 C1234 08
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€ 3 DTCs

âœ“ PASS: Count (3) matches actual DTCs (3)

Step 3: Request all DTCs (any status)
  Tester â†’ ECU: 19 01 FF
  ECU â†’ Tester: 59 01 19 01 00 05
                          â””â”€â”€â”´â”€â”€ 5 DTCs total

Step 4: Verify with read
  Tester â†’ ECU: 19 02 FF
  ECU â†’ Tester: 59 02 19 P0135 08 P0171 04 P0420 09 
                          C1234 08 U0100 08
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 5 DTCs

âœ“ PASS: All counts verified
```

### Scenario 2: Snapshot Data Validation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST: Read and Parse Snapshot Data (Freeze Frame)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Precondition: DTC P0420 stored with snapshot record 01

Step 1: Request snapshot
  Tester â†’ ECU: 19 04 P0 04 20 01
  ECU â†’ Tester: 59 04 P0 04 20 08 01 [Snapshot Data]

Step 2: Parse snapshot data structure
  Response Breakdown:
  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ 0x59 â”‚ 0x04 â”‚ P0 04 20   â”‚ 0x08   â”‚ 0x01 â”‚ Data Recordsâ”‚
  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    SID    SF     DTC          Status   RecNum  Freeze Data

Step 3: Extract data identifiers
  Example Snapshot Data:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ DataID â”‚ Value                    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 0x0C   â”‚ 1500 RPM (2 bytes)       â”‚
  â”‚ 0x0D   â”‚ 45 km/h (1 byte)         â”‚
  â”‚ 0x05   â”‚ 85Â°C (1 byte)            â”‚
  â”‚ 0x11   â”‚ 25% Load (1 byte)        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ“ PASS: Snapshot data retrieved and parsed
```

### Scenario 3: Extended Data Verification

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST: Verify Extended Data (Occurrence Counters)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: Request all extended data for DTC
  Tester â†’ ECU: 19 06 P0 04 20 FF
                             â””â”€â”€ 0xFF = all records

Step 2: Parse response
  ECU â†’ Tester: 59 06 P0 04 20 08 [Ext Records]

  Extended Data Records:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Record # â”‚ Length â”‚ Data                     â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 0x01     â”‚ 1 byte â”‚ Occurrence: 12 times     â”‚
  â”‚ 0x02     â”‚ 1 byte â”‚ Aging counter: 0         â”‚
  â”‚ 0x03     â”‚ 1 byte â”‚ Aged counter: 0          â”‚
  â”‚ 0x50     â”‚ N bytesâ”‚ Manufacturer data        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ“ PASS: Extended data shows fault occurred 12 times
```

### Scenario 4: Clear and Verify DTCs

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST: Clear DTCs and Verify Successful Clear               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: Check initial DTC count
  Tester â†’ ECU: 19 01 FF
  ECU â†’ Tester: 59 01 19 01 00 05 (5 DTCs)

Step 2: Clear all DTCs (SID 0x14)
  Tester â†’ ECU: 14 FF FF FF
  ECU â†’ Tester: 54 âœ“

Step 3: Verify clear succeeded
  Tester â†’ ECU: 19 01 FF
  ECU â†’ Tester: 59 01 19 01 00 00 (0 DTCs) âœ“

Step 4: Verify no DTCs returned
  Tester â†’ ECU: 19 02 FF
  ECU â†’ Tester: 59 02 19 (No DTC data) âœ“

âœ“ PASS: DTCs successfully cleared
```

### Scenario 5: NRC Testing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST: Verify Negative Response Codes                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Test A: Invalid subfunction
  Tester â†’ ECU: 19 99 FF
  ECU â†’ Tester: 7F 19 12 âœ“ (Sub-function Not Supported)

Test B: Incorrect message length
  Tester â†’ ECU: 19 04 P0 01 35
                      â””â”€â”€â”€â”€â”´â”€â”€ Missing record number
  ECU â†’ Tester: 7F 19 13 âœ“ (Incorrect Message Length)

Test C: Invalid DTC number
  Tester â†’ ECU: 19 04 FF FF FF 01
  ECU â†’ Tester: 7F 19 31 âœ“ (Request Out of Range)

Test D: Wrong session for mirror memory
  [In DEFAULT session]
  Tester â†’ ECU: 19 0F FF
  ECU â†’ Tester: 7F 19 22 âœ“ (Conditions Not Correct)

âœ“ PASS: All NRCs returned correctly
```

### Scenario 6: Supported DTCs Discovery (0x0A)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST: Discover All DTCs ECU Can Detect                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Precondition: ECU supports diagnostic capability reporting

Step 1: Request all supported DTCs
  Tester â†’ ECU: 19 0A
  ECU â†’ Tester: 59 0A 00 [Supported DTCs]

Step 2: Parse complete response
  Response Breakdown:
  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ 0x59 â”‚ 0x0A â”‚ 0x00 â”‚ DTC List (3 bytes per DTC)      â”‚
  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    SID    SF     Mask   No status bytes included

  Example Supported DTCs:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ DTC Code â”‚ Description                        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ P0135    â”‚ O2 Sensor Heater Circuit          â”‚
  â”‚ P0171    â”‚ System Too Lean (Bank 1)          â”‚
  â”‚ P0420    â”‚ Catalyst System Efficiency        â”‚
  â”‚ P0562    â”‚ System Voltage Low                â”‚
  â”‚ C1234    â”‚ ABS Wheel Speed Sensor            â”‚
  â”‚ U0100    â”‚ Lost Communication with ECM       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 3: Compare with currently stored DTCs
  Tester â†’ ECU: 19 02 FF (Get actual stored DTCs)
  ECU â†’ Tester: 59 02 00 P0171 04 P0420 08

  Analysis:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ DTC      â”‚ Supported â”‚ Currently Stored?   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ P0135    â”‚ âœ“         â”‚ âœ— (Capable but OK)  â”‚
  â”‚ P0171    â”‚ âœ“         â”‚ âœ“ (Pending)         â”‚
  â”‚ P0420    â”‚ âœ“         â”‚ âœ“ (Confirmed)       â”‚
  â”‚ P0562    â”‚ âœ“         â”‚ âœ— (Capable but OK)  â”‚
  â”‚ C1234    â”‚ âœ“         â”‚ âœ— (Capable but OK)  â”‚
  â”‚ U0100    â”‚ âœ“         â”‚ âœ— (Capable but OK)  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 4: Use for diagnostic tool configuration
  â€¢ Configure tester to show only relevant DTCs for this ECU
  â€¢ Enable correct DTC descriptions
  â€¢ Prepare proper freeze frame/snapshot DIDs
  â€¢ Set up correct clearing procedures

âœ“ PASS: Supported DTCs discovered, tool configured

Use Cases for 0x0A:
  1. Diagnostic tool initialization
  2. ECU capability discovery
  3. Software variant identification
  4. Test coverage planning
  5. Fault injection test setup
```

### Scenario 7: Cross-Reference Supported vs. Active DTCs

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST: Verify DTC Capability vs. Active Faults              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Test Workflow:

Step 1: Get baseline (supported DTCs)
  Tester â†’ ECU: 19 0A
  ECU â†’ Tester: 59 0A 00 [20 supported DTCs]
  Result: ECU can detect 20 different fault types

Step 2: Check current health
  Tester â†’ ECU: 19 01 FF (Count all status)
  ECU â†’ Tester: 59 01 00 01 00 02
                          â””â”€â”€â”´â”€â”€ 2 DTCs present
  Result: 2 out of 20 possible DTCs are active

Step 3: Identify the active ones
  Tester â†’ ECU: 19 02 FF
  ECU â†’ Tester: 59 02 00 P0171 04 P0420 08

Step 4: Calculate ECU health score
  Health = (Supported - Active) / Supported Ã— 100%
         = (20 - 2) / 20 Ã— 100%
         = 90% healthy

âœ“ PASS: Health monitoring established
```

---

## Debugging Flowcharts

### Debugging: No DTCs Returned When Expected

```
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ PROBLEM: No DTCs     â”‚
            â”‚ returned but faults  â”‚
            â”‚ should exist         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”Œâ”€â”€â”€â”€â”¤ Check: Were DTCs     â”‚
       â”‚    â”‚ recently cleared?    â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚               â”‚
      YES             NO
       â”‚               â”‚
       â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DTCs were   â”‚  â”‚ Check: Correct   â”‚
â”‚ cleared by  â”‚  â”‚ status mask used?â”‚
â”‚ SID 0x14 or â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ battery     â”‚           â”‚
â”‚ disconnect  â”‚      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚         â”‚
                    YES       NO
                     â”‚         â”‚
                     â–¼         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚Check:DTC â”‚ â”‚ Use 0xFF â”‚
              â”‚setting   â”‚ â”‚ mask to  â”‚
              â”‚enabled?  â”‚ â”‚ get all  â”‚
              â”‚(SID 0x85)â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                   â”‚
              â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
              â”‚         â”‚
           ENABLED  DISABLED
              â”‚         â”‚
              â–¼         â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚Check ECU â”‚ â”‚Enable DTCâ”‚
       â”‚fault     â”‚ â”‚setting   â”‚
       â”‚detection â”‚ â”‚SID 0x85  â”‚
       â”‚logic     â”‚ â”‚0x01      â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Debugging: Snapshot Data Empty or Invalid

```
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ PROBLEM: Snapshot    â”‚
            â”‚ data is empty or     â”‚
            â”‚ malformed            â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”Œâ”€â”€â”€â”€â”¤ Verify: DTC exists?  â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚               â”‚
      NO              YES
       â”‚               â”‚
       â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Request     â”‚  â”‚ Check: Record    â”‚
â”‚ returns     â”‚  â”‚ number valid?    â”‚
â”‚ 7F 19 31    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ (DTC not    â”‚           â”‚
â”‚ found)      â”‚      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚         â”‚
                    YES       NO
                     â”‚         â”‚
                     â–¼         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚Check:    â”‚ â”‚ Try 0xFF â”‚
              â”‚Snapshot  â”‚ â”‚ to get   â”‚
              â”‚captured? â”‚ â”‚ all recs â”‚
              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
              â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
              â”‚         â”‚
           CAPTURED  NOT CAPTURED
              â”‚         â”‚
              â–¼         â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚Parse dataâ”‚ â”‚ECU may   â”‚
       â”‚using DID â”‚ â”‚not store â”‚
       â”‚structure â”‚ â”‚snapshots â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚for this  â”‚
                    â”‚DTC type  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Debugging: Unexpected NRC 0x22

```
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ PROBLEM: Receiving   â”‚
            â”‚ NRC 0x22 (Conditions â”‚
            â”‚ Not Correct)         â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”Œâ”€â”€â”€â”€â”¤ Check: Vehicle       â”‚
       â”‚    â”‚ conditions OK?       â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚               â”‚
    Moving         Stationary
       â”‚               â”‚
       â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stop vehicleâ”‚  â”‚ Check: Engine    â”‚
â”‚ Speed must  â”‚  â”‚ state            â”‚
â”‚ be 0 km/h   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
                     â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
                     â”‚         â”‚
                  Running     Off
                     â”‚         â”‚
                     â–¼         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚Some ECUs â”‚ â”‚Check:    â”‚
              â”‚require   â”‚ â”‚Session   â”‚
              â”‚engine OFFâ”‚ â”‚state?    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                â”‚
                           â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
                           â”‚         â”‚
                       DEFAULT   EXTENDED
                           â”‚         â”‚
                           â–¼         â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚Check if  â”‚ â”‚Should be â”‚
                    â”‚subfunctionâ”‚ â”‚OK - checkâ”‚
                    â”‚needs     â”‚ â”‚security  â”‚
                    â”‚EXTENDED  â”‚ â”‚access    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Debugging: Supported DTCs (0x0A) Returns Empty List

```
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ PROBLEM: Subfunction â”‚
            â”‚ 0x0A returns no DTCs â”‚
            â”‚ or very few          â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”Œâ”€â”€â”€â”€â”¤ Check: Subfunction   â”‚
       â”‚    â”‚ 0x0A supported?      â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚               â”‚
      NO              YES
       â”‚               â”‚
       â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ECU returns â”‚  â”‚ Check: ECU       â”‚
â”‚ 7F 19 12    â”‚  â”‚ software variant?â”‚
â”‚ (Not        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Supported)  â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
                     â”‚         â”‚
                 Basic ECU  Full Feature
                     â”‚         â”‚
                     â–¼         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚May only  â”‚ â”‚Check:    â”‚
              â”‚support   â”‚ â”‚Configuredâ”‚
              â”‚mandatory â”‚ â”‚DTCs in   â”‚
              â”‚emission  â”‚ â”‚variant   â”‚
              â”‚DTCs      â”‚ â”‚data      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ Verify:      â”‚
                         â”‚ â€¢ Calibrationâ”‚
                         â”‚   loaded?    â”‚
                         â”‚ â€¢ DTC config â”‚
                         â”‚   files OK?  â”‚
                         â”‚ â€¢ Feature    â”‚
                         â”‚   flags set? â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Common Causes:
  1. ECU software variant doesn't include full DTC library
  2. Configuration/calibration not loaded properly
  3. Feature licensing/activation required
  4. Manufacturing mode still active (DTCs disabled)
  5. Subfunction not implemented (returns empty list vs. NRC)
```

### Debugging: Mismatch Between 0x0A and Actual DTCs

```
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ PROBLEM: DTC appears â”‚
            â”‚ in 0x02 but not in   â”‚
            â”‚ 0x0A supported list  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”Œâ”€â”€â”€â”€â”¤ Check: Dynamic DTC?  â”‚
       â”‚    â”‚ (runtime generated)  â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚               â”‚
      YES             NO
       â”‚               â”‚
       â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Some ECUs   â”‚  â”‚ Check: Software  â”‚
â”‚ generate    â”‚  â”‚ updated after    â”‚
â”‚ DTCs based  â”‚  â”‚ initial query?   â”‚
â”‚ on active   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ config (e.g.â”‚           â”‚
â”‚ trailer     â”‚      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
â”‚ connected)  â”‚      â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     YES       NO
                     â”‚         â”‚
                     â–¼         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚Re-query  â”‚ â”‚Possible  â”‚
              â”‚19 0A     â”‚ â”‚ECU bug:  â”‚
              â”‚after     â”‚ â”‚DTC shouldâ”‚
              â”‚config    â”‚ â”‚be in 0x0Aâ”‚
              â”‚change    â”‚ â”‚list      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Resolution Strategy:
  1. Query 0x0A at start of diagnostic session
  2. Store list as "baseline capabilities"
  3. If unexpected DTC appears, re-query 0x0A
  4. Document any discrepancies for ECU validation
  5. Check ISO 14229-1 compliance of ECU
```

---

## Best Practices Checklist

### Implementation Checklist

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         SID 0x19 IMPLEMENTATION BEST PRACTICES               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

REQUEST VALIDATION:
  â˜ Verify message length for each subfunction
  â˜ Validate status mask range (0x00-0xFF)
  â˜ Check DTC number format (3 bytes)
  â˜ Validate record number (0x00-0xFF)
  â˜ Verify subfunction support before processing

SESSION MANAGEMENT:
  â˜ Check session state (DEFAULT/EXTENDED required)
  â˜ Implement session timeout handling
  â˜ Support subfunction 0x01-0x0E in DEFAULT session
  â˜ Restrict 0x0F-0x19 to EXTENDED session (if applicable)
  â˜ Maintain session state during multi-request sequences

SECURITY:
  â˜ Identify which DTCs require security access
  â˜ Validate security state before returning protected data
  â˜ Return NRC 0x33 for security-locked DTCs
  â˜ Allow public DTCs (P-codes) without security
  â˜ Document security requirements clearly

DTC STORAGE:
  â˜ Implement proper DTC lifecycle (pending â†’ confirmed)
  â˜ Update status bits correctly (8-bit status byte)
  â˜ Store snapshot data when DTC first fails
  â˜ Maintain occurrence counters in extended data
  â˜ Support aging/aged counters per ISO 14229-1
  â˜ Implement proper DTC priority/severity
  â˜ Define complete supported DTC list (for 0x0A response)
  â˜ Ensure supported DTC list matches ECU capabilities

RESPONSE FORMATTING:
  â˜ Include status availability mask in responses
  â˜ Use correct DTC format identifier (0x01 = ISO14229-1)
  â˜ Format DTC count as 2 bytes (Hi + Lo)
  â˜ Include status byte for each DTC (except 0x0A)
  â˜ Structure snapshot data with Data IDs
  â˜ Format extended data records properly
  â˜ For 0x0A: return DTCs only (no status bytes)
  â˜ For 0x0A: include ALL detectable DTCs, not just active ones

ERROR HANDLING:
  â˜ Return NRC 0x12 for unsupported subfunctions
  â˜ Return NRC 0x13 for incorrect message length
  â˜ Return NRC 0x22 for wrong session or conditions
  â˜ Return NRC 0x31 for invalid DTC or record number
  â˜ Return NRC 0x33 for security access denied
  â˜ Handle edge cases (no DTCs, empty records)

PERFORMANCE:
  â˜ Optimize DTC search algorithms
  â˜ Implement efficient status mask filtering
  â˜ Use response pending (0x78) for long operations
  â˜ Cache frequently accessed DTC data
  â˜ Minimize memory fragmentation

TESTING:
  â˜ Test all supported subfunctions
  â˜ Verify NRC responses for invalid requests
  â˜ Test with various status masks (0x00, 0x08, 0xFF)
  â˜ Validate snapshot and extended data integrity
  â˜ Test session transitions during DTC operations
  â˜ Verify DTC clear and re-check workflow
  â˜ Test with maximum DTC count scenarios
  â˜ Verify 0x0A returns complete supported DTC list
  â˜ Compare 0x0A list with actual detectable faults
  â˜ Test 0x0A in both DEFAULT and EXTENDED sessions

DOCUMENTATION:
  â˜ Document all supported subfunctions
  â˜ List DTC format used (ISO 14229-1, SAE J2012)
  â˜ Specify session requirements per subfunction
  â˜ Document security access requirements
  â˜ Provide snapshot data structure (DIDs included)
  â˜ List extended data record definitions
  â˜ Include example request/response sequences
  â˜ Publish complete supported DTC list (from 0x0A)
  â˜ Document DTC capability vs. variant configuration
```

### Integration Checklist

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         INTEGRATION WITH OTHER SERVICES                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

WITH SID 0x10 (Session Control):
  â˜ Test DTC reading in all supported sessions
  â˜ Verify session timeout doesn't interrupt DTC reads
  â˜ Handle session transitions gracefully

WITH SID 0x14 (Clear DTC):
  â˜ Verify SID 0x19 0x01 returns 0 after clear
  â˜ Ensure all DTC data (snapshot, extended) is cleared
  â˜ Reset status bits to 0x00
  â˜ Test selective vs. full clear

WITH SID 0x27 (Security Access):
  â˜ Identify protected vs. public DTCs
  â˜ Test security unlock before protected DTC access
  â˜ Verify NRC 0x33 when locked

WITH SID 0x85 (Control DTC Setting):
  â˜ Test DTC reading when setting disabled
  â˜ Verify existing DTCs remain readable
  â˜ Ensure new DTCs aren't stored when disabled

WITH SID 0x22 (Read Data by Identifier):
  â˜ Cross-reference snapshot DIDs with live data
  â˜ Ensure consistent data formatting
  â˜ Use same scaling/units
```

---

## Implementation Reference

> ğŸ“ **This section documents the actual implementation in the UDS Simulator codebase**

### Core Implementation Files

| File | Purpose |
|------|---------|
| `src/services/UDSSimulator.ts` | Main SID 0x19 handler with all 15 subfunctions |
| `src/types/uds.ts` | DTC interfaces: DTCInfo, DTCSnapshotRecord, DTCExtendedDataRecord |
| `src/services/mockECU.ts` | Comprehensive DTC database (P, C, B, U codes) |
| `src/utils/udsHelpers.ts` | DTC formatting and status interpretation helpers |

### UI Components

| Component | Purpose |
|-----------|---------|
| `src/components/DTCManagementPanel.tsx` | Real-time DTC visualization with category/status filtering |
| `src/components/ResponseVisualizer.tsx` | Subfunction-aware byte interpretation |
| `src/data/serviceTooltipData.ts` | Quick examples for all major subfunctions |

### Supported Subfunctions (Implemented)

| SF | Name | Status |
|----|------|--------|
| 0x01 | reportNumberOfDTCByStatusMask | âœ… Full |
| 0x02 | reportDTCByStatusMask | âœ… Full |
| 0x03 | reportDTCSnapshotIdentification | âœ… Full |
| 0x04 | reportDTCSnapshotRecordByDTCNumber | âœ… Full |
| 0x06 | reportDTCExtDataRecordByDTCNumber | âœ… Full |
| 0x07 | reportNumberOfDTCBySeverityMaskRecord | âœ… Full |
| 0x08 | reportDTCBySeverityMaskRecord | âœ… Full |
| 0x09 | reportSeverityInformationOfDTC | âœ… Full |
| 0x0A | reportSupportedDTC | âœ… Full |
| 0x0B | reportFirstTestFailedDTC | âœ… Full |
| 0x0C | reportFirstConfirmedDTC | âœ… Full |
| 0x0D | reportMostRecentTestFailedDTC | âœ… Full |
| 0x0E | reportMostRecentConfirmedDTC | âœ… Full |
| 0x0F | reportMirrorMemoryDTCByStatusMask | âœ… Full |

### Mock DTC Database

The simulator includes 14 pre-configured DTCs across all categories:

- **Powertrain (P-codes)**: Engine, transmission, drivetrain faults
- **Chassis (C-codes)**: ABS, stability control, suspension faults
- **Body (B-codes)**: Airbag, lighting, climate faults
- **Network (U-codes)**: CAN bus, ECU communication faults

Each DTC includes:
- Snapshot records with freeze frame data (RPM, speed, temps)
- Extended data (occurrence counters, aging counters, timestamps)
- Proper ISO 14229 status bytes

### Learning Resources

- Interactive lesson in `src/data/learningContent.ts` (service-0x19)
- 4 quiz questions covering status bytes, subfunctions, and DTC prefixes
- 3 examples with complete byte-by-byte breakdowns

---

**End of Document**

