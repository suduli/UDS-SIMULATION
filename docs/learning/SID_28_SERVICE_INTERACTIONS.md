# SID 0x28: Communication Control - Service Interactions Guide

**Document Version**: 2.0  
**Last Updated**: October 12, 2025  
**Format**: Visual Diagrams (No Code)  
**ISO Reference**: ISO 14229-1:2020 Section 9.5

---

## Table of Contents

1. [Overview](#overview)
2. [Service Dependency Pyramid](#service-dependency-pyramid)
3. [Session Requirements Matrix](#session-requirements-matrix)
4. [Complete Workflow Examples](#complete-workflow-examples)
5. [Multi-Service Interaction Patterns](#multi-service-interaction-patterns)
6. [Integration with Specific Services](#integration-with-specific-services)
7. [Troubleshooting Multi-Service Scenarios](#troubleshooting-multi-service-scenarios)
8. [Quick Reference Tables](#quick-reference-tables)

---

## Overview

SID 0x28 (Communication Control) **rarely operates alone**. It's typically used in conjunction with other UDS services to:

- **Isolate ECUs** before firmware updates (with SID 0x34, 0x36, 0x37)
- **Prevent interference** during diagnostic routines (with SID 0x31)
- **Control network traffic** during configuration writes (with SID 0x2E)
- **Maintain session** during long operations (with SID 0x3E)

This guide shows **complete multi-service workflows** with sequence diagrams showing Tester â†” ECU communication.

---

## Service Dependency Pyramid

### Dependency Hierarchy

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Communication      â”‚
                    â”‚   Control (0x28)     â”‚
                    â”‚   [Isolation Layer]  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                                     â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Session (0x10)â”‚                   â”‚Security (0x27) â”‚
    â”‚  [Access Layer]â”‚                   â”‚[Access Layer]  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                      â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Flash (0x34)  â”‚    â”‚  Write (0x2E)   â”‚    â”‚Routines (0x31)  â”‚
â”‚  Transfer (0x36)â”‚    â”‚  Read (0x22)    â”‚    â”‚  DTCs (0x14,19) â”‚
â”‚  Exit (0x37)   â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      [Protected Services]
```

### Dependency Rules

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Service 0x28 Dependencies                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  REQUIRED BEFORE 0x28:                            â”‚
â”‚    1. Session Control (0x10)                      â”‚
â”‚       â†’ Must be in Extended (0x03) or             â”‚
â”‚         Programming (0x02) session                â”‚
â”‚                                                    â”‚
â”‚    2. Security Access (0x27) [Optional]           â”‚
â”‚       â†’ Required if ECU enforces security         â”‚
â”‚         for communication control                 â”‚
â”‚                                                    â”‚
â”‚  SERVICES THAT USE 0x28:                          â”‚
â”‚    â€¢ Firmware Update (0x34, 0x36, 0x37, 0x31)     â”‚
â”‚    â€¢ Configuration Write (0x2E)                   â”‚
â”‚    â€¢ Diagnostic Routines (0x31)                   â”‚
â”‚    â€¢ Network Testing (various)                    â”‚
â”‚                                                    â”‚
â”‚  SERVICES THAT WORK WITH 0x28 ACTIVE:             â”‚
â”‚    â€¢ TesterPresent (0x3E) - ALWAYS                â”‚
â”‚    â€¢ Session Control (0x10) - ALWAYS              â”‚
â”‚    â€¢ Security Access (0x27) - ALWAYS              â”‚
â”‚    â€¢ All diagnostic services - ALWAYS             â”‚
â”‚                                                    â”‚
â”‚  NOTES:                                           â”‚
â”‚    â€¢ Diagnostic messages NEVER affected by 0x28   â”‚
â”‚    â€¢ Only application and NM messages controlled  â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Session Requirements Matrix

### Session Compatibility Table

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Operation           â”‚ DEFAULT  â”‚ EXTENDED  â”‚ PROGRAMMING  â”‚
â”‚                     â”‚  (0x01)  â”‚  (0x03)   â”‚   (0x02)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Use SID 0x28        â”‚    âŒ    â”‚    âœ…     â”‚     âœ…       â”‚
â”‚ Disable normal msg  â”‚    âŒ    â”‚    âœ…     â”‚     âœ…       â”‚
â”‚ Disable NM msg      â”‚    âŒ    â”‚    âœ…     â”‚     âœ…       â”‚
â”‚ Disable all comm    â”‚    âŒ    â”‚    âœ…     â”‚     âœ…       â”‚
â”‚ Target subnets      â”‚    âŒ    â”‚    âœ…     â”‚     âœ…       â”‚
â”‚ Re-enable comm      â”‚    âŒ    â”‚    âœ…     â”‚     âœ…       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Session Transition Impact

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ What Happens to Communication Control on          â”‚
â”‚ Session Changes?                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  EXTENDED â†’ PROGRAMMING:                          â”‚
â”‚    Communication control state: PRESERVED âœ…       â”‚
â”‚                                                    â”‚
â”‚  PROGRAMMING â†’ EXTENDED:                          â”‚
â”‚    Communication control state: PRESERVED âœ…       â”‚
â”‚                                                    â”‚
â”‚  EXTENDED/PROGRAMMING â†’ DEFAULT:                  â”‚
â”‚    Communication control state: RESET âŒ           â”‚
â”‚    (Auto-restored to normal operation)            â”‚
â”‚                                                    â”‚
â”‚  DEFAULT â†’ EXTENDED/PROGRAMMING:                  â”‚
â”‚    Communication control state: NORMAL (default)  â”‚
â”‚    (Must re-apply 0x28 if isolation needed)       â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Complete Workflow Examples

### Workflow 1: Flash Programming with Isolation

**Purpose**: Update ECU firmware while preventing network interference

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COMPLETE FLASH PROGRAMMING WORKFLOW                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Tester                              ECU                â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚ PHASE 1: Session Setup                            â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [10 02] Programming Session     â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚                                  â”‚ âœ“ Session: 0x02 â”‚
â”‚    â”‚  [50 02 00 32 01 F4]             â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚  (P2=50ms, P2*=5000ms)           â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚ PHASE 2: Security Unlock                          â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [27 01] Request Seed            â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚                                  â”‚ Generate seed   â”‚
â”‚    â”‚  [67 01 AB CD EF 12]             â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  (Calculate key from seed)       â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [27 02 12 34 56 78]             â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚                                  â”‚ Validate key    â”‚
â”‚    â”‚  [67 02]                         â”‚ ğŸ”“ UNLOCKED     â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚ PHASE 3: Isolate ECU                              â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [28 03 03] Disable All Comm     â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚                                  â”‚ Set RX:âŒ TX:âŒ â”‚
â”‚    â”‚  [68 03]                         â”‚ (Isolated!)     â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  Wait 100ms (ECU applies state)  â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚ PHASE 4: Flash Programming                        â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [34 00 44 00 10 00 00 ...]      â”‚                 â”‚
â”‚    â”‚  Request Download                â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚                                  â”‚ Prepare flash   â”‚
â”‚    â”‚  [74 20 10 00]                   â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚  (Max 4096 bytes per block)      â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  Start TesterPresent (background)â”‚                 â”‚
â”‚    â”‚  [3E 80] every 2 seconds â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚                                  â”‚ Keep alive      â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [36 01 <256 bytes>] Block 1     â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [76 02]                         â”‚ Write to flash  â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [36 02 <256 bytes>] Block 2     â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [76 03]                         â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  ... (repeat for all blocks) ... â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [36 FF <remaining>] Last Block  â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [76 00]                         â”‚ All received    â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [37] Request Transfer Exit      â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚                                  â”‚ Finalize flash  â”‚
â”‚    â”‚  [77]                            â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [31 01 02 02] Check Integrity   â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [71 01 02 02]                   â”‚ âœ“ Flash OK      â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚ PHASE 5: Restore Communication                    â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [28 01 03] Enable All Comm      â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚                                  â”‚ Set RX:âœ… TX:âœ… â”‚
â”‚    â”‚  [68 01]                         â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚ PHASE 6: Reset and Boot New FW                    â”‚
â”‚    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [11 01] Hard Reset              â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [51 01]                         â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚ Rebooting...    â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  ... ECU restarts with new FW ...â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚                                  â”‚ âœ… COMPLETE     â”‚
â”‚    â”‚                                  â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Key Points:
  â€¢ Communication disabled BEFORE flash operations
  â€¢ TesterPresent runs throughout (diagnostics always work)
  â€¢ Communication restored AFTER flash complete
  â€¢ Reset restores normal operation automatically
```

---

### Workflow 2: Protected Configuration Write

**Purpose**: Write calibration data without network interference

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SECURE CONFIGURATION WRITE WORKFLOW                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Tester                              ECU                â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [10 03] Extended Session        â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [50 03 00 32 01 F4]             â”‚ âœ“ Extended      â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [27 01] Request Seed (Level 1)  â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [67 01 AA BB CC DD]             â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [27 02 KEY] Send Key            â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [67 02]                         â”‚ ğŸ”“ UNLOCKED     â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [28 00 01] Enable RX,           â”‚                 â”‚
â”‚    â”‚             Disable TX (Normal)  â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [68 00]                         â”‚ RX:âœ… TX:âŒ     â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ (Listen-only)   â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [22 F1 90] Read VIN (verify)    â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [62 F1 90 VIN DATA...]          â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [2E 10 A0 <config data>]        â”‚                 â”‚
â”‚    â”‚  Write Config Parameter          â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [6E 10 A0]                      â”‚ âœ“ Written       â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [22 10 A0] Read Back (verify)   â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [62 10 A0 <config data>]        â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  âœ“ Verify data matches           â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [28 01 01] Re-enable Normal TX  â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [68 01]                         â”‚ RX:âœ… TX:âœ…     â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [10 01] Return to Default       â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [50 01]                         â”‚ âœ“ Normal mode   â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Key Points:
  â€¢ RX-only mode prevents ECU from broadcasting changes
  â€¢ Write-verify pattern ensures data integrity
  â€¢ Communication fully restored before exiting
```

---

### Workflow 3: Subnet-Specific Diagnostic Testing

**Purpose**: Test one network segment while others remain active

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MULTI-SUBNET TESTING WORKFLOW                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Vehicle Network:                                        â”‚
â”‚    Subnet 0xF0 = Powertrain CAN                          â”‚
â”‚    Subnet 0xF1 = Chassis CAN                             â”‚
â”‚    Subnet 0xF2 = Body CAN                                â”‚
â”‚                                                          â”‚
â”‚  Goal: Test Chassis ECUs without powertrain interference â”‚
â”‚                                                          â”‚
â”‚  Tester                              ECU (Chassis)       â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [10 03] Extended Session        â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [50 03 ...]                     â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [28 03 03 F0 00]                â”‚                 â”‚
â”‚    â”‚  Disable Subnet 0xF0 (Powertrain)â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [68 03]                         â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  Current Network State:          â”‚                 â”‚
â”‚    â”‚    Subnet 0xF0: âŒ SILENT        â”‚                 â”‚
â”‚    â”‚    Subnet 0xF1: âœ… ACTIVE        â”‚                 â”‚
â”‚    â”‚    Subnet 0xF2: âœ… ACTIVE        â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [22 F1 A0] Read Chassis Data    â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [62 F1 A0 ...]                  â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [31 01 F0 01] Start ABS Test    â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [71 01 F0 01]                   â”‚ âœ“ Test running  â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  ... Test executes without       â”‚                 â”‚
â”‚    â”‚      engine RPM interference ... â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [31 03 F0 01] Get Results       â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [71 03 F0 01 RESULTS]           â”‚ âœ“ PASS          â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [28 01 03 F0 00]                â”‚                 â”‚
â”‚    â”‚  Re-enable Subnet 0xF0           â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [68 01]                         â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  All Subnets: âœ… ACTIVE          â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Workflow 4: End-of-Line Production Testing

**Purpose**: Controlled environment for production line testing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EOL PRODUCTION TEST WORKFLOW                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Tester                              ECU                â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [10 03] Extended Session        â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [50 03 ...]                     â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [28 03 03] Isolate Completely   â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [68 03]                         â”‚ RX:âŒ TX:âŒ     â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ (Isolated)      â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [2E F1 90 VIN...] Write VIN     â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [6E F1 90]                      â”‚ âœ“ VIN written   â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [2E 10 B0 SERIAL...] Write S/N  â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [6E 10 B0]                      â”‚ âœ“ S/N written   â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [31 01 FF 00] Self-Test         â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [71 01 FF 00]                   â”‚ âœ“ Test started  â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  Wait for test completion...     â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [31 03 FF 00] Get Results       â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [71 03 FF 00 PASS]              â”‚ âœ… All tests OK â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [14 FF FF FF] Clear DTCs        â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [54]                            â”‚ âœ“ Cleared       â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [28 01 03] Enable Communication â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [68 01]                         â”‚ RX:âœ… TX:âœ…     â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [10 01] Return to Default       â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [50 01]                         â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  ECU Ready for Vehicle Assembly  â”‚ âœ… COMPLETE     â”‚
â”‚    â”‚                                  â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Workflow 5: Diagnostic Routine with Network Quiet

**Purpose**: Execute sensitive diagnostic routine without CAN bus noise

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NETWORK-QUIET ROUTINE EXECUTION                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Tester                              ECU                â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [10 03] Extended Session        â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [50 03 ...]                     â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [28 00 03] Enable RX,           â”‚                 â”‚
â”‚    â”‚             Disable TX           â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [68 00]                         â”‚ Listen-only     â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [31 01 02 05] Start Actuator    â”‚                 â”‚
â”‚    â”‚                Test Routine      â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [71 01 02 05]                   â”‚ âœ“ Started       â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  Routine runs for 5 seconds...   â”‚                 â”‚
â”‚    â”‚  ECU listens to network but      â”‚                 â”‚
â”‚    â”‚  doesn't broadcast results       â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [3E 80] TesterPresent           â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [7E 80]                         â”‚                 â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [31 03 02 05] Get Results       â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [71 03 02 05 RESULTS...]        â”‚ Results ready   â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â”‚    â”‚  [28 01 03] Re-enable All        â”‚                 â”‚
â”‚    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
â”‚    â”‚  [68 01]                         â”‚ âœ“ Normal comm   â”‚
â”‚    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚    â”‚                                  â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Multi-Service Interaction Patterns

### Pattern 1: Session â†’ Security â†’ Comm Control â†’ Operation

```
This is the STANDARD pattern for protected operations

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STANDARD PROTECTED OPERATION PATTERN                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  Step 1: Establish Session                          â”‚
â”‚    SID 0x10 (Session Control)                       â”‚
â”‚    â†’ Enter Extended (0x03) or Programming (0x02)    â”‚
â”‚                                                      â”‚
â”‚  Step 2: Unlock Security                            â”‚
â”‚    SID 0x27 (Security Access)                       â”‚
â”‚    â†’ Request seed, send key, get unlocked           â”‚
â”‚                                                      â”‚
â”‚  Step 3: Isolate Communication                      â”‚
â”‚    SID 0x28 (Communication Control)                 â”‚
â”‚    â†’ Disable normal/NM messages                     â”‚
â”‚                                                      â”‚
â”‚  Step 4: Perform Protected Operation                â”‚
â”‚    SID 0x2E (Write Data)                            â”‚
â”‚    SID 0x31 (Routine Control)                       â”‚
â”‚    SID 0x34/36/37 (Flash Programming)               â”‚
â”‚                                                      â”‚
â”‚  Step 5: Restore Communication                      â”‚
â”‚    SID 0x28 again                                   â”‚
â”‚    â†’ Re-enable normal/NM messages                   â”‚
â”‚                                                      â”‚
â”‚  Step 6: Return to Normal                           â”‚
â”‚    SID 0x10 (Return to Default) OR                  â”‚
â”‚    SID 0x11 (ECU Reset)                             â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Visual Flow:
  [10 XX] â†’ [27 XX] â†’ [28 03 03] â†’ [Operation] â†’ [28 01 03] â†’ [10 01]
  Session   Security   Isolate      Do Work      Restore      Exit
```

---

### Pattern 2: TesterPresent Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TESTERPRESENT DURING ISOLATED OPERATIONS             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  Why: Even with communication disabled, session     â”‚
â”‚       can timeout if no diagnostic activity         â”‚
â”‚                                                      â”‚
â”‚  Solution: Send SID 0x3E (TesterPresent) regularly  â”‚
â”‚                                                      â”‚
â”‚  Timeline:                                          â”‚
â”‚                                                      â”‚
â”‚  T=0s    [28 03 03] Disable all communication       â”‚
â”‚          [68 03] âœ“                                  â”‚
â”‚                                                      â”‚
â”‚  T=2s    [3E 80] TesterPresent (suppress response)  â”‚
â”‚          (No response due to 0x80 flag)             â”‚
â”‚                                                      â”‚
â”‚  T=3s    [34 ...] Start flash download              â”‚
â”‚          [74 ...] âœ“                                 â”‚
â”‚                                                      â”‚
â”‚  T=4s    [3E 80] TesterPresent                      â”‚
â”‚                                                      â”‚
â”‚  T=5s    [36 01 ...] Transfer block 1               â”‚
â”‚          [76 02] âœ“                                  â”‚
â”‚                                                      â”‚
â”‚  T=6s    [3E 80] TesterPresent                      â”‚
â”‚                                                      â”‚
â”‚  T=7s    [36 02 ...] Transfer block 2               â”‚
â”‚          [76 03] âœ“                                  â”‚
â”‚                                                      â”‚
â”‚  ...continue pattern...                             â”‚
â”‚                                                      â”‚
â”‚  Key: TesterPresent every 2s prevents timeout       â”‚
â”‚       Use 0x80 flag to suppress response            â”‚
â”‚       Diagnostics work even with comm disabled      â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Pattern 3: Multi-Level Communication Control

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PROGRESSIVE ISOLATION PATTERN                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  Use Case: Incrementally isolate network for        â”‚
â”‚            sensitive operations                      â”‚
â”‚                                                      â”‚
â”‚  Level 1: Disable Normal Messages Only              â”‚
â”‚    [28 03 01] â†’ Only app messages disabled          â”‚
â”‚    Network management still active (keep-alive)     â”‚
â”‚    Use for: Light diagnostics, read operations      â”‚
â”‚                                                      â”‚
â”‚  Level 2: Disable All Non-Diagnostic                â”‚
â”‚    [28 03 03] â†’ Both normal + NM disabled           â”‚
â”‚    Complete network quiet                           â”‚
â”‚    Use for: Flash programming, critical routines    â”‚
â”‚                                                      â”‚
â”‚  Level 3: Subnet-Specific Isolation                 â”‚
â”‚    [28 03 03 F0 00] â†’ Disable subnet 0xF0           â”‚
â”‚    Other subnets remain active                      â”‚
â”‚    Use for: Testing specific network segments       â”‚
â”‚                                                      â”‚
â”‚  Restoration Path (reverse order):                  â”‚
â”‚    [28 01 03 F0 00] â†’ Re-enable subnet              â”‚
â”‚    [28 01 03]       â†’ Re-enable all                 â”‚
â”‚    [28 01 01]       â†’ Normal messages only          â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Integration with Specific Services

### SID 0x10 (Session Control) + SID 0x28

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Session Control Integration                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Session Changes:                                 â”‚
â”‚                                                    â”‚
â”‚    DEFAULT â†’ EXTENDED:                            â”‚
â”‚      â€¢ 0x28 now allowed                           â”‚
â”‚      â€¢ Previous comm state: N/A (was in default)  â”‚
â”‚                                                    â”‚
â”‚    EXTENDED â†’ PROGRAMMING:                        â”‚
â”‚      â€¢ 0x28 state PRESERVED                       â”‚
â”‚      â€¢ If already isolated, stays isolated        â”‚
â”‚                                                    â”‚
â”‚    PROGRAMMING â†’ DEFAULT (timeout):               â”‚
â”‚      â€¢ 0x28 state RESET                           â”‚
â”‚      â€¢ Communication auto-restored                â”‚
â”‚                                                    â”‚
â”‚  Best Practice:                                   â”‚
â”‚    Always re-apply 0x28 after session change      â”‚
â”‚    to ensure desired state                        â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SID 0x27 (Security Access) + SID 0x28

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Security Access Integration                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Security Requirements:                           â”‚
â”‚    â€¢ Some ECUs require security for 0x28          â”‚
â”‚    â€¢ Check ECU documentation                      â”‚
â”‚    â€¢ Typically for safety-critical ECUs           â”‚
â”‚                                                    â”‚
â”‚  Security State Changes:                          â”‚
â”‚                                                    â”‚
â”‚    LOCKED â†’ UNLOCKED:                             â”‚
â”‚      â€¢ 0x28 now allowed (if required)             â”‚
â”‚      â€¢ Comm state unchanged                       â”‚
â”‚                                                    â”‚
â”‚    UNLOCKED â†’ LOCKED (session change):            â”‚
â”‚      â€¢ 0x28 may no longer work                    â”‚
â”‚      â€¢ Comm state may auto-restore                â”‚
â”‚                                                    â”‚
â”‚  Pattern:                                         â”‚
â”‚    [10 03] â†’ [27 01/02] â†’ [28 03 03]              â”‚
â”‚    Session   Unlock       Can now isolate         â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SID 0x3E (TesterPresent) + SID 0x28

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TesterPresent Integration                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Critical: TesterPresent ALWAYS works             â”‚
â”‚            even when communication disabled       â”‚
â”‚                                                    â”‚
â”‚  Usage During Isolation:                          â”‚
â”‚                                                    â”‚
â”‚    [28 03 03] Disable all                         â”‚
â”‚       â†“                                           â”‚
â”‚    Normal msgs: âŒ BLOCKED                        â”‚
â”‚    NM msgs:     âŒ BLOCKED                        â”‚
â”‚    Diagnostic:  âœ… STILL WORKS                    â”‚
â”‚       â†“                                           â”‚
â”‚    [3E 80] TesterPresent                          â”‚
â”‚       â†“                                           â”‚
â”‚    Session kept alive âœ“                           â”‚
â”‚                                                    â”‚
â”‚  Recommended Timing:                              â”‚
â”‚    â€¢ Send every 2 seconds                         â”‚
â”‚    â€¢ Use 0x80 flag (suppress response)            â”‚
â”‚    â€¢ Continue throughout isolated operation       â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SID 0x34/36/37 (Flash Programming) + SID 0x28

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Flash Programming Integration                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Standard Sequence:                               â”‚
â”‚                                                    â”‚
â”‚  1. [10 02] Programming session                   â”‚
â”‚  2. [27 01/02] Security unlock                    â”‚
â”‚  3. [28 03 03] ISOLATE â—„â”€â”€ Critical!              â”‚
â”‚  4. [34 ...] Request download                     â”‚
â”‚  5. [36 ...] Transfer data (multiple blocks)      â”‚
â”‚  6. [37] Exit transfer                            â”‚
â”‚  7. [31 ...] Check programming dependencies       â”‚
â”‚  8. [28 01 03] RESTORE â—„â”€â”€ Critical!              â”‚
â”‚  9. [11 01] Reset ECU                             â”‚
â”‚                                                    â”‚
â”‚  Why Isolation Needed:                            â”‚
â”‚    â€¢ Prevents bus errors during flash write       â”‚
â”‚    â€¢ Reduces EMI interference                     â”‚
â”‚    â€¢ Ensures data integrity                       â”‚
â”‚    â€¢ Prevents other ECUs from interrupting        â”‚
â”‚                                                    â”‚
â”‚  Don't Forget:                                    â”‚
â”‚    â€¢ Send [3E 80] every 2s during transfer        â”‚
â”‚    â€¢ Wait 100ms after [28 03 03] before [34]      â”‚
â”‚    â€¢ Always restore comm before reset             â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SID 0x2E (Write Data) + SID 0x28

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Write Data Integration                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Use Case 1: Silent Configuration Write           â”‚
â”‚    [28 00 01] Enable RX, Disable TX (normal)      â”‚
â”‚    [2E ...] Write configuration                   â”‚
â”‚    [22 ...] Verify write                          â”‚
â”‚    [28 01 01] Re-enable TX                        â”‚
â”‚                                                    â”‚
â”‚  Use Case 2: Isolated VIN Write                   â”‚
â”‚    [28 03 03] Complete isolation                  â”‚
â”‚    [2E F1 90 VIN...] Write VIN                    â”‚
â”‚    [22 F1 90] Read back VIN                       â”‚
â”‚    [28 01 03] Restore communication               â”‚
â”‚                                                    â”‚
â”‚  Why Use 0x28 with 0x2E:                          â”‚
â”‚    â€¢ Prevent ECU from broadcasting changes        â”‚
â”‚    â€¢ Avoid triggering other ECU reactions         â”‚
â”‚    â€¢ Maintain system stability during config      â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SID 0x31 (Routine Control) + SID 0x28

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Routine Control Integration                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Pattern: Network-Quiet Routine Execution         â”‚
â”‚                                                    â”‚
â”‚  [10 03] Extended session                         â”‚
â”‚  [28 00 03] Enable RX, Disable TX                 â”‚
â”‚     â”‚                                             â”‚
â”‚     â”œâ”€ ECU can read network inputs               â”‚
â”‚     â””â”€ ECU won't broadcast routine status        â”‚
â”‚                                                    â”‚
â”‚  [31 01 XX XX] Start routine                      â”‚
â”‚     Routine runs quietly                          â”‚
â”‚                                                    â”‚
â”‚  [3E 80] Keep session alive                       â”‚
â”‚                                                    â”‚
â”‚  [31 03 XX XX] Get results                        â”‚
â”‚     Results retrieved via diagnostics             â”‚
â”‚                                                    â”‚
â”‚  [28 01 03] Restore communication                 â”‚
â”‚                                                    â”‚
â”‚  Use Cases:                                       â”‚
â”‚    â€¢ Actuator tests (no broadcast during test)    â”‚
â”‚    â€¢ Calibration routines (quiet execution)       â”‚
â”‚    â€¢ Self-diagnostics (isolated environment)      â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Troubleshooting Multi-Service Scenarios

### Problem 1: Flash Fails After Communication Disable

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SYMPTOM: Flash programming fails with timeout or  â”‚
â”‚          NRC 0x78 after [28 03 03]                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Root Causes:                                     â”‚
â”‚                                                    â”‚
â”‚  1. TesterPresent Not Sent                        â”‚
â”‚     â”œâ”€ Session timeout occurred                   â”‚
â”‚     â””â”€ Solution: Send [3E 80] every 2s            â”‚
â”‚                                                    â”‚
â”‚  2. Diagnostic CAN Also Disabled                  â”‚
â”‚     â”œâ”€ Tester can't communicate with ECU          â”‚
â”‚     â””â”€ Solution: Only disable normal/NM,          â”‚
â”‚        keep diagnostic CAN active                 â”‚
â”‚                                                    â”‚
â”‚  3. Timing Issue                                  â”‚
â”‚     â”œâ”€ Started flash too quickly after [28]       â”‚
â”‚     â””â”€ Solution: Wait 100ms after comm control    â”‚
â”‚                                                    â”‚
â”‚  4. Power Supply Issue                            â”‚
â”‚     â”œâ”€ Voltage dropped during isolation           â”‚
â”‚     â””â”€ Solution: Ensure stable external power     â”‚
â”‚                                                    â”‚
â”‚  Debug Steps:                                     â”‚
â”‚    â–¡ Verify [68 03] response received             â”‚
â”‚    â–¡ Check TesterPresent is running (2s interval) â”‚
â”‚    â–¡ Monitor diagnostic CAN (should be active)    â”‚
â”‚    â”‚ Add 100ms delay after [28 03 03]             â”‚
â”‚    â–¡ Check ECU power supply voltage               â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Problem 2: Security Works But Operation Fails

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SYMPTOM: Security unlocked successfully, but      â”‚
â”‚          operation (write/routine) fails with NRC â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Scenario:                                        â”‚
â”‚    [27 02] â†’ [67 02] âœ“ Unlocked                   â”‚
â”‚    [28 03 03] â†’ [68 03] âœ“ Isolated                â”‚
â”‚    [2E ...] â†’ [7F 2E 33] âŒ Security Denied       â”‚
â”‚                                                    â”‚
â”‚  Root Causes:                                     â”‚
â”‚                                                    â”‚
â”‚  1. Wrong Security Level                          â”‚
â”‚     â”œâ”€ Unlocked Level 1, need Level 3             â”‚
â”‚     â””â”€ Solution: Check DID security requirements  â”‚
â”‚        Unlock correct level                       â”‚
â”‚                                                    â”‚
â”‚  2. Security Timeout                              â”‚
â”‚     â”œâ”€ Too much time between unlock and operation â”‚
â”‚     â””â”€ Solution: Reduce delay, send [3E 80]       â”‚
â”‚                                                    â”‚
â”‚  3. Session Changed                               â”‚
â”‚     â”œâ”€ Session timeout reset security             â”‚
â”‚     â””â”€ Solution: Keep session alive with [3E]     â”‚
â”‚                                                    â”‚
â”‚  4. Conditions Not Met                            â”‚
â”‚     â”œâ”€ Vehicle in motion, engine running, etc.    â”‚
â”‚     â””â”€ Solution: Check ECU preconditions          â”‚
â”‚                                                    â”‚
â”‚  Debug Sequence:                                  â”‚
â”‚    [10 03] Extended                               â”‚
â”‚    [27 01] â†’ [67 01 SEED]                         â”‚
â”‚    [27 02 KEY] â†’ [67 02] âœ“ Unlocked               â”‚
â”‚    [3E 80] Keep alive (immediate)                 â”‚
â”‚    [28 03 03] â†’ [68 03]                           â”‚
â”‚    [2E ...] Try operation immediately             â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Problem 3: Communication Won't Restore

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SYMPTOM: Sent [28 01 03] but communication        â”‚
â”‚          doesn't restore                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Check 1: Response Code                           â”‚
â”‚    â”œâ”€ [68 01] = Success (wait for ECU to apply)   â”‚
â”‚    â””â”€ [7F 28 XX] = Failed (check NRC)             â”‚
â”‚                                                    â”‚
â”‚  Check 2: Session State                           â”‚
â”‚    â”œâ”€ [22 F1 86] Read active session              â”‚
â”‚    â”œâ”€ If DEFAULT: Session timed out               â”‚
â”‚    â””â”€ Solution: Re-enter Extended [10 03]         â”‚
â”‚                                                    â”‚
â”‚  Check 3: Security State                          â”‚
â”‚    â”œâ”€ Some ECUs need security for re-enable       â”‚
â”‚    â””â”€ Solution: Re-unlock [27 01/02]              â”‚
â”‚                                                    â”‚
â”‚  Check 4: Subnet Mismatch                         â”‚
â”‚    â”œâ”€ Disabled with [28 03 03 F0 00]              â”‚
â”‚    â”œâ”€ Tried to enable with [28 01 03] (no Node ID)â”‚
â”‚    â””â”€ Solution: Match Node ID in both commands    â”‚
â”‚        [28 01 03 F0 00]                           â”‚
â”‚                                                    â”‚
â”‚  Last Resort: ECU Reset                           â”‚
â”‚    [11 01] Hard reset                             â”‚
â”‚    â””â”€ Automatically restores all communication    â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Problem 4: Routine Execution Interrupted

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SYMPTOM: Started routine with [31 01], but        â”‚
â”‚          execution interrupted or times out       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚  Scenario:                                        â”‚
â”‚    [28 00 03] RX only, TX disabled                â”‚
â”‚    [31 01 XX XX] Start routine                    â”‚
â”‚    [71 01 XX XX] Started OK                       â”‚
â”‚    ... wait for completion ...                    â”‚
â”‚    [31 03 XX XX] Get results                      â”‚
â”‚    [7F 31 24] âŒ Request Sequence Error           â”‚
â”‚                                                    â”‚
â”‚  Root Causes:                                     â”‚
â”‚                                                    â”‚
â”‚  1. Session Timeout                               â”‚
â”‚     â”œâ”€ Routine took > S3_Server time              â”‚
â”‚     â”œâ”€ No TesterPresent sent during execution     â”‚
â”‚     â””â”€ Solution: Send [3E 80] every 2s            â”‚
â”‚                                                    â”‚
â”‚  2. Wrong Communication Type                      â”‚
â”‚     â”œâ”€ Routine needs to send status updates       â”‚
â”‚     â”œâ”€ TX disabled blocks internal messaging      â”‚
â”‚     â””â”€ Solution: Use [28 01 03] (enable both)     â”‚
â”‚        or [28 00 01] (allow NM messages)          â”‚
â”‚                                                    â”‚
â”‚  3. External Interference                         â”‚
â”‚     â”œâ”€ Other ECUs sent conflicting commands       â”‚
â”‚     â””â”€ Solution: Use [28 03 03] (complete isolate)â”‚
â”‚                                                    â”‚
â”‚  Correct Pattern:                                 â”‚
â”‚    [10 03] Extended                               â”‚
â”‚    [28 00 03] OR [28 03 03] depending on routine  â”‚
â”‚    [31 01 XX XX] Start                            â”‚
â”‚    Loop:                                          â”‚
â”‚      [3E 80] every 2 seconds                      â”‚
â”‚      Check if routine complete                    â”‚
â”‚    [31 03 XX XX] Get results                      â”‚
â”‚    [28 01 03] Restore                             â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Quick Reference Tables

### Service Combination Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Primary   â”‚ SID 0x10â”‚ SID 0x27â”‚ SID 0x3Eâ”‚ SID 0x11â”‚ Notes   â”‚
â”‚ Service   â”‚ Session â”‚ Securityâ”‚ Tester  â”‚ Reset   â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SID 0x28  â”‚Required â”‚Optional â”‚Required â”‚Optional â”‚         â”‚
â”‚ Comm Ctrl â”‚(Ext/Prog)â”‚(If ECU  â”‚(During  â”‚(Restore)â”‚         â”‚
â”‚           â”‚         â”‚requires)â”‚ long op)â”‚         â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + 0x34/36 â”‚Prog     â”‚Required â”‚Required â”‚After    â”‚Flash    â”‚
â”‚ Flash     â”‚Session  â”‚Usually  â”‚Every 2s â”‚flash    â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + 0x2E    â”‚Extended â”‚Often    â”‚If slow  â”‚Optional â”‚Config   â”‚
â”‚ Write     â”‚or Prog  â”‚Required â”‚write    â”‚         â”‚Write    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + 0x31    â”‚Extended â”‚Sometimesâ”‚If long  â”‚Optional â”‚Routine  â”‚
â”‚ Routine   â”‚         â”‚Required â”‚routine  â”‚         â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + 0x22    â”‚Any      â”‚Rarely   â”‚No       â”‚No       â”‚Read     â”‚
â”‚ Read      â”‚         â”‚         â”‚         â”‚         â”‚(Simple) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Communication State by Service

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Service          â”‚ Normal TX â”‚ NM TX     â”‚ Diagnostic TX   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ After [28 00 01] â”‚ DISABLED  â”‚ ENABLED   â”‚ ENABLED         â”‚
â”‚ After [28 00 03] â”‚ DISABLED  â”‚ DISABLED  â”‚ ENABLED         â”‚
â”‚ After [28 01 01] â”‚ ENABLED   â”‚ ENABLED   â”‚ ENABLED         â”‚
â”‚ After [28 01 03] â”‚ ENABLED   â”‚ ENABLED   â”‚ ENABLED         â”‚
â”‚ After [28 03 01] â”‚ DISABLED  â”‚ ENABLED   â”‚ ENABLED         â”‚
â”‚ After [28 03 03] â”‚ DISABLED  â”‚ DISABLED  â”‚ ENABLED         â”‚
â”‚ After [11 01]    â”‚ ENABLED   â”‚ ENABLED   â”‚ ENABLED (reset) â”‚
â”‚ Session Timeout  â”‚ ENABLED   â”‚ ENABLED   â”‚ ENABLED (reset) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Common Workflow Quick Reference

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Use Case           â”‚ Command Sequence                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Flash Programming  â”‚ [10 02][27 01/02][28 03 03]         â”‚
â”‚                    â”‚ [34][36...][37][31][28 01 03][11 01]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Secure Config Writeâ”‚ [10 03][27 01/02][28 00 01]         â”‚
â”‚                    â”‚ [2E ...][22 verify][28 01 01]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Quiet Routine      â”‚ [10 03][28 00 03][31 01...][3E 80]  â”‚
â”‚                    â”‚ [31 03...][28 01 03]                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Subnet Testing     â”‚ [10 03][28 03 03 XX XX]             â”‚
â”‚                    â”‚ [tests...][28 01 03 XX XX]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EOL Production     â”‚ [10 03][28 03 03][2E VIN][2E S/N]   â”‚
â”‚                    â”‚ [31 test][14 clear][28 01 03][10 01]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### NRC Occurrence by Service Combination

```
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NRC  â”‚ Most Common With                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x12 â”‚ Invalid control type (0x06+)                    â”‚
â”‚      â”‚ Enhanced addressing not supported               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x13 â”‚ Wrong length (2 bytes, 4 bytes, 6+ bytes)       â”‚
â”‚      â”‚ Incomplete Node ID                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x22 â”‚ + SID 0x34 (vehicle in motion)                  â”‚
â”‚      â”‚ + SID 0x31 (wrong preconditions)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x31 â”‚ Invalid comm type (0x00, 0x04+)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x33 â”‚ + SID 0x2E (VIN write requires security)        â”‚
â”‚      â”‚ + SID 0x34 (flash requires security)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0x7F â”‚ Tried in DEFAULT session                        â”‚
â”‚      â”‚ Session timeout occurred                        â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**End of SID 0x28 Service Interactions Guide**

**Document Series**:
- Theory: [SID_28_COMMUNICATION_CONTROL.md](./SID_28_COMMUNICATION_CONTROL.md)
- Implementation: [SID_28_PRACTICAL_IMPLEMENTATION.md](./SID_28_PRACTICAL_IMPLEMENTATION.md)
- **You are here**: Service Interactions

**Related Services**:
- SID 0x10 (Session Control): [SID_10_DIAGNOSTIC_SESSION_CONTROL.md](./SID_10_DIAGNOSTIC_SESSION_CONTROL.md)
- SID 0x27 (Security Access): [SID_27_SECURITY_ACCESS.md](./SID_27_SECURITY_ACCESS.md)
- SID 0x3E (TesterPresent): Check main documentation
- SID 0x2E (Write Data): [SID_46_WRITE_DATA_BY_IDENTIFIER.md](./SID_46_WRITE_DATA_BY_IDENTIFIER.md)
